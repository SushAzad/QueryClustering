queryID,variantID,queryText
313665,4388082,"select e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
from Employee e natural join Department d
where (d.deptLocation = 'Dubai' or d.deptName = 'Sales') and
        (e.annualSalary >= 7000 and e.annualSalary <= 100000) and
        (e.empName like '_a%' or e.empName like '_i%')
order by e.empName asc, d.deptName desc"
34820,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee e join Department d on e.deptID = d.deptID 
WHERE ((d.deptLocation = 'Dubai') OR (d.deptName = 'Sales')) AND (e.annualSalary >= 84000 AND e.annualSalary <= 120000) AND ((e.empName LIKE '_A%' )OR (e.empName LIKE '_I%'))
ORDER BY e.empName,  d.deptName DESC

"
325288,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee e NATURAL JOIN Department d
WHERE (d.deptLocation = 'Dubai' OR d.deptName = 'Sales') AND e.annualSalary >= 84000 AND e.annualSalary <= 120000 AND (e.empName LIKE '_A%' OR e.empName LIKE '_I%')
ORDER BY e.empName, d.deptName DESC;"
36577,4388082,"SELECT empName, annualSalary, deptName, deptLocation, jobTitle
FROM Department d, Employee e
WHERE e.deptID = d.deptID and (deptLocation = 'Dubai' or deptName = 'Sales') and 
(annualSalary / 12 >= 7000 and annualSalary / 12 <= 10000)"
342776,4388082,"SELECT E.empName, E.annualSalary, D.deptName, D.deptLocation, E.jobTitle
FROM Employee E, Department D
WHERE (E.deptID = D.deptID) AND (D.deptLocation = 'Dubai' OR D.deptName = 'Sales') AND (E.annualSalary / 12 >= 7000 AND E.annualSalary / 12 <= 10000) AND (E.empName LIKE '_i%' OR E.empName LIKE '_a%')
ORDER BY E.empName, D.deptName DESC"
31817,4388082,"SELECT empName, annualSalary, deptName, deptLocation, jobTitle
FROM Department d JOIN Employee e ON d.deptID = e.deptID
WHERE (deptLocation = 'Dubai' OR deptName = 'Sales') AND (annualSalary)/12 >= 7000 AND (annualSalary)/12 <=10000 AND (empName LIKE '_a%' OR empName LIKE '_i%')
ORDER BY empName, deptName DESC;"
331548,4388082,"select e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
from Employee e join Department d
on e.deptID = d.deptID
where d.deptLocation = 'Dubai' 
or d.deptName = 'Sales' 
and ((e.annualSalary / 12) >= 7000 and (e.annualSalary / 12) <= 10000)
and (e.empName like '_A%' or e.empName like '_I%')
order by e.empName asc, d.deptName desc"
131080,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Department d JOIN Employee e ON d.deptID = e.deptID
WHERE (d.deptLocation = ""Dubai"" OR d.deptName = ""Sales"") AND (
e.annualSalary <= 100000 AND e.annualSalary >= 70000) AND (
e.empName LIKE ""_a%"" OR e.empName LIKE ""_i%"")
ORDER BY e.empName ASC, d.deptName DESC
"
128458,4388082,"SELECT e.empName as Name, e.annualSalary as Salary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee as e
INNER JOIN Department as d
ON d.deptID = e.deptID
WHERE (d.deptLocation = ""Dubai"" OR d.deptName = ""Sales"") AND (e.annualSalary/12 <= 10000 AND e.annualSalary/12 >= 7000) AND (e.empName LIKE ""_A%"" OR e.empName LIKE ""_I%"")
ORDER BY d.deptName DESC"
127187,4388082,"SELECT Emp.empName, Emp.annualSalary, Dept.deptName, Dept.deptLocation, Emp.jobTitle
FROM Department Dept NATURAL JOIN Employee Emp
WHERE (Dept.deptLocation = ""Dubai"" OR Dept.deptName = ""Sales"") AND 
        (Emp.annualSalary >= 12 * 7000 AND Emp.annualSalary <= 12 * 10000) AND 
        (Emp.empName LIKE '_A%' OR Emp.empName LIKE '_I%')
ORDER BY Emp.empName, Dept.deptName DESC"
124539,4388082,"SELECT Employee.empName, Employee.annualSalary, Department.deptName, Department.deptLocation, Employee.jobTitle
FROM Employee NATURAL JOIN Department
WHERE (Department.deptLocation = 'Dubai' OR Department.deptName = 'Sales')
AND (Employee.annualSalary/12 >= 7000 AND Employee.annualSalary/12 <= 10000)
AND (SUBSTR(Employee.empName, 2, 1) = 'A'  OR SUBSTR(Employee.empName, 2, 1) = 'I')"
126177,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Department d INNER JOIN Employee e on e.deptID = d.deptID
WHERE (d.deptLocation = 'Dubai' OR d.deptName = 'Sales') AND (e.annualSalary >= 84000 AND e.annualSalary <= 120000) AND (e.empName LIKE ""_A%"" OR e.empName LIKE ""_I%"")"
83742,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee e
JOIN Department d ON e.deptID = d.deptID
WHERE (d.deptLocation = 'Dubai' OR d.deptName = 'Sales') AND (e.annualSalary >= 7000 OR e.annualSalary <= 10000) AND (e.empName LIKE '_A%' OR e.empName LIKE '_I%')
ORDER BY e.empName ASC, d.deptName DESC
;"
336531,4388082,"SELECT E.empName, E.annualSalary, D.deptName, D.deptLocation, E.jobTitle 
FROM Department D join Employee E
on D.deptID = E.deptID
where (D.deptLocation = ""Dubai"" or D.deptName= ""sales"")
and ((E.annualSalary/12) >= 7000 and (E.annualSalary/12) <= 10000) 
-- and (E.empName like '_a%' or '_i%')
order by E.empName, D.deptName DESC"
331920,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee e NATURAL JOIN Department d
WHERE (d.deptLocation = ""Dubai"" OR d.deptName = ""Sales"") AND (e.annualSalary/12 >= 7000 AND e.annualSalary/12 <=10000) AND (e.empName LIKE ""_a%"" OR e.empName LIKE ""_i%"")
ORDER BY e.empName, d.deptName DESC"
35368,4388082,"SELECT empName, annualSalary, deptName, deptLocation, jobTitle
FROM Department, Employee
WHERE deptName = ""Sales"" AND annualSalary/12 >= 7000 AND annualSalary/12 <= 10000 AND (empName LIKE ""_A%"" OR empName LIKE ""_I%"")
AND jobTitle LIKE ""Sales%""
ORDER BY empName, deptName DESC"
313229,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee e NATURAL JOIN Department d
WHERE (d.deptLocation = 'Dubai' OR d.deptName = 'Sales') AND (annualSalary / 12 >= 7000 AND annualSalary / 12 <= 10000) AND (empName LIKE '_A%' OR empName LIKE '_I%')
ORDER BY e.empName, d.deptName DESC;"
33496,4388082,"SELECT E.empName, E.annualSalary, D.deptName, D.deptLocation, E.jobTitle FROM Employee AS E
JOIN Department AS D ON D.deptID = E.deptId
WHERE
    (D.deptLocation = ""Dubai"" OR D.deptName = ""Sales"") AND
    (E.annualSalary / 12 >= 7000 AND E.annualSalary / 12 <= 10000) AND
    (E.empName LIKE ""_A%"" OR E.empName LIKE ""_I%"")
ORDER BY E.empName, D.deptName DESC"
5259,4388082,"SELECT empName, annualSalary, deptName, deptLocation, jobTitle
FROM Employee NATURAL JOIN Department
WHERE (deptLocation = 'Dubai' OR (deptName = 'Sales' AND annualSalary >= 84000 AND annualSalary <= 120000)) AND (empName LIKE '_I%' OR empName LIKE '_A%') 
ORDER BY empName ASC, deptName DESC;"
5271,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM (Employee e) NATURAL JOIN (Department d)
WHERE (d.deptLocation = ""Dubai"" OR d.deptName = ""Sales"") AND (e.annualSalary >= 84000 AND e.annualSalary <= 120000) AND (e.empName LIKE ""_A%"" OR e.empName LIKE ""_I%"")
ORDER BY e.empName, d.deptName DESC"
332195,4388082,"Select emp.empName, emp.annualSalary, dep.deptName, dep.deptLocation, emp.jobTitle
From Department dep Natural Join Employee emp
WHERE (dep.deptLocation = ""Dubai"" OR dep.deptName = ""Sales"") AND (emp.annualSalary / 12 >= 7000 AND emp.annualSalary/12 <= 10000) AND (emp.empName LIKE '_a%' OR emp.empName LIKE '_i%')"
332008,4388082,"select Employee.empName, Employee.annualSalary, Department.deptName,Department.deptLocation, Employee.jobTitle
from Employee natural join Department
where (Department.deptLocation = 'Dubai' or deptName = 'Sales') and Employee.annualSalary/12>=7000 and Employee.annualSalary/12<= 10000 and (Employee.empName like '_A%' or Employee.empName like '_I%')
order by Employee.empName, Department.deptName desc"
11185,4388082,"select E.empName, E.annualSalary, D.deptName, D.deptLocation, E.jobTitle
from Employee E join Department D on E.deptID = D.deptID
where (D.deptLocation = 'Dubai' or D.deptName = 'Sales') and ((E.annualSalary/12)>= 7000 and (E.annualSalary/12) <= 10000) and (E.empName LIKE '_A%' or E.empName LIKE '_I%')
order by E.empName, D.deptName desc"
32963,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee e JOIN Department d ON e.deptID = d.deptID 
WHERE (d.deptLocation = 'Dubai' OR d.deptName = 'Sales') AND (e.annualSalary / 12 >= 7000 AND e.annualSalary / 12 <= 10000) AND (e.empName LIKE '_A%' OR e.empName LIKE '_I%')
ORDER BY e.empName, d.deptName DESC"
12133,4388082,"SELECT E1.empName, E1.annualSalary, D1.deptName, D1.deptLocation, E1.jobTitle
FROM (Employee E1 INNER JOIN Department D1 ON D1.deptID = E1.DeptID)
WHERE (D1.deptLocation = 'Dubai' OR D1.deptName = 'Sales') AND (E1.annualSalary/12 >= 7000 AND E1.annualSalary/12 <= 10000) AND (E1.empName LIKE '_A%' OR E1.empName LIKE '_I%')
ORDER BY E1.empName, D1.deptName DESC"
34727,4388082,"Select Employee.empName, Employee.annualSalary, Department.deptName, Department.deptLocation, Employee.jobTitle
From Department, Employee
Where Employee.deptID = Department.deptID AND Employee.annualSalary>= 94000 AND Employee.annualSalary<= 120000 AND ((Employee.empname LIKE '_a%') OR (Employee.empname LIKE '_i%')) AND ((Department.deptlocation = ""Dubai"") OR (Department.deptName = ""Sales""))
Order by Employee.empname, Department.deptName DESC"
5308,4388082,"SELECt Employee.empName, Employee.annualSalary, Department.deptName, Department.deptLocation, Employee.jobTitle
FROM Employee, Department
WHERE (Employee.deptID = Department.deptID) AND (Department.deptLocation = 'Dubai' OR Department.deptName = 'Sales') AND (Employee.annualSalary/12 <= 10000.0 && Employee.annualSalary/12 >= 7000.0) AND (Employee.empName LIKE '_a%' OR Employee.empName LIKE '_i%')"
35941,4388082,"SELECT empName, annualSalary, deptName, deptLocation, jobTitle
FROM Department, Employee
WHERE (deptName = ""Sales"") AND (annualSalary/12 BETWEEN 7000 AND 10000) AND (empName LIKE '_A%' OR empName LIKE '_I%') AND jobTitle LIKE ""Sales%""
ORDER BY empName ASC, deptName DESC"
4370,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee e INNER JOIN Department d ON e.deptID = d.deptId
WHERE ((d.deptLocation LIKE ""Dubai"" OR d.deptName LIKE ""Sales"") AND (e.annualSalary/12 BETWEEN 7000 AND 10000)) AND (e.empName LIKE ""_a%"" OR e.empName LIKE ""_i%"")
ORDER BY e.empName ASC, d.deptName DESC"
34723,4388082,"SELECT empName, annualSalary, deptName, deptLocation, jobTitle
FROM Employee e NATURAL JOIN Department d
WHERE 
    (d.deptLocation = 'Dubai' OR d.deptName = 'Sales') AND 
    ((e.annualSalary / 12 >= 7000) AND (e.annualSalary / 12 <= 10000)) AND 
    (e.empName LIKE '_A%' OR e.empName LIKE '_I%')
ORDER BY e.empName, d.deptName DESC;"
5126,4388082,"SELECT E.empName, E.annualSalary, D.deptName, D.deptLocation, E.jobTitle
FROM Employee E, Department D
WHERE E.deptId = D.deptId AND (D.deptLocation = ""Dubai"" OR D.deptName = ""Sales"")
    AND (E.annualSalary/12 >= 7000 AND E.annualSalary/12 <=10000) 
    AND (E.empName LIKE '_A%' OR E.empName LIKE '_I%')"
126556,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee e, Department d
WHERE (d.deptID = e.deptID) AND (d.deptLocation = 'DUBAI' OR d.deptName = 'SALES') AND (e.annualSalary/12 BETWEEN 7000 AND 10000) AND (e.empName LIKE ""_A%"" OR e.empName LIKE ""_I%"")"
127606,4388082,"select e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
from Employee e natural join Department d
where (d.deptLocation='Dubai' or d.deptName='Sales')
and (e.annualSalary/12 >= 7000 or e.annualSalary <= 10000)
and (e.empName like '%a%' or e.empName like '%i%')"
37267,4388082,"SELECT empName, annualSalary, deptName, deptLocation, jobTitle
FROM Employee NATURAL JOIN Department
WHERE (deptLocation = 'Dubai' OR deptName = 'Sales') AND annualSalary >= 7000 AND annualSalary <= 100000 AND empName LIKE '_i%'
ORDER BY empName ASC, deptName DESC"
30481,4388082,"SELECT empName, annualSalary, deptName, deptLocation, jobTitle
FROM Employee e
NATURAL JOIN Department d
WHERE (deptLocation LIKE ""Dubai"" OR deptName LIKE ""Sales"") AND
    (annualSalary >= 7000*12 AND annualSalary <= 10000*12) AND
    (empName LIKE ""_A%"" OR empName LIKE ""_I%"" OR empName LIKE ""_a%"" OR empName LIKE ""_i%"")
ORDER BY empName, deptName DESC"
36594,4388082,"SELECT E.empName, E.annualSalary, D.deptName, D.deptLocation, E.jobTitle
FROM Employee E
    JOIN Department D ON D.deptID = E.deptID
WHERE (D.deptLocation = 'Dubai' OR D.deptName = 'Sales') AND
      ((E.annualSalary / 12) >= 7000 AND (E.annualSalary / 12) <= 10000) AND
      (empName LIKE '_A%' OR empName LIKE '_I%' OR empName LIKE '_a%' OR empName LIKE '_i%')"
5753,4388082,"select e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
from Employee e inner join Department d on e.deptId = d.deptId
where (d.deptLocation = ""Dubai"" or d.deptName = ""Sales"") and 
((e.annualSalary / 12) <= 10000 or (e.annualSalary / 12) >= 7000) and
(e.empName like ""_A%"" or e.empName like ""_I%"")"
37112,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee e NATURAL JOIN Department d
WHERE (d.deptLocation = 'Dubai' OR d.deptName = 'Sales') AND (e.annualSalary/12 >= 7000 AND e.annualSalary/12 <= 10000) AND (e.empName LIKE ""_A%"" OR e.empName LIKE ""_I%"")
ORDER BY e.empName, d.deptName DESC"
5791,4388082,"select empName, annualSalary, deptName, deptLocation, jobTitle
from Employee natural join Department
where (deptLocation = ""Dubai"" or deptName = ""Sales"")
    and (annualSalary / 12 >= 7000 and annualSalary / 12 <= 10000)
    and (empName like ""_A%"" or empName like ""_I%"")
order by empName, deptName desc"
36387,4388082,"SELECT Employee.empName, Employee.annualSalary, Department.deptName, Department.deptLocation, Employee.jobTitle 
FROM Employee
INNER JOIN Department on Employee.deptId = Department.deptId
WHERE (Department.deptLocation = 'Dubai' OR Department.deptName = 'Sales') AND (Employee.empName LIKE '_I%' OR Employee.empName LIKE '_A%')
GROUP BY Employee.empId
ORDER BY Employee.empName ASC, Department.deptName DESC;"
336388,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee as e
JOIN Department as d
ON e.deptID = d.deptID
WHERE (d.deptLocation = 'Dubai' OR d.deptName = 'Sales') AND (e.annualSalary/12 >= 7000 AND e.annualSalary/12 <= 10000) AND (e.empName LIKE '_A%' OR e.empName LIKE '_I%')
ORDER BY e.empName ASC, d.deptName DESC"
331540,4388082,"Select E.empName,E.annualSalary,D.deptName,D.deptLocation,E.jobTitle
from Employee E,Department D,Salary_Grade S
where E.deptID=D.deptID and E.annualSalary >= S.minAnnualSalary and E.annualSalary <= S.maxAnnualSalary and
(D.deptLocation LIKE 'Dubai' OR D.deptName LIKE 'Sales') and 
(E.annualSalary/12 >= 7000 and E.annualSalary/12 <= 10000) and
(E.empName LIKE '_A%' OR E.empName LIKE '_I%')
order by E.empName,D.deptName DESC"
36209,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle 
FROM Employee e, Department d
WHERE e.deptId = d.deptId 
    AND (d.deptLocation = ""Dubai"" OR d.deptName = ""Sales"")
    AND ((e.empName LIKE ""_a%"") OR (e.empName LIKE ""_i%""));
    "
33198,4388082,"SELECT e.empName, e.annualSalary, d.deptName, d.deptLocation, e.jobTitle
FROM Employee e, Department d
WHERE ((d.deptName = ""Sales"" AND e.jobTitle LIKE '%Sales%')) AND (e.annualSalary/12 >= 7000 AND e.annualSalary/12 <= 10000) AND (e.empName LIKE '_A%' OR e.empName LIKE '_I%') AND e.annualSalary IN (SELECT e2.annualSalary FROM Employee e2, Salary_Grade s WHERE e2.annualSalary >= s.minAnnualSalary AND e2.annualSalary <= s.maxAnnualSalary)
ORDER BY e.empName, d.deptName DESC"
5435,4388082,"SELECT empName, annualSalary, deptName, deptLocation, jobTitle
FROM Employee emp
JOIN Department dept
ON dept.deptID = emp.deptID
WHERE (deptLocation = 'Dubai' OR deptName = 'Sales') 
AND (annualSalary >= 84000 AND annualSalary	<= 120000) 
AND (empName LIKE '_A%' OR empName LIKE '_I%')"
260731,4388083,"SELECT e.empName, e.annualSalary/12 as monthlySalary, d.deptName, e.hireDate
FROM Employee e JOIN Department d ON e.deptID = d.deptID
WHERE e.hireDate IN (SELECT MAX(hireDate) FROM Employee where deptID=e.deptID) AND
e.annualSalary >=(SELECT minAnnualSalary FROM Salary_Grade WHERE grade =12) AND e.annualSalary <=(SELECT maxAnnualSalary FROM Salary_Grade WHERE grade =12)
ORDER BY e.empName, monthlySalary DESC"
37657,4017605,"SELECT d.deptName, d.deptLocation, COUNT(e.deptID) as empCnt
FROM Department d LEFT OUTER JOIN Employee e on d.deptID = e.deptID 
GROUP BY d.deptID
ORDER BY empCnt ASC, d.deptName DESC"
36038,4017605,"Select d.deptName, d.deptLocation, Count(e.empID) as empCNT
from Department d Left outer join Employee e On (d.deptID = e.deptID)
group by  d.deptID
order by empCNT, d.deptName DESC"
325288,4017605,"SELECT d.deptName, d.deptLocation, COUNT(e.empID) as empCnt
FROM Department d LEFT JOIN Employee e ON (d.deptID = e.deptID)
GROUP BY d.deptID
ORDER BY empCnt, d.deptName DESC;"
34406,4017605,"SELECT d.deptName, d.deptLocation, COUNT(DISTINCT(e.empID))
FROM Employee e RIGHT OUTER JOIN Department d ON e.deptID = d.deptID
GROUP BY d.deptID
ORDER BY COUNT(DISTINCT(e.empID)), d.deptName DESC"
129745,4017605,"SELECT d.deptName, d.deptLocation, COUNT(e.empID) as empCNT
FROM Department d 
LEFT OUTER JOIN Employee e ON d.deptID = e.deptID
GROUP BY d.deptId
ORDER BY empCNT, d.deptName DESC;"
34602,4017605,"SELECT d.deptName, d.deptLocation, COUNT(e.empID)
FROM Department d
LEFT OUTER JOIN Employee e
ON d.deptID = e.deptID
GROUP BY d.deptName, d.deptLocation
ORDER BY COUNT(e.empID), d.deptName DESC"
186896,4017605,"SELECT d.deptName, d.deptLocation, COUNT(e.deptID)
FROM Department d LEFT OUTER JOIN Employee e ON d.deptID = e.deptID
GROUP BY d.deptName, d.deptLocation, d.deptID
ORDER BY COUNT(e.deptID), d.deptName DESC"
5259,4017605,"SELECT deptName, deptLocation, count(empID) as total_employee
FROM Department LEFT JOIN Employee ON Department.deptID = Employee.deptID
GROUP BY Department.deptID
ORDER BY total_employee ASC, deptName DESC;"
5265,4017605,"SELECT d.deptName, d.deptLocation, COUNT(e.empID) AS numEmployees
FROM Department d
LEFT OUTER JOIN Employee e
ON d.deptID = e.deptID
GROUP BY d.deptID
ORDER BY numEmployees ASC, d.deptName DESC"
5256,4017605,"SELECT d.deptName, d.deptLocation, COUNT(empID) as empCnt
FROM Department d LEFT OUTER JOIN Employee e ON (d.deptID = e.deptID)
GROUP BY deptName, deptLocation
ORDER BY empCnt, deptName DESC"
36050,4017605,"SELECT d.deptName, d.deptLocation, count(e.empID)
FROM Employee e RIGHT JOIN Department d
        on e.deptID = d.deptID 
GROUP BY d.deptID
ORDER BY count(e.empID) ASC, d.deptName DESC"
5283,4017605,"SELECT d.deptName, d. deptLocation, COUNT(e.empID) as empIDCount
From Department d LEFT Outer Join Employee e ON (d.deptID = e.deptID)
GROUP BY d.deptID
ORDER BY empIDCount, d.deptName DESC"
32807,4017605,"SELECT d.deptName, d.deptLocation, COUNT(e.empID) AS empCount
FROM Department d LEFT OUTER JOIN Employee e ON (d.deptID = e.deptID)
GROUP BY d.deptID 
ORDER BY empCount ASC, deptName DESC"
313637,4017605,"SELECT d.deptName, d.deptLocation, COUNT(e.empID) AS cnt
FROM Department d LEFT OUTER JOIN Employee e ON d.deptID = e.deptID
GROUP BY d.deptID
ORDER BY cnt, d.deptName DESC"
37112,4017605,"SELECT d.deptName, d.deptLocation, count(e.empID) AS ""count""
FROM Department d LEFT OUTER JOIN Employee e ON (d.deptID = e.deptID)
GROUP BY d.deptID
ORDER BY count, d.deptName DESC"
331540,4017605,"Select D.deptName,D.deptLocation,count(E.empID) AS num_employees
from Employee E RIGHT JOIN Department D ON E.deptID = D.deptID 
group by D.deptName,D.deptLocation
order by num_employees,D.deptName DESC
"
322502,4017605,"SELECT d.deptName, d.deptLocation, COUNT(e.empID) AS empCnt
FROM Department d LEFT OUTER JOIN Employee e ON (d.deptID = e.deptID)
GROUP BY d.deptID
ORDER BY empCnt, d.deptName DESC;"
125568,3902467,"SELECT empName, jobTitle, salary/12, Employee.deptID, deptName, grade
FROM Employee JOIN Salary_Grade 
    ON Employee.salary > Salary_Grade.minSalary AND Employee.salary <= Salary_Grade.maxSalary 
JOIN Department ON Department.deptID = Employee.deptID
WHERE salary/12 > 7000 OR jobTitle <> ""IT Support"""
11485,3902467,"select ee.empName, ee.jobTitle, ee.salary/12, ee.deptID, deptName, grade
FROM (Employee ee JOIN Department de ON ee.deptID = de.deptID) JOIN Salary_Grade sg ON ee.salary BETWEEN sg.minSalary AND sg.maxSalary
WHERE ee.salary/12 > 7000 OR NOT (ee.jobTitle = ""IT Support"")"
34406,3902467,"SELECT e.empName, e.jobTitle, e.salary / 12, e.deptID, d.deptName, s.grade
FROM Employee e, Department d, Salary_Grade s
WHERE e.deptID = d.deptID
AND e.salary >= s.minSalary AND e.salary <= s.maxSalary
AND (e.salary/12 > 7000 OR e.empID NOT IN
(SELECT empID
FROM Employee
WHERE jobTitle <> 'IT Support'))"
342776,3902467,"SELECT e.empName, e.jobTitle, e.salary/12, e.deptID, d.deptName, s.grade
FROM Employee e NATURAL JOIN Department d JOIN Salary_Grade s ON (e.salary >= s.minSalary AND e.salary <= s.maxSalary)
WHERE e.salary/12 > 7000 OR e.jobTitle <> 'IT Support'"
33032,3902467,"Select e.empName, e.jobTitle, e.salary/12 as monthlySal, e.deptID, d.deptName, s.grade
From Employee e, Department d, Salary_Grade s
Where ((e.salary/12)>7000 OR e.jobTitle <> 'IT Support')
AND e.deptID = d.deptID
AND (e.salary between s.minsalary and s.maxsalary)

"
34602,3902467,"SELECT empName, jobTitle, salary/12, deptID, deptName, grade
FROM Department NATURAL JOIN Employee
JOIN Salary_Grade
ON salary >= minSalary AND salary <= maxSalary
WHERE salary > 7000 OR jobTitle NOT LIKE 'IT Support'"
124539,3902467,"SELECT empName, jobTitle, salary/12, deptID, deptName, grade 
FROM Employee NATURAL JOIN Department, Salary_Grade
WHERE (salary > minSalary AND salary <= maxSalary) AND 
(salary/12 > 7000 OR jobTitle NOT LIKE ""%IT Support%"")

"
308057,3902467,"SELECT empName, jobTitle, salary/12, deptID, deptName, grade
FROM Department NATURAL JOIN Employee, Salary_Grade
WHERE salary >= minSalary and salary <= maxSalary
AND (salary/12 >= 7000 OR jobTitle <> ""IT Support"")"
186896,3902467,"SELECT DISTINCT e.empName, e.jobTitle, (e.salary/12), e.deptID, d.deptName, s.grade
FROM Employee e NATURAL JOIN Department d LEFT OUTER JOIN Salary_Grade s ON ((e.salary >= s.minSalary) AND (e.salary <= s.maxSalary))
WHERE (e.salary/12) > 7000 OR e.jobTitle <> 'IT Support'"
202279,3902467,"SELECT e.empName, e.jobTitle, e.salary/12.0 as MonthlySal, e.deptID, d.deptName, s.grade
FROM Employee e, Department d, Salary_Grade s
WHERE e.DeptID = d.deptID
AND e.salary BETWEEN s.minSalary AND s.maxSalary AND (((e.salary/12.0)>7000) OR (e.jobTitle <> ""IT Support""));"
38065,3902467,"select empName, jobTitle, (salary / 12) as monthlySalary, deptID, deptName, grade
from Employee e natural join Department d
join Salary_Grade s on e.salary >= s.minSalary and e.salary <= s.maxSalary
where salary / 12 > 7000 or jobTitle != 'IT Support'"
5259,3902467,"SELECT empName, jobTitle, salary / 12, deptID, deptName, grade
FROM (Employee NATURAL JOIN Department), Salary_Grade
WHERE salary >= minSalary AND salary <= maxSalary AND (salary > 7000 OR jobTitle != 'IT Support');"
5271,3902467,"SELECT e.empName, e.jobTitle, e.salary/12 AS monthly_salary, d.deptID, d.deptName, g.grade
FROM Employee e, Department d, Salary_Grade g
WHERE ((e.salary/12 > 7000) OR (d.deptName <> ""IT Support"")) AND (e.salary BETWEEN g.minSalary AND g.maxSalary ) AND (e.deptID = d.deptID)"
313213,3902467,"select e.empName, e.jobTitle, e.salary/12, e.deptId, d.deptName, s.grade
from Employee e natural join Department d, Salary_Grade s
where (e.salary/12>7000 or e.jobTitle<>""IT Support"") and (e.salary between s.minSalary and s.maxSalary)"
30765,3902467,"SELECT e.empName, e.jobTitle, (e.salary/12) as MonthlySal, d.deptID, d.deptName, s.grade
FROM Employee e, Department d, Salary_Grade s
WHERE e.deptID=d.deptID
AND (e.salary>=s.minSalary AND e.salary<=s.maxSalary) 
AND (e.salary/12>7000 OR e.jobTitle<>""IT Support"")"
6575,3902467,"SELECT e.empName, e.jobTitle, e.salary/12.0 as MonthlySal, e.deptID, d.deptName,
s.grade
FROM Employee e, Department d, Salary_Grade s
WHERE e.DeptID = d.deptID
AND e.salary BETWEEN s.minSalary AND s.maxSalary
AND (((e.salary/12.0)>7000) OR (e.jobTitle <> ""IT Support""));"
5256,3902467,"select empName, jobTitle, salary/12, emp.deptID, deptName, grade
from (Employee emp JOIN Department dept on emp.deptID = dept.deptID), Salary_Grade
where (salary > (7000/12) and salary >= minSalary and salary <= maxSalary) ;"
5493,3902467,"SELECT empName, jobTitle, salary/12, deptID, deptName, grade
FROM Department NATURAL JOIN (SELECT * FROM Employee JOIN Salary_Grade ON salary >= minSalary AND salary <= maxSalary) as sal
WHERE sal.salary/12 > 7000;"
5308,3902467,"SELECT Employee.empName, Employee.jobTitle, Employee.salary/12, Department.deptID, Department.deptName, Salary_Grade.grade
FROM Employee
INNER JOIN Department ON Employee.deptID = Department.deptID
CROSS JOIN Salary_Grade
WHERE (Employee.salary >= Salary_Grade.minSalary AND Employee.salary <= Salary_Grade.maxSalary AND (Employee.salary/12 > 7000 OR Employee.jobTitle <> 'IT Support'))
"
36050,3902467,"SELECT e.empName, e.jobTitle, e.salary/12 as ""Monthly Salary"", e.deptID, d.deptName, s.grade
FROM Employee e, Department d, Salary_Grade s
WHERE e.deptID = d.deptID
    AND e.salary between s.minSalary and s.maxSalary
    AND (e.salary/12 > 7000 or e.jobTitle != ""IT Support"")"
5669,3902467,"select empName, jobTitle, salary/12, emp.deptID, deptName, grade from (Employee emp JOIN Department dept on emp.deptID = dept.deptID), Salary_Grade where (salary > (7000/12) and salary >= minSalary and salary <= maxSalary) ;
"
32807,3902467,"SELECT e.empName, e.jobTitle, e.salary / 12, e.deptID, d.deptName, sg.grade
FROM Employee e
    JOIN Department d ON e.deptID = d.deptID
    JOIN Salary_Grade sg ON (e.salary >= sg.minSalary) AND (e.salary <= sg.maxSalary)
WHERE (e.salary / 12 > 7000) OR (e.jobTitle <> ""IT Support"")"
5092,3902467,"SELECT DISTINCT e.empName, e.jobTitle, e.salary/12 as MonthlySal, e.deptID, d.deptName, s.grade
FROM Employee e NATURAL JOIN Department d JOIN Salary_Grade s ON (e.salary <= s.maxSalary AND e.salary >= s.minSalary)
WHERE e.jobTitle <> ""IT Support"" OR (e.salary/12) > 7000"
126556,3902467,"SELECT e.empName, e.jobTitle, e.salary/12 AS MonthlySal, d.deptId, d.deptName, s.grade
FROM Employee e, Department d, Salary_Grade s
WHERE (e.deptId = d.deptId) AND (e.salary >= s.minSalary AND e.salary <= s.maxSalary) AND (e.salary/12 > 7000 OR e.jobTitle != ""IT Support"")"
313637,3902467,"SELECT e.empName, e.jobTitle, e.salary/12 AS MonthlySal, e.deptID, d.deptName, sg.grade
FROM Employee e NATURAL JOIN Department d, Salary_Grade sg
WHERE (e.jobTitle <> ""IT Support"" OR (e.salary/12) > 7000) AND e.salary BETWEEN sg.minSalary AND sg.maxSalary"
30481,3902467,"SELECT E.empName, E.jobTitle, (E.salary/12) as monthlySalary, E.deptID, D.deptName, S.grade
FROM Employee E
LEFT OUTER JOIN Salary_Grade S ON E.salary BETWEEN S.minSalary AND S.maxSalary
LEFT OUTER JOIN Department D ON E.deptID = D.deptID
WHERE E.salary/12 > 7000
    OR E.jobTitle NOT LIKE 'IT Support'
ORDER BY S.grade, E.empName DESC"
36594,3902467,"SELECT E.empName, E.jobTitle, E.salary / 12, E.deptID, D.deptName, S.grade
FROM Employee E 
     JOIN Salary_Grade S ON E.salary BETWEEN S.minSalary AND S.maxSalary
     JOIN Department D ON E.deptID = D.deptID
WHERE E.deptID != 'IT Support' AND E.salary > 12 * 7000"
5791,3902467,"select empName, jobTitle, salary / 12 as MonthlySal, deptID, deptName, grade
from (Department natural join Employee) join Salary_Grade
on salary >= minSalary and salary <= maxSalary
where salary / 12 > 7000 or jobTitle <> ""IT Support"""
331540,3902467,"Select DISTINCT empName,jobTitle,(salary/12),deptID,deptName,grade
from Employee Natural Join Department,Salary_Grade
where (salary>=minSalary and salary<=maxSalary ) and (salary > 7000 or jobTitle NOT LIKE ""IT Support"")

"
10556,3902467,"SELECT e.empName, e.jobTitle, e.salary/12.0 as MonthlySal, e.deptID, d.deptName, s.grade
FROM Employee e, Department d, Salary_Grade s
WHERE e.DeptID = d.deptID
    AND e.salary BETWEEN s.minSalary AND s.maxSalary
    AND (((e.salary/12.0)>7000) OR (e.jobTitle <> ""IT Support""));"
33198,3902467,"SELECT e.empName, e.jobTitle, e.salary/12, d.deptID, d.deptName, s.grade
FROm Employee e, Department d, Salary_Grade s
WHERE e.deptID = d.deptID AND e.salary >= s.minSalary AND e.salary <= s.maxSalary AND (e.salary/12 > 7000 OR e.jobTitle <> ""IT Support"")"
124294,3902467,"SELECT empName, jobTitle, salary / 12, deptID, deptName, grade
FROM (Employee NATURAL JOIN Department) JOIN Salary_Grade 
        ON (Employee.salary >= Salary_Grade.minSalary AND Employee.salary <= Salary_Grade.maxSalary)
WHERE salary / 12 > 7000 OR jobTitle <> ""IT Support"";"
322502,3902467,"SELECT e.empName, e.jobTitle, e.salary/12.0 as MontlySal, e.deptID, d.deptName, s.grade
FROM Employee e, Department d, Salary_Grade s
WHERE e.deptID = d.deptID
    AND e.salary BETWEEN s.minSalary AND s.maxSalary
    AND (((e.salary/12.0) > 7000) OR (e.jobTitle <> 'IT Support'));"
37657,3902466,SELECT * FROM Employee WHERE deptID = (SELECT deptID FROM Department WHERE deptLocation = 'London')
125568,3902466,"SELECT *
FROM Employee
WHERE Employee.salary >
(SELECT minSalary
FROM Salary_Grade
WHERE Salary_Grade.grade = 12) AND Employee.salary < (SELECT maxSalary
FROM Salary_Grade
WHERE Salary_Grade.grade = 13) AND Employee.deptID = (SELECT deptID FROM Department WHERE deptLocation = ""London"")"
11485,3902466,"SELECT ee.*
FROM Employee ee JOIN Salary_Grade sg ON (sg.grade = 13 OR sg.grade = 12) AND 
     ee.salary <= sg.maxSalary AND ee.salary >= sg.minSalary
WHERE ee.deptID IN (SELECT de.deptID FROM Department de WHERE de.deptLocation = ""LONDON"")"
34406,3902466,"SELECT *
FROM Employee e
WHERE e.empID IN
(SELECT e.empID
FROM Employee e, Department d
WHERE e.deptID = d.deptID
AND d.deptLocation = 'London'
AND e.empID IN
(SELECT e.empID
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary)
AND s.grade IN (12, 13)))"
342776,3902466,"SELECT e.empID, e.empName, e.jobTitle, e.managerID, e.hireDate, e.salary, e.comission, e.deptID
FROM Employee e NATURAL JOIN Department d JOIN Salary_Grade s ON (e.salary > s.minSalary AND e.salary < s.maxSalary)
WHERE d.deptLocation = 'London' AND (s.grade = 12 OR s.grade = 13)"
33032,3902466,"Select empID, empName, jobTitle,managerID, hireDate, salary, comission, e.deptID
From Employee e, Department d, Salary_Grade s
Where s.grade IN (12,13)
AND e.salary Between s.minSalary And s.maxSalary
AND e.deptID=d.deptID
AND d.deptLocation = 'London'"
34602,3902466,"SELECT *
FROM Employee
WHERE deptID = (SELECT deptID FROM Department WHERE deptLocation = 'London')
AND salary >= (SELECT minSalary FROM Salary_Grade WHERE grade = 12) AND salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade = 13)"
124539,3902466,"SELECT empID, empName, jobTitle, managerID, hireDate, salary, comission, deptID
FROM Employee NATURAL JOIN Department, Salary_Grade
WHERE
(Employee.salary > Salary_Grade.minSalary AND Employee.salary < Salary_Grade.maxSalary)
AND (Salary_Grade.grade = 12 OR Salary_Grade.grade = 13) AND Department.deptLocation = ""London"""
308057,3902466,"SELECT empID, empName, jobTitle, managerID, hireDate, salary, comission, deptID
FROM Employee NATURAL JOIN Department, Salary_Grade
WHERE grade in (12, 13) 
AND salary >= minSalary AND salary <= maxSalary
AND deptLocation = ""London"""
186896,3902466,"SELECT DISTINCT e.*
FROM (Employee e NATURAL JOIN Department d) LEFT OUTER JOIN Salary_Grade s ON (s.grade = 12 OR s.grade = 13)
WHERE d.deptLocation = 'London'"
202279,3902466,"SELECT *
FROM Employee
WHERE empID IN (SELECT e.empID
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary) AND s.grade IN (12,13))
AND deptID IN (SELECT d.deptID
FROM Department d
WHERE d.deptLocation = ""London"");
"
38065,3902466,"select empID, empName, jobTitle, managerID, hireDate, salary, comission, deptID
from Employee e natural join Department d
join Salary_Grade s on e.salary >= s.minSalary and e.salary <= s.maxSalary
where (grade = 12 or grade = 13) and deptLocation = 'London'"
5259,3902466,"SELECT E.*
FROM Employee E
WHERE (E.salary <= (SELECT maxSalary from Salary_Grade where grade = 13) AND E.salary >= (SELECT minSalary from Salary_Grade where grade = 12)) AND (E.deptID in (SELECT deptID FROM Department WHERE deptLocation = 'London'));"
313213,3902466,"select *
from Employee
where empID in
(select empID
from Department natural join Employee, Salary_Grade s
where (Employee.salary between s.minSalary and s.maxSalary) and (s.grade in (12,13)) and (Department.deptLocation=""London""))"
30765,3902466,"SELECT emp.*
FROM Employee emp, Department d, Salary_Grade s
WHERE emp.deptID=d.deptID AND s.grade IN (12,13) and d.deptLocation = ""London"" AND salary<=maxSalary AND salary>=minSalary"
6575,3902466,"SELECT *
FROM Employee
WHERE empID IN (SELECT e.empID
    FROM Employee e, Salary_Grade s
    WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary)
    AND s.grade IN (12,13))
AND deptID IN (SELECT d.deptID
    FROM Department d
    WHERE d.deptLocation = ""London"");"
5256,3902466,"SELECT *
FROM Employee
WHERE
    deptID = (SELECT deptID
              FROM Department
              WHERE deptLocation = ""London"")"
33116,3902466,"SELECT Employee.*
FROM (SELECT * 
      FROM Employee
      WHERE Employee.deptID in (SELECT Department.deptID FROM Department WHERE Department.deptLocation = 'London')) as Employee, Salary_Grade
WHERE 
    (Employee.salary >= Salary_Grade.minSalary and Employee.salary <= Salary_Grade.maxSalary and (Salary_Grade.grade = 12 or Salary_Grade.grade = 13))
"
5493,3902466,"SELECT *
FROM Employee
WHERE deptID IN (SELECT deptID FROM Department WHERE deptLocation = 'London') AND salary >= (SELECT minSalary FROM Salary_Grade WHERE grade = 12) AND salary <= (SELECT maxSalary FROM Salary_Grade where grade = 13);
"
5308,3902466,"SELECT *
FROM Employee
WHERE Employee.Salary >
       (SELECT Salary_Grade.minSalary
       FROM Salary_Grade
       WHERE Salary_Grade.grade = 12) AND
       Employee.Salary <
       (SELECT Salary_Grade.maxSalary
       FROM Salary_Grade
       WHERE Salary_Grade.grade = 13) AND
       'London' =
       (SELECT Department.deptLocation
        FROM Department
        WHERE Department.deptID = Employee.deptID)"
36050,3902466,"SELECT *
FROM Employee 

    WHERE empID IN (SELECT e.empID
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary) AND s.grade IN (12,13))
AND deptID IN (SELECT d.deptID
FROM Department d
WHERE d.deptLocation = ""London"");"
5283,3902466,"SELECT *
FROM Employee
WHERE empID IN (SELECT ee.empID FROM Employee ee Join Salary_Grade sg ON (sg.grade = 12 OR sg.grade = 13) AND ee.salary Between sg.minSalary and sg.maxSalary) and deptID in (SElECT deptID from Department Where deptLocation = ""London"")"
5669,3902466,"select empID, empName, jobTitle, managerID, hireDate,salary, comission, emp.deptID from (Employee emp JOIN Department dept on emp.deptID = dept.deptID), Salary_Grade where deptLocation = 'London' and (grade = 12 or grade = 13) and (salary >= minSalary and salary <= maxSalary);


"
32807,3902466,"SELECT e.empID, e.empName, e.jobTitle, e.managerID, e.hireDate, e.salary, e.comission, e.deptID
FROM Employee e JOIN Department d ON (e.deptID = d.deptID)
WHERE
    d.deptLocation = ""London""

    AND e.salary >= (
    SELECT minSalary
    FROM Salary_Grade
    WHERE grade = 12
)

    AND e.salary <= (
    SELECT maxSalary
    FROM Salary_Grade
    WHERE grade = 13
)"
5092,3902466,"SELECT DISTINCT e.empID, e.empName, e.jobTitle, e.managerID, e.hireDate, e.salary, e.comission, e.deptID
FROM Salary_Grade s, Department d, Employee e
WHERE s.grade IN (12,13) AND (e.salary BETWEEN s.minSalary AND s.maxSalary) AND e.deptID IN (SELECT d.deptID FROM Department d WHERE d.deptLocation=""London"")"
126556,3902466,"SELECT e.*
FROM Employee e, Salary_Grade s, Department d
WHERE ((s.grade = 12 AND e.salary > s.minSalary AND e.salary < s.maxSalary) OR (s.grade = 13 AND e.salary > s.minSalary AND e.salary < s.maxSalary)) AND e.deptID = d.deptID AND deptLocation = ""London"""
313637,3902466,"SELECT *
FROM Employee em
WHERE em.empID IN (SELECT e.empID
FROM Employee e NATURAL JOIN Department d, Salary_Grade sg
WHERE d.deptLocation = ""London"" AND sg.grade in (12, 13) AND e.salary BETWEEN sg.minSalary AND sg.maxSalary)"
35116,3902466,"SELECT *
FROM Employee
WHERE empName = ANY(SELECT empName
FROM Department LEFT OUTER JOIN Employee on Department.deptID = Employee.deptID
WHERE deptLocation = ""London"")

"
37517,3902466,"select DISTINCT empID, empName, jobTitle, managerID, hireDate, salary, comission, Employee.deptID
from Employee, Salary_Grade, Department
where (grade = 13 or grade = 12) AND Employee.deptID = Department.deptID AND deptLocation = 'London';"
30481,3902466,"SELECT E.*
FROM Employee E
LEFT OUTER JOIN Salary_Grade S ON E.salary BETWEEN S.minSalary AND S.maxSalary
LEFT OUTER JOIN Department D ON E.deptID = D.deptID
WHERE S.grade IN (12, 13)
    AND D.deptLocation LIKE 'LONDON'
ORDER BY E.empId"
36594,3902466,"SELECT *
FROM Employee
WHERE salary BETWEEN (SELECT minSalary FROM Salary_Grade WHERE grade = 12)
             AND
             (SELECT maxSalary FROM Salary_Grade WHERE grade = 13)
      AND deptID IN (SELECT deptID FROM Department WHERE deptLocation = 'London')"
5791,3902466,"select empID, empName, jobTitle, managerID, hireDate, salary, comission, deptID
from (Department natural join Employee) join Salary_Grade
on salary >= minSalary and salary <= maxSalary
where (grade = 12 or grade = 13) and deptLocation = ""London"""
331540,3902466,"Select *
from Employee
where empName IN
(
Select empName
from Employee,Department,Salary_Grade
where Employee.deptID = Department.deptID and (salary >= minSalary and salary <= maxSalary) and grade IN (12,13) and deptLocation LIKE 'London'
)

"
10556,3902466,"SELECT *
FROM Employee
WHERE empID IN (SELECT e.empID
                FROM Employee e, Salary_Grade s
                WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary)
                        AND s.grade IN (12,13))
                        AND deptID IN (SELECT d.deptID
                                       FROM Department d
                                       WHERE d.deptLocation = ""London"");"
33198,3902466,"SELECT *
FROM Employee
WHERE empID IN (SELECT e.empID
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary)
AND s.grade IN (12,13))
AND deptID IN (SELECT d.deptID
FROM Department d
WHERE d.deptLocation = ""London"");"
124294,3902466,"SELECT *
FROM Employee
WHERE deptID IN (
    SELECT deptID
    FROM Department
    WHERE deptLocation = ""London""
) AND salary >= (
    SELECT minSalary
    FROM Salary_Grade
    WHERE grade = 12
) AND salary <= (
    SELECT maxSalary
    FROM Salary_Grade
    WHERE grade = 13
);"
322502,3902466,"SELECT *
FROM Employee
WHERE empID IN (SELECT e.empID
                FROM Employee e, Salary_Grade s
                WHERE(e.salary BETWEEN s.minSalary AND s.maxSalary)
                AND s.grade IN (12, 13))
                AND deptID IN (SELECT d.deptID
                               FROM Department d
                               WHERE d.deptLocation = 'London');"
313665,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits)
FROM Students NATURAL JOIN Enrollments
GROUP BY NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, Firstname ASC;


"
335477,3893280,"select distinct ss.FirstName, ss.LastName, ss.NetId, temp.sc
from Students ss, (select e.NetId, sum(e.Credits) as sc  from Students s natural join Enrollments e 
      group by e.NetId) as temp
where ss.NetId = temp.NetId and temp.sc > 12
ORDER BY temp.sc DESC , ss.FirstName ASC;"
10968,3893280,"SELECT FirstName, LastName, s.NetId, SUM(e.Credits)
FROM Students s
NATURAL JOIN Enrollments e
GROUP BY NetId
HAVING SUM(e.Credits) > 12
ORDER BY SUM(e.Credits) DESC, FirstName ASC
"
11323,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits)
FROM Students Natural Join Enrollments
Group by NetId
Having SUM(Credits) > 12
ORDER by SUM(Credits) DESC, FirstName"
37657,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits) as total_credits
FROM Students s NATURAL JOIN Enrollments e
GROUP BY NetId
HAVING total_credits > 12
ORDER BY total_credits DESC, FirstName ASC"
5759,3893280,"SELECT FirstName, LastName, S.NetId, totalc
FROM Students S, (Select NetID, Sum(Credits) as totalc
    From Enrollments E
    Group BY NetId
    Having Sum(Credits) > 12) Eg
Where S.NetId = Eg.NetId


ORDER BY totalc Desc, S.FirstName
"
85741,3893280,"SELECT FirstName, LastName, NetId, (SELECT SUM(Credits) FROM Enrollments WHERE Students.NetId=Enrollments.NetId) AS CreditHours
From Students
WHERE (SELECT SUM(Credits) FROM Enrollments WHERE Students.NetId=Enrollments.NetId) > 12
ORDER BY CreditHours DESC, FirstName ASC"
125568,3893280,"SELECT FirstName, LastName, Students.NetId, SUM(Credits)
FROM Students JOIN Enrollments ON Enrollments.NetId = Students.NetId
GROUP BY Students.NetId
HAVING SUM(Credits)>12
ORDER BY SUM(Credits) DESC, FirstName ASC"
36038,3893280,"select FirstName, LastName, NetId, sum(Credits) 
from Students as s natural join Enrollments as e 
group by NetId
having sum(Credits) > 12
order by sum(Credits) desc, FirstName asc
"
10955,3893280,"Select Stu.FirstName, Stu.LastName, Stu.NetId, sum(En.Credits) as tot
From Students Stu Join Enrollments En on Stu.NetId = En.NetId
Group by En.NetId
Having tot >= 13
Order by tot Desc, Stu.FirstName Asc;"
4915,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits)
FROM Enrollments NATURAL JOIN Students
GROUP BY NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName
"
33977,3893280,"select A.FirstName, A.LastName, A.NetId, sum(B.Credits) as TotalCredits
from Students A, Enrollments B
where A.NetId = B.NetId
group by A.NetId
having TotalCredits > 12
order by TotalCredits desc, A.FirstName;"
11485,3893280,"Select FirstName, LastName, s.NetId, tot
FROM Students s JOIN 
                    (Select NetId, SUM(Credits) as tot
                    FROM Enrollments
                    GROUP by NetId
                    HAVING tot > 12) d
                ON s.NetId = d.NetId
ORDER BY tot DESC, FirstName ASC



"
325288,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits) as tot
FROM Students s NATURAL JOIN Enrollments e
GROUP BY NetId
HAVING tot > 12
ORDER BY tot DESC, s.FirstName"
37668,3893280,"SELECT S.FirstName, S.LastName, S.NetId, E.CreditSum
FROM Students S NATURAL JOIN (
      SELECT NetId, SUM(Credits) AS CreditSum
      FROM Enrollments 
      GROUP BY NetId
    ) E
WHERE E.CreditSum > 12
ORDER BY E.CreditSum DESC, S.FirstName ASC;
"
128728,3893280,"Select * 
From (Select Distinct FirstName, LastName, Enrollments.NetId, sum(credits) as creds
From Students, Enrollments
Where Students.NetId = Enrollments.NetId
Group By Enrollments.NetId, FirstName, LastName
) as a
Where a.creds > 12
Order By  a.creds DESC, FirstName ASC;"
9606,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits)
FROM Students s Natural Join Enrollments e
GROUP BY e.NetId
HAVING SUM(e.Credits) > 12
Order By SUM(e.Credits) Desc, s.NetId"
36577,3893280,"SELECT temp.FirstName, temp.LastName, temp.NetId, temp.total FROM
(SELECT NetId, FirstName, LastName, SUM(Credits) AS total
FROM Enrollments NATURAL JOIN Students
GROUP BY NetId) as temp
WHERE temp.total > 12
ORDER BY temp.total DESC, temp.FirstName ASC"
342776,3893280,"SELECT s.FirstName, s.LastName, s.NetId, t.TotalCredits
FROM Students s	JOIN 
    (SELECT NetId, SUM(Credits) AS TotalCredits
    FROM Enrollments
    GROUP BY NetId) t ON s.NetId = t.NetId
WHERE t.TotalCredits > 12
ORDER BY t.TotalCredits DESC, s.FirstName"
331824,3893280,"SElECT FirstName, LastName, NetId, SumCredit  
FROM Students NATURAL JOIN (
        SELECT SUM(Credits) AS SumCredit, NetId  
        FROM Enrollments 
        GROUP BY NetId)  C   
WHERE SumCredit > 12
ORDER BY SumCredit DESC, FirstName"
31817,3893280,"SELECT S.FirstName, S.LastName, E.NetId, SUM(E.Credits)
FROM Students S, Enrollments E
WHERE S.NetId = E.NetId
GROUP BY E.NetId
HAVING SUM(E.Credits) > 12
ORDER BY SUM(E.Credits) DESC, S.FirstName;
"
33147,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits) as Nima
FROM Students, Enrollments, (SELECT b.NetId, SUM(b.Credits) as shabi From Enrollments as b Group BY b.NetId)as Cao
WHERE Students.NetId = Enrollments.NetId AND Students.NetId = Cao.NetId AND Cao.shabi > 12
GROUP BY NetId
ORDER BY  Nima DESC , Students.FirstName;"
8045,3893280,"SELECT S.FirstName, S.LastName, S.NetId, StoTC.TC
FROM (SELECT S.NetId, SUM(E.Credits) as TC
FROM Students S, Enrollments E
WHERE S.NetId=E.NetId
GROUP BY S.NetID) AS StoTC, Students S
WHERE StoTC.TC>12 and S.NetId=StoTC.NetId
ORDER BY StoTC.TC DESC, S.FirstName






"
9367,3893280,"SELECT 
    Students.FirstName,
    Students.LastName,
    Students.NetId,
    sum(Enrollments.Credits)
FROM 
    Students, Enrollments
WHERE 
    Students.NetId = Enrollments.NetId
GROUP BY Students.FirstName, Students.LastName, Students.NetId

Having sum(Enrollments.Credits) > 12

ORDER BY
    
    sum(Enrollments.Credits) DESC,
    Students.FirstName ASC;"
317203,3893280,"select FirstName, LastName, NetID, sum(Credits)
from Students Natural Join Enrollments
group by NetId
having sum(Credits) > 12
order by sum(Credits) DESC, FirstName ASC"
32932,3893280,"select S.FirstName, S.LastName, E.NetId, SUM(E.Credits) as numCredits 
FROM Students S join Enrollments E on S.NetId = E.NetId
group by E.NetId
having numCredits > 12
order by numCredits desc, S.FirstName
"
331548,3893280,"SELECT S.FirstName, S.LastName, S.NetId, SUM(E.Credits)
FROM Students S JOIN Enrollments E
ON S.NetId = E.NetId
GROUP BY E.NetId
HAVING SUM(E.Credits) > 12
ORDER BY SUM(E.Credits) DESC, S.FirstName
"
11481,3893280,"select S.FirstName,S.LastName, S.NetId, sum(E.Credits) as total
from Students S
join Enrollments E on S.NetId=E.NetId
group by E.NetId
having total>12
order by total desc, S.FirstName asc;"
33032,3893280,"Select s.FirstName, s.LastName, s.NetID, sub.total
From  Students s, (
Select e.netid, sum(e.credits) AS total
From Enrollments e
Group by e.netid
) sub
Where s.netid = sub.netid && sub.total > 12
Order by sub.total DESC, s.firstname
"
131447,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits) FROM Students JOIN Enrollments ON Students.NetId = Enrollments.NetId GROUP BY Students.FirstName, Students.LastName, Students.NetId HAVING SUM(Enrollments.Credits) > 12 ORDER BY SUM(Enrollments.Credits) DESC, Students.FirstName ASC"
34549,3893280,"SELECT  FirstName, LastName, s.NetId, SUM(Credits) AS total_credits
FROM    Students s LEFT JOIN Enrollments e ON s.NetId = e.NetId
GROUP BY NetId
HAVING  total_credits > 12
ORDER BY total_credits DESC, FirstName ASC"
32845,3893280,"SELECT FirstName, LastName, Students.NetId, TotalCredits
FROM Students, (SELECT NetId, SUM(Credits) AS TotalCredits FROM Enrollments GROUP BY NetId) AS StudentWorkLoads
WHERE Students.NetId = StudentWorkLoads.NetId AND StudentWorkLoads.TotalCredits > 12
ORDER BY TotalCredits DESC, FirstName ASC;"
37281,3893280,"SELECT FirstName, LastName, Students.NetId, SUM(Credits)
FROM Students INNER JOIN Enrollments ON (Students.NetId = Enrollments.NetId)
GROUP BY Students.NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName ASC

"
34603,3893280,"SELECT s.FirstName , s.LastName, s.NetId, a.sum_credit
FROM (SELECT SUM(Credits) sum_credit, NetId FROM Enrollments GROUP BY NetId) a JOIN Students s ON a.NetId = s.NetId
WHERE a.sum_credit > 12
ORDER BY a.sum_credit DESC, s.FirstName ASC"
34415,3893280,"select s.FirstName, s.LastName, e.NetId, sum(e.Credits) as creds
from Students s join Enrollments e on s.NetId = e.NetId
group by e.NetId
having creds > 12
order by creds desc, s.FirstName;
"
127187,3893280,"SELECT FirstName, LastName, s.NetId, SUM(e.Credits)
FROM Enrollments e JOIN Students s ON s.NetId = e.NetId JOIN Courses c ON c.CRN = e.CRN
GROUP BY s.NetId
HAVING SUM(e.Credits) > 12
ORDER BY SUM(e.Credits) DESC, FirstName;"
34602,3893280,"SELECT FirstName, LastName, NetId, total_credits
FROM
(SELECT FirstName, LastName, s.NetId, SUM(Credits) as total_credits
FROM Students s
NATURAL JOIN Enrollments e
GROUP BY s.NetId) AS sub
WHERE total_credits > 12
ORDER BY total_credits DESC, FirstName"
38010,3893280,"SELECT s.FirstName, s.LastName, e.NetId, sum(e.Credits) sum_creds
FROM Enrollments e NATURAL JOIN Students s
GROUP by e.NetId
HAVING sum(e.Credits) > 12
ORDER by sum_creds DESC, s.firstName ASC"
33743,3893280,"SELECT S.FirstName, S.LastName, E.NetId, SUM(E.Credits)
FROM Enrollments E LEFT JOIN Students S
ON E.NetId = S.NetId
GROUP BY NetId
HAVING SUM(E.Credits)>12 
ORDER BY SUM(E.Credits) DESC, S.FirstName ;"
308057,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits)
FROM Students NATURAL JOIN Enrollments
GROUP BY NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName"
36304,3893280,"Select Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits)
from Students, Enrollments
where Students.NetId = Enrollments.NetId
group by Students.NetId
having sum(Credits) > 12 
order by sum(Credits) DESC, Students.FirstName ASC


"
126177,3893280,"SELECT s.FirstName, s.LastName, s.NetId, temp.sumCredits
From Students s,    (SELECT NetId, SUM(Credits) sumCredits
                    FROM Enrollments
                    GROUP BY NetId
                    HAVING SUM(Credits) > 12) AS temp
WHERE s.NetId = temp.NetId
ORDER BY temp.SumCredits DESC, s.FirstName"
318960,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits)
FROM Students NATURAL JOIN Enrollments 
GROUP BY NetId
HAVING SUM(Credits)>12
ORDER BY SUM(Credits) DESC, FirstName"
30205,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits) as Credits
FROM Students
INNER JOIN Enrollments ON Students.NetId=Enrollments.NetID
GROUP BY Students.NetId
HAVING Credits > 12
ORDER BY Credits DESC, Students.FirstName"
186896,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits)
FROM Students s NATURAL JOIN Enrollments e
GROUP BY FirstName, LastName, NetId
HAVING SUM(e.Credits) > 12
ORDER BY SUM(e.Credits) DESC, s.FirstName;"
83742,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits)
FROM Students s
  JOIN Enrollments e ON s.NetId = e.NetId
GROUP BY NetId HAVING SUM(Credits) > 12
ORDER BY SUM(e.Credits) DESC, s.FirstName ASC;"
38711,3893280,"SELECT S1.FirstName, S1.LastName, S1.NetID, temp.CRD
FROM Students S1, (SELECT S.NetId, SUM(Credits) AS CRD
    FROM Students S NATURAL JOIN Enrollments E
    GROUP BY S.NetId) AS temp
    
WHERE temp.CRD > 12 AND S1.NetId = temp.NetId
ORDER BY temp.CRD DESC, S1.FirstName "
33334,3893280,"SELECT FirstName,LastName,Students.NetId,SUM(credits)
FROM Enrollments LEFT OUTER JOIN Students
 ON Enrollments.NetId = Students.NetId
GROUP BY NetId 
HAVING SUM(Credits) > 12
ORDER BY SUM(credits) DESC ,FirstName ASC;"
336531,3893280,"select FirstName, LastName, NetId, sum(Enrollments.Credits) as total
from Students natural join Enrollments
group by Students.NetId
having total >12
order by total DESC, Students.FirstName


"
331920,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits) 
FROM Students
NATURAL JOIN Enrollments 
GROUP BY Students.NetId 
HAVING SUM(Enrollments.Credits) > 12 
ORDER BY SUM(Enrollments.Credits) DESC, Students.FirstName ASC;"
6193,3893280,"select s.FirstName, s.LastName, s.NetId, a.sum_credits from Students s join (select NetId,sum(credits) as sum_credits from Enrollments group by NetId having sum(credits) > 12 ) as a on s.NetId = a.NetId order by a.sum_credits desc, s.FirstName"
35368,3893280,"SELECT FirstName, LastName, Students.NetId, SUM(Credits)
FROM Students, Enrollments
WHERE Students.NetId = Enrollments.NetId
GROUP BY FirstName, LastName, Students.NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName"
35801,3893280,"select Students.FirstName, Students.LastName, Students.NetId, sum(Enrollments.Credits) as CreditsSum
from Students
join Enrollments on Students.NetId=Enrollments.NetId
group by NetId
having sum(Enrollments.Credits) > 12
order by CreditsSum desc, FirstName"
5498,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits) as credits
FROM Students s INNER JOIN Enrollments e
ON s.NetId = e.NetId
GROUP BY s.NetId
HAVING credits > 12
ORDER BY credits DESC, s.FirstName;"
34712,3893280,"select 
    FirstName, LastName, s.NetId, total.totalCredits
from
    Students s
    inner join
        (select 
            NetId, sum(Credits) totalCredits
        from 
            Enrollments
        group by NetId
        having totalCredits > 12) total
    on total.NetId = s.NetId
order by 
    total.totalCredits desc, s.FirstName asc 
"
5467,3893280,"select * from (select Students.FirstName, Students.LastName, Students.NetId, sum(Enrollments.credits) as total from Students, Enrollments
where Students.NetId = Enrollments.NetId 
GROUP BY Students.NetId
Order by total DESC,  Students.FirstName) as T
where T.total > 12
"
313229,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits) AS TotalCredit
FROM Students NATURAL JOIN Enrollments
GROUP BY NetId
HAVING TotalCredit > 12
ORDER BY TotalCredit DESC, FirstName "
310293,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits) as total_credits FROM
	Students s
	join Enrollments e on s.NetId = e.NetId
	GROUP BY s.NetId HAVING total_credits > 12 
	ORDER BY total_credits DESC, s.FirstName ASC;"
5739,3893280,"SELECT FirstName, LastName, Students.NetId, SUM(Enrollments.Credits)
FROM Students, Enrollments
WHERE Students.NetId = Enrollments.NetId
GROUP BY Enrollments.NetId
HAVING SUM(Enrollments.Credits) > 12
ORDER BY SUM(Enrollments.Credits) DESC, FirstName ASC;"
4397,3893280,"SELECT S.FirstName, S.LastName, S.NetId, sum(E.Credits) as total
FROM Students S JOIN Enrollments E ON S.NetId=E.NetId
GROUP BY NetId
HAVING total > 12
ORDER BY total DESC, S.FirstName ASC"
33861,3893280,"select 
s.FirstName,
s.LastName, 
s.NetId,
sum(e.Credits)
from Students s inner join Enrollments e on s.NetId=e.NetId
group by s.FirstName, s.LastName, s.NetId
having sum(e.Credits)>12
order by sum(e.Credits) desc, s.FirstName
"
10699,3893280,"SELECT Students.FirstName, Students.LastName, Enrollments.NetId, sum(Enrollments.Credits)
FROM Students,Enrollments 
WHERE Students.NetId=Enrollments.NetId
GROUP BY Enrollments.NetId
HAVING sum(Enrollments.Credits)>=13
ORDER BY sum(Enrollments.Credits) DESC, Students.FirstName"
202279,3893280,"SELECT S.FirstName, S.LastName, S.NetId, SUM(E.Credits)
FROM Students S LEFT OUTER JOIN Enrollments E ON S.NetId = E.NetId
GROUP BY S.NetId
HAVING SUM(E.Credits) > 12
ORDER BY SUM(E.Credits) DESC, S.FirstNAme"
318962,3893280,"select s.FirstName, s.Lastname, s.NetId, sum(e.Credits)
from Students s
inner join Enrollments e
on s.NetId = e.NetId
group by s.NetId
having sum(e.Credits) > 12
order by sum(e.Credits) desc, s.FirstName asc;"
126834,3893280,"SELECT S.FirstName, S.LastName, S.NetId, T.SumCredits
FROM Students AS S, 
(SELECT NetId, SUM(Credits) AS SumCredits FROM Enrollments GROUP BY NetId) AS T
WHERE S.NetId = T.NetId AND T.SumCredits > 12
ORDER BY T.SumCredits DESC, S.FirstName;
"
7926,3893280,"select FirstName, LastName, NetId, total
from (
select FirstName as FirstName, LastName as LastName, S.NetId as NetId, sum(Credits) as total
from Students as S
left join Enrollments as E on S.NetId = E.NetId

group by S.NetId
order by total desc, FirstName asc
) as NM
where total > 12"
36316,3893280,"SELECT stud.FirstName, stud.LastName, stud.NetId, enr.Creds
FROM Students stud
NATURAL JOIN (SELECT NetId, SUM(Credits) as Creds FROM Enrollments GROUP BY NetId) enr
WHERE enr.Creds > 12
ORDER BY enr.Creds DESC, stud.FirstName ASC;"
31860,3893280,"select * from (select Students.FirstName, Students.LastName, Students.NetId, sum(Enrollments.Credits) as tot from Students left join Enrollments on Enrollments.NetId = Students.NetId group by Students.NetId order by tot desc, Students.FirstName asc) x where x.tot > 12    "
34139,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, Sum(Enrollments.Credits) AS my_sum
FROM Students
JOIN Enrollments on Students.NetId = Enrollments.NetId 
GROUP BY NetId
HAVING Sum(Enrollments.Credits) > 12
ORDER BY my_sum DESC, FirstName ASC;"
38065,3893280,"select FirstName, LastName, NetId, SUM(Credits)
from Students natural join Enrollments
group by NetId
Having SUM(Credits) > 12
order by SUM(Credits) desc, FirstName asc"
33326,3893280,"SELECT Students.FirstName,
    Students.LastName,
    Students.NetId,
    (SELECT SUM(Enrollments.Credits) FROM Enrollments WHERE Enrollments.NetId = Students.NetId) AS totCredits 
    FROM Students
    HAVING totCredits > 12
    ORDER BY totCredits DESC, Students.FirstName"
36288,3893280,"SELECT Students.FirstName, Students.LastName, sub.NetId, sub.cred
FROM Students NATURAL JOIN (SELECT NetId, SUM(Credits) as cred
FROM Enrollments 
GROUP BY NetId
HAVING SUM(Credits) > 12) as sub
ORDER BY sub.cred DESC, Students.FirstName ASC;"
33496,3893280,"SELECT S.FirstName, S.LastName, S.NetId, E.Total
FROM Students S
JOIN (
    SELECT NetId, SUM(Credits) AS Total
    FROM Enrollments
    GROUP BY NetId
    HAVING SUM(Credits) > 12
) AS E ON S.NetId = E.NetId
ORDER BY E.Total DESC, S.FirstName"
5259,3893280,"SELECT FirstName, LastName, NetId, total_credit
FROM Students NATURAL JOIN (SELECT NetId, SUM(Credits) AS total_credit FROM Students NATURAL JOIN Enrollments GROUP BY NetId) AS Credits
WHERE total_credit > 12
ORDER BY total_credit DESC, FirstName ASC;"
5265,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits) AS credits
FROM Students s
NATURAL JOIN Enrollments e
GROUP BY s.NetId
HAVING SUM(e.Credits) > 12
ORDER BY credits DESC, s.FirstName ASC"
5503,3893280,"SELECT S.FirstName, S.LastName, S.NetId, SUM(E.Credits) FROM Students S
INNER JOIN Enrollments E ON S.NetId = E.NetId
GROUP BY E.NetId
HAVING SUM(E.Credits) > 12
ORDER BY SUM(E.Credits) DESC, FirstName
"
5271,3893280,"SELECT s.FirstName, s.LastName, NetId, e.x
FROM Students s NATURAL JOIN
    (SELECT NetId, SUM(Credits) AS x FROM Enrollments GROUP BY NetID HAVING SUM(Credits) > 12) e
ORDER BY x DESC, s.FirstName"
324318,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits) AS TotalCredit 
FROM Students JOIN Enrollments ON Students.NetId = Enrollments.NetId 
GROUP BY Enrollments.NetId HAVING TotalCredit > 12 
ORDER BY TotalCredit DESC, Students.FirstName;"
4769,3893280,"SELECT FirstName, LastName, NetId, SumCredits
FROM Students stud NATURAL JOIN (SELECT NetId, SUM(Credits) SumCredits
                                    FROM Enrollments
                                    GROUP BY NetId) as temp
WHERE temp.SumCredits > 12
ORDER BY SumCredits DESC, FirstName"
35385,3893280,"SELECT S.FirstName, S.LastName, S.NetId, SUM(E.Credits)
FROM Students as S INNER JOIN Enrollments as E ON S.NetId = E.NetId
GROUP BY NetId
HAVING SUM(E.Credits) >= 13
ORDER BY SUM(E.Credits) DESC, S.FirstName ASC"
332195,3893280,"Select FirstName, LastName, NetId, temp.tcredits
From Students s Natural Join (SELECT NetID, SUM(Credits) as tcredits
                                FROM Enrollments
                                Group By NetId) as temp
Where temp.tcredits > 12
ORDER BY temp.tcredits DESC, FirstName ASC;
           
"
335822,3893280,"select S.FirstName, S.LastName, E.NetId, E.Credit
from Students as S inner join (select NetId, sum(Credits) as Credit from Enrollments group by NetId) as E on S.NetId = E.NetId
where E.Credit > 12
order by E.Credit DESC, S.FirstName ASC;"
123787,3893280,"SELECT Students.FirstName, Students.LastName, a.NetId, a.Credits
FROM Students NATURAL JOIN

(
SELECT NetId, sum(Credits) AS Credits
FROM Enrollments
GROUP BY NetId
HAVING sum(Credits) > 12

)AS a

ORDER BY Credits DESC, FirstName 

#ON Students.NetID = a.NetID"
12089,3893280,"SELECT FirstName, LastName, Students.NetId, temp.hours
FROM Students, 
     (SELECT sum(Credits) as hours, NetID
      FROM Enrollments
      GROUP BY NetID) as temp
WHERE temp.hours > 12 AND Students.NetId = temp.NetID
ORDER BY temp.hours desc, FirstName ASC;"
36117,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits) as TotalHours
FROM Students NATURAL JOIN Enrollments
GROUP BY NetId
HAVING TotalHours > 12
ORDER BY TotalHours desc, FirstName asc;"
33084,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, StudentCredit.TotalCredit
FROM Students, (SELECT SUM(Credits) AS TotalCredit, NetId
FROM Enrollments
GROUP BY NetId) as StudentCredit
WHERE Students.NetId = StudentCredit.NetId AND StudentCredit.TotalCredit > 12
ORDER BY TotalCredit DESC, Students.FirstName ASC;"
7276,3893280,"SELECT FirstName, LastName, Students.NetId, sum_credit
FROM Students NATURAL JOIN (
    SELECT sum(Credits) AS sum_credit, NetId
    FROM Enrollments E
    group by NetId
)S
where sum_credit > 12
ORDER BY sum_credit DESC, FirstName ASC;"
313213,3893280,"select FirstName, LastName, NetId, sum(Credits)
from Students natural join Enrollments
group by NetId
having sum(Credits)>12
order by sum(Credits) desc, FirstName
"
34660,3893280,"SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetID, Hours.Cre
FROM Students LEFT JOIN (
    SELECT NetId, SUM(Credits) AS Cre
    FROM Enrollments
    GROUP BY NetId
    HAVING SUM(Credits) > 12
) Hours
ON Students.NetId = Hours.NetId
WHERE Hours.Cre > 12
ORDER BY Hours.Cre DESC, Students.FirstName ASC"
33331,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits)
FROM Students A NATURAL JOIN Enrollments B
GROUP BY NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName;
"
34476,3893280,"SELECT FirstName, LastName, temp.NetId, total FROM ((SELECT NetId, SUM(Credits) AS total  FROM Enrollments GROUP BY NetId)AS temp JOIN Students AS s ON temp.NetId = s.NetId) WHERE total > 12  ORDER BY total DESC, FirstName ASC"
332008,3893280,"select FirstName, LastName, Students.NetId as ID, SumCredits from (select NetId, sum(Credits) as SumCredits from Enrollments group by NetId) as temp, Students where temp.SumCredits>12 and temp.NetId=Students.NetId order by SumCredits desc, FirstName"
332020,3893280,"SELECT FirstName, LastName, NetID, sum(Credits)
FROM Students NATURAL JOIN  Enrollments
GROUP BY NetID
HAVING sum(Credits)>12
ORDER BY sum(Credits) DESC, FirstName"
11185,3893280,"SELECT S.FirstName, S.LastName, S.NetID, SUM(E.Credits) as TotalCredits 
FROM Students S JOIN Enrollments E 
    ON S.NetID = E.NetID
GROUP BY E.NetID
HAVING TotalCredits > 12
ORDER BY TotalCredits DESC,
        S.FirstName ASC ;   
      
      "
5460,3893280,"select FirstName, LastName, NetId, SUM(Credits)
from Students S Natural Join Enrollments E
group by NetId
having SUM(Credits) > 12
order by SUM(Credits) DESC, FirstName ASC;"
30765,3893280,"SELECT s.FirstName, s.LastName, e.NetId, Sum(Credits)
FROM Students s, Enrollments e, Courses c
WHERE s.NetId=e.NetId AND e.CRN=c.CRN
GROUP BY e.NetID
HAVING Sum(Credits)>12
ORDER BY Sum(Credits) DESC, s.FirstName;

"
33739,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits)
FROM Students, Enrollments
WHERE Students.NetId = Enrollments.NetId 
GROUP BY Students.FirstName, Students.LastName, Students.NetId
HAVING SUM(Enrollments.Credits) > 12
ORDER BY SUM(Enrollments.Credits) DESC, Students.FirstName ASC"
30542,3893280,"SELECT * 
FROM (
    SELECT FirstName, LastName, NetId, Sum(Credits) AS TotalCredits
    FROM Students NATURAL JOIN Enrollments
    GROUP BY NetId
    ORDER BY TotalCredits DESC, FirstName)
    AS Temp
WHERE Temp.TotalCredits > 12"
32963,3893280,"SELECT DISTINCT FirstName, LastName, NetId, SUM(Credits) AS Total_Credits
FROM Students NATURAL JOIN Enrollments
GROUP BY NetId
HAVING SUM(Credits) > 12
ORDER BY Total_Credits DESC, FirstName;"
5726,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits) as TotalCredits
FROM Students 
INNER JOIN Enrollments ON Students.NetId = Enrollments.NetId
GROUP BY Students.NetId
HAVING TotalCredits > 12
ORDER BY TotalCredits DESC, Students.FirstName;
"
6575,3893280,"SELECT s2.FirstName, s2.LastName, s2.NetId, sum(Credits) as TotalCredits 
FROM Students s2 LEFT JOIN Enrollments e2
    ON s2.NetId = e2.NetId
    GROUP BY s2.NetId
Having TotalCredits > 12
ORDER BY TotalCredits desc, s2.FirstName;



"
5256,3893280,"SELECT FirstName, LastName, Students.NetId, SUM(Credits)
FROM Students NATURAL JOIN Enrollments
GROUP BY Students.NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName"
12133,3893280,"SELECT DISTINCT St.FirstName, St.LastName, St.NetId, ( SELECT SUM(Credits)
        FROM Enrollments En2
        WHERE En2.NetId = St.NetId
        GROUP BY En2.NetId
      ) AS Total_credits
FROM Students St, Enrollments En
WHERE ( SELECT SUM(Credits)
        FROM Enrollments En2
        WHERE En2.NetId = St.NetId
        GROUP BY En2.NetId
      ) > 12
ORDER BY Total_credits DESC, St.FirstName"
31926,3893280,"SELECT Students.FirstName, Students.LastName, Enrollments.NetId, SUM(Enrollments.Credits)
FROM Students RIGHT JOIN Enrollments
ON Students.NetId = Enrollments.NetId
GROUP BY NetId
HAVING SUM(Enrollments.Credits) > 12
ORDER BY SUM(Enrollments.Credits) DESC, Students.FirstName;
"
33116,3893280,"SELECT FirstName, LastName, NetId, temp2.Credits
    FROM (
    SELECT temp.NetID, temp.Credits 
    FROM (SELECT NetId, SUM(Credits) as Credits
        FROM Students NATURAL JOIN Enrollments
        GROUP BY NetId) as temp
    WHERE temp.Credits > 12 ) as temp2 NATURAL JOIN Students
ORDER BY temp2.Credits DESC, FirstName ASC"
5493,3893280,"SELECT firstName, lastName, NetId, SUM(Credits)
FROM Students NATURAL JOIN Enrollments
GROUP BY NetID
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, firstName ASC; 
"
11941,3893280,"SELECT t.FirstName, t.LastName, t.NetId, t.sm
FROM
(SELECT SUM(E.Credits) as sm, S.NetId, S.FirstName, S.LastName
FROM Students S 
NATURAL JOIN Enrollments E
GROUP BY E.NetId)
as t
WHERE t.sm > 12
ORDER BY t.sm desc, t.FirstName 
"
5678,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(Credits) as hours
FROM Students s NATURAL JOIN Enrollments e 
GROUP BY NetId
HAVING SUM(Credits) > 12
ORDER BY hours DESC, s.FirstName



#Group Enrollments by netID
#Aggregate the credit hours for each group (netID)
#Return students who take more than 12 credit hours


#GROUP BY NetId
#HAVING SUM(Credits) > 12"
86354,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits) AS ""Total Credit""
FROM Students AS s, Enrollments e
WHERE e.NetId = s.NetId
GROUP BY e.NetId
HAVING SUM(e.Credits) > 12
ORDER BY SUM(Credits) DESC, s.FirstName ASC;"
5308,3893280,"SELECT Students.FirstName, Students.LastName, Enrollments.NetId, SUM(Enrollments.Credits)
FROM Enrollments INNER JOIN Students
WHERE Students.NetId = Enrollments.NetId
GROUP BY Enrollments.NetId
HAVING SUM(Enrollments.Credits) > 12
ORDER BY SUM(Enrollments.Credits) DESC, Students.FirstName ASC;"
36050,3893280,"SELECT s.Firstname, s.LastName, s.NetId, c.tCredits
FROM Students s, 
    (SELECT NetId, sum(Credits) as tCredits
     FROM Enrollments
     GROUP BY NetID) c
WHERE c.NetID = s.NetId and c.tCredits > 12
ORDER BY tCredits DESC, FirstName ASC"
5283,3893280,"SELECT s.FirstName, s.LastName, e.NetId, SUM(e.Credits) as sumcredits
From Students s JOIN Enrollments e on (s.NetId = e.NetId)
GROUP BY e.NetId 
HAVING sumcredits > 12
ORDER BY sumcredits DESC, s.FirstName 
"
35941,3893280,"SELECT FirstName, LastName, Students.NetId, SUM(Credits)
FROM Students, Enrollments
WHERE Students.NetId = Enrollments.NetId
GROUP BY FirstName, LastName, Students.NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName ASC"
34691,3893280,"SELECT *
FROM 
    ( SELECT S.FirstName, S.LastName, S.NetID, SUM(E.Credits) as Credits
      FROM Students S, Enrollments E 
      WHERE S.NetID = E.NetID 
      GROUP BY NetID) AS temp
WHERE temp.Credits >  12
ORDER BY Credits DESC, FirstName;"
36051,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits)
FROM Students 
JOIN Enrollments ON Students.NetId=Enrollments.NetId
GROUP BY Students.NetId
HAVING SUM(Enrollments.Credits) > 12
ORDER BY SUM(Enrollments.Credits) DESC, Students.FirstName ASC;




"
32394,3893280,"SELECT A.FirstName, A.LastName, A.NetID, SUM(B.Credits)
FROM Students A, Enrollments B
WHERE A.NetId = B.NetId
Group BY B.NetId 
Having SUM(B.Credits)>12
ORDER BY SUM(B.Credits) DESC, A.FirstName



-- WHERE (
--         SELECT SUM(B.Credits)
--         Group BY B.NetId
--         Having COUNT(B.Credits)>3
--         )
    #    ORDER BY DESC)
#ORDER BY A.FirstName"
5645,3893280,"SELECT FirstName, LastName, NetId, sum_credit
from Students natural join (
    select sum(Credits) as sum_credit, NetId
    FROM Enrollments E
    group by NetId) as A
where sum_credit > 12
Order by sum_credit DESC, FirstName"
35616,3893280,"SELECT FirstName, LastName, S.NetId, SUM(Credits)
FROM Students S, Enrollments E
WHERE S.NetId = E.NetId
GROUP BY FirstName, LastName, S.NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName"
331655,3893280,"select FirstName, LastName, NetId, sum(Credits) as totalCredits 
from Students natural join Enrollments
group by NetId
having sum(Credits) > 12
order by totalCredits DESC, FirstName ASC"
6573,3893280,"SELECT S.FirstName, S.LastName, S.NetId, temp.C
FROM Students S, (SELECT NetId, SUM(Credits) as C
                  FROM Enrollments
                  GROUP BY NetId) as temp
WHERE S.NetId = temp.NetId and temp.C > 12
ORDER BY temp.C DESC, S.Firstname"
4370,3893280,"SELECT s.FirstName, s.LastName, s.NetId, temp.totCredits
FROM Students s, (SELECT e.NetId AS net, SUM(e.Credits) AS totCredits FROM Enrollments e GROUP BY e.NetId HAVING SUM(e.Credits) > 12) AS temp
WHERE s.NetId = temp.net
ORDER BY temp.totCredits DESC, s.FirstName ASC;"
8204,3893280,"Select FirstName, LastName, Netid, SUM(Credits)
FROM Students NATURAL JOIN Enrollments
GROUP BY NetId
HAVING SUM(Credits)>12
ORDER BY SUM(Credits) DESC, FirstName"
316610,3893280,"select s.FirstName, s.LastName, s.NetId, hr.sm from Students s join (
select NetId, sum(Credits) as sm from Enrollments e group by e.NetID) hr on s.NetId=hr.NetId
where hr.sm > 12 order by hr.sm desc, s.FirstName"
36849,3893280,"SELECT FirstName, LastName, NetId, (
    SELECT SUM(Credits) from Enrollments WHERE NetId=Students.Netid 
) FROM Students WHERE (
    SELECT SUM(Credits) from Enrollments WHERE NetId=Students.Netid 
) > 12 order by (
    SELECT SUM(Credits) from Enrollments WHERE NetId=Students.Netid 
) DESC, FirstName;"
125841,3893280,"select Students.FirstName, 
	   Students.LastName,
       Students.NetId,
       g.Credits
from Students

inner join (
  select Enrollments.NetId, sum(Enrollments.Credits) as Credits
  from Enrollments
  group by Enrollments.NetId
) as g on g.NetId = Students.NetId
where g.Credits > 12
order by g.Credits desc, Students.FirstName asc;"
186898,3893280,"Select S.FirstName, S.LastName, S.NetId, SUM(E.credits) from Students S 
JOIN Enrollments E ON S.NetId=E.NetId
GROUP by NetId
HAVING SUM(E.credits)>12
ORDER BY SUM(E.credits) DESC, S.FirstName ASC

"
5126,3893280,"SELECT S.FirstName, S.LastName, S.NetId, SUM(E.Credits)
FROM Students S, Enrollments E
WHERE S.NetId = E.NetId
GROUP BY S.FirstName, S.LastName, S.NetId
HAVING SUM(E.Credits) > 12
ORDER BY SUM(E.Credits) DESC, S.FirstName"
125328,3893280,"select FirstName, LastName,Students.NetId,sum(Enrollments.Credits) as SC
from Students 
right join Enrollments
on Students.NetId=Enrollments.NetId
group by Students.NetId
having SC>12
order by SC DESC,Firstname ASC
"
32807,3893280,"SELECT s.FirstName, s.LastName, s.NetId, Sum(e.Credits) as totalCredits
FROM Students s NATURAL JOIN Enrollments e
GROUP BY s.NetId
HAVING SUM(e.Credits) > 12
ORDER BY totalCredits DESC, s.FirstName ASC"
5130,3893280,"SELECT  FirstName, LastName, NetId, SUM(Credits) 
FROM    Students s NATURAL JOIN Enrollments e
GROUP BY LastName, FirstName, NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName ASC;"
5246,3893280,"select firstName, lastName, NetId, sum(Credits) as totalCredits from Enrollments natural join Students group by NetId having totalCredits > 12 order by totalCredits desc, firstName;"
5722,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits)
FROM Students
NATURAL JOIN Enrollments
GROUP BY FirstName, LastName, NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName ASC;"
5092,3893280,"SELECT s.FirstName, s.LastName, s.NetID, SUM(e.Credits) as totalcreds
FROM Students s NATURAL JOIN Enrollments e
GROUP BY s.NetId, s.FirstName, s.LastName
HAVING totalcreds > 12
ORDER BY totalcreds DESC, s.FirstName ASC
"
126556,3893280,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId, T.creds
FROM Students s, (SELECT SUM(Credits) as creds, NetId FROM Enrollments GROUP BY NetId) AS T
WHERE T.creds > 12 AND s.NetId = T.NetId ORDER BY T.creds DESC, s.FirstName ASC"
8171,3893280,"SELECT S.FirstName, S.LastName, S.NetId, enrollInfo.totalCredits
FROM Students AS S, (SELECT NetId, SUM(Credits) As totalCredits
    FROM Enrollments
    GROUP BY NetId) AS enrollInfo
WHERE S.NetId = enrollInfo.NetId
    AND enrollInfo.totalCredits > 12
ORDER BY enrollInfo.totalCredits DESC, S.FirstName;"
37573,3893280,"Select S.FirstName, S.LastName, S.NetId, SUM(E.Credits)
FROM Students S INNER JOIN Enrollments E ON S.NetId = E.NetId
GROUP BY NetId
HAVING SUM(E.Credits) > 12
ORDER BY SUM(E.Credits) DESC, S.FirstName ASC"
313637,3893280,"SELECT FirstName, LastName, NetId, TotalCredits.total
FROM Students NATURAL JOIN (SELECT NetId, SUM(credits) as total
                FROM Enrollments
                GROUP BY NetId
                HAVING SUM(Credits) > 12) AS TotalCredits

ORDER BY TotalCredits.total DESC, FirstName



"
130804,3893280,"select s.FirstName, s.LastName, e.NetId, sum(e.Credits) 
from Students s, Enrollments e
where e.NetID = s.NetID
group by e.NetId, s.FirstName, s.LastName
HAVING  sum(e.Credits) > 12
order by sum(e.Credits) DESC, s.FirstName;
"
24839,3893280,"SELECT *
FROM 
    (SELECT s.FirstName as fn, s.LastName, s.NetId, SUM(e.Credits) as creditSum
    FROM Students s, Enrollments e
    WHERE s.NetId = e.NetId
    GROUP BY s.NetId) as t
WHERE t.creditSum > 12
ORDER BY t.creditSum DESC, t.fn


"
122226,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Credits)
FROM Students 
JOIN Enrollments 
ON Students.NetId=Enrollments.NetId 
GROUP BY Students.NetId
HAVING (SUM(Credits) > 12) 
ORDER BY SUM(Credits) desc, FirstName asc;
"
35048,3893280,"SELECT * FROM (SELECT FirstName, LastName, NetId, SUM(credits) as credits FROM (SELECT * FROM Students S NATURAL JOIN Enrollments E) as temp GROUP BY NetID) as temp2 WHERE (credits > 12) ORDER BY credits DESC, FirstName"
201123,3893280,"select Students.FirstName, Students.LastName, Students.NetId, Enrollments.SC as TotalCredits
from Students
    inner join (select NetId, sum(Credits) as SC from Enrollments group by NetId) Enrollments on Students.NetId = Enrollments.NetId
    where Enrollments.SC > 12
    order by Enrollments.SC desc, Students.FirstName
    "
127606,3893280,"select FirstName, LastName, NetId, sum(Credits) as total
from Students natural join Enrollments
group by NetId
having total > 12
order by total desc, FirstName
"
37267,3893280,"SELECT DISTINCT FirstName, LastName, Students.NetId, totalCredits
FROM Students LEFT JOIN (SELECT Enrollments.NetId, SUM(credits) as totalCredits FROM Enrollments GROUP BY NetId) as Credits ON Students.NetId = Credits.NetId
WHERE totalCredits > 12
ORDER BY totalCredits DESC, FirstName"
34020,3893280,"SELECT s.FirstName, s.LastName, a.NetId, a.Sum
FROM Students s INNER JOIN
    (SELECT NetId, SUM(Credits) as Sum
    FROM Enrollments
    GROUP by NetId) AS a
WHERE s.NetId = a.NetId AND a.Sum > 12
ORDER BY a.Sum DESC, s.FirstName ASC"
35116,3893280,"SELECT FirstName, LastName, NetId, Q.T
FROM (SELECT *
FROM (SELECT NetId ID, SUM(Credits) T
FROM Enrollments
GROUP BY NetId) as Temp
WHERE Temp.T > 12 ) as Q, Students S
WHERE S.NetId = Q.ID
ORDER BY Q.T DESC, FirstName ASC
"
37517,3893280,"select FirstName, LastName, NetId, sum(Credits) as totalHours
from Students natural join Enrollments
group by NetId
having sum(Credits) > 12
order by totalHours DESC, FirstName ASC;"
36027,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits) as sum
FROM Students NATURAL JOIN Enrollments 
GROUP BY NetID
HAVING sum > 12
ORDER BY sum DESC, FirstName ASC"
319746,3893280,"SELECT *
FROM (SELECT FirstName, LastName, S.NetID AS NetID, SUM(Credits) AS TotalCredits
FROM Students S LEFT OUTER JOIN Enrollments E ON S.NetID = E.NetID
GROUP BY NetID) as temp
WHERE temp.TotalCredits > 12
ORDER BY temp.TotalCredits DESC, temp.FirstName"
33188,3893280,"SELECT FirstName,LastName,NetId,SUM(Credits)
FROM Students NATURAL JOIN Enrollments 
GROUP BY NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC,FirstName

"
30481,3893280,"SELECT S.FirstName, S.LastName, S.NetId, SUM(E.Credits) AS CreditHours
FROM Students S
LEFT OUTER JOIN Enrollments E on S.NetId = E.NetId
GROUP BY S.NetId
HAVING CreditHours > 12
ORDER BY CreditHours DESC, S.FirstName"
33375,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits)
FROM Students s JOIN Enrollments e ON s.NetId = e.NetId
GROUP BY s.NetId
HAVING SUM(e.Credits) > 12
ORDER BY SUM(e.Credits) DESC, s.FirstName ASC"
36594,3893280,"SELECT S.FirstName, S.LastName, S.NetId, SUM(E.Credits)
FROM Students S, Enrollments E
WHERE S.NetId = E.NetId
GROUP BY E.NetID
HAVING SUM(E.Credits) > 12
ORDER BY SUM(E.Credits) DESC, FirstName"
5753,3893280,"select s.FirstName, s.LastName, s.NetId, SUM(e.Credits)
from Students s inner join Enrollments e on s.NetId = e.NetId
group by s.FirstName, s.LastName, s.NetId having SUM(e.Credits) > 12
order by SUM(e.Credits) desc, s.FirstName asc"
337120,3893280,"SELECT S.FirstName, S.LastName, Temp.NetId, Temp.TotalCredits
FROM (SELECT NetId, SUM(Credits) AS TotalCredits 
FROM Students S NATURAL JOIN Enrollments E WHERE S.NetId = E.NetId
GROUP BY NetId) AS Temp, Students S
WHERE S.NetId = Temp.NetId AND Temp.TotalCredits > 12
ORDER BY TotalCredits DESC, FirstName"
7637,3893280,"SELECT FirstName, LastName, NetID, TotalCredits
FROM (SELECT s.FirstName, s.LastName, s.NetID, SUM(e.Credits) AS TotalCredits
      FROM Students s NATURAL JOIN Enrollments e
      GROUP BY s.NetID) AS T
Where TotalCredits > 12
ORDER BY TotalCredits DESC, FirstName ASC"
5791,3893280,"select * from (
    select FirstName, LastName, Enrollments.NetId, sum(Credits) TotalCredits
    from Enrollments
    inner join Students
    on Enrollments.NetId = Students.NetId
    group by Enrollments.NetId
) as t1
where TotalCredits > 12
order by TotalCredits desc, FirstName
"
85373,3893280,"select Students.FirstName, Students.LastName, Students.NetID, sum(Enrollments.Credits)
-- from Students join Enrollments on Enrollments.NetID = Students.NetID
from Students, Enrollments
where Students.NetID = Enrollments.NetID 
Group by Students.FirstName,Students.LastName, Students.NetID
Having sum(Enrollments.Credits) > 12
order by sum(Enrollments.Credits) DESC, Students.FirstName



"
31826,3893280,"SELECT S.FirstName,S.LastName,E.NetId,SUM(Credits) as total
FROM Students S,Enrollments E
WHERE E.NetId = S.NetId
GROUP BY S.NetId
HAVING total>12
ORDER BY total DESC, FirstName asc"
33758,3893280,"SELECT * FROM
( 
    SELECT FirstName, LastName, NetId, SUM(Credits) as TotCredits 
    FROM Enrollments NATURAL JOIN Students
    GROUP BY NetId
) AS CreditTable
WHERE CreditTable.TotCredits > 12
ORDER BY CreditTable.TotCredits DESC, CreditTable.FirstName ASC
"
30537,3893280,"SELECT st.FirstName, st.LastName, st.NetId, creds
FROM(
SELECT bt.NetId, bt.LastName, bt.FirstName, 
SUM(bt.Credits) AS creds
FROM(
SELECT s.FirstName, s.LastName, s.NetId, e.Credits 
FROM Students s JOIN Enrollments e ON s.NetId = e.NetId
) AS bt
GROUP BY bt.NetId
) AS st
WHERE creds > 12
ORDER BY creds DESC, st.FirstName ASC;"
36387,3893280,"SELECT Students.FirstName, Students.LastName, Students.NetId, SUM(Enrollments.Credits)
FROM Students
INNER JOIN Enrollments ON Students.NetId = Enrollments.NetId
GROUP BY Students.NetId
HAVING SUM(Enrollments.Credits) > 12
ORDER BY SUM(Enrollments.Credits) DESC, Students.FirstName ASC;"
336388,3893280,"SELECT s.FirstName, s.LastName, s.NetId, e.TotalCredits
FROM Students AS s
JOIN (SELECT Enrollments.NetId, SUM(Enrollments.Credits) AS TotalCredits
      FROM Enrollments
      GROUP BY Enrollments.NetId) AS e
ON s.NetId = e.NetId
WHERE e.TotalCredits > 12
ORDER BY e.TotalCredits desc, s.FirstName asc"
65042,3893280,"select s.FirstName, s.LastName, s.NetId, sum(e.Credits) as temp
from Enrollments e join Students s on e.netid = s.netid
group by netid
having temp > 12
order by temp DESC, s.FirstName ASC; "
9781,3893280,"SELECT FirstName, LastName, NetId, totalCredits
FROM Students NATURAL JOIN (SELECT NETID, SUM(Credits) totalCredits
FROM Enrollments
GROUP BY NetId) AS sumCredits
WHERE totalCredits > 12
ORDER BY totalCredits DESC, FirstName ASC"
33006,3893280,"SELECT S.FirstName, S.LastName, S.NetId, T.SU 
FROM Students as S, 
    (
    SELECT NetId, SUM(credits) as SU
    FROM Enrollments
    GROUP BY NetId
                    ) as T
WHERE S.NetId = T.NetId and T.SU > 12 ORDER BY T.SU DESC, S.FirstName"
33358,3893280,"SELECT b.FirstName, b.LastName, b.NetId, b.total
FROM
    (
    SELECT SUM(a.Credits) AS total, a.FirstName, a.LastName, a.NetId
    FROM
        (
        SELECT FirstName, LastName, s.NetId, e.Credits
        FROM Enrollments AS e, Students AS s
        WHERE e.NetId = s.NetId
        ) AS a
    GROUP BY a.NetId
    ) AS b
WHERE b.total > 12
ORDER BY b.total DESC, FirstName ASC
"
331540,3893280,"Select FirstName,LastName,Students.NetId,sum(Credits)
from Students,Enrollments 
where Students.NetId = Enrollments.NetId
group by Students.NetId
having sum(Credits) > 12
order by sum(Credits) DESC,FirstName"
10556,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits)
FROM Students s, Enrollments e
WHERE s.NetId = e.NetId
GROUP BY NetId
HAVING SUM(e.Credits) > 12
ORDER BY SUM(e.Credits) DESC, s.FirstName
-- 12 < (SELECT SUM(Credits)
--             FROM Enrollments e, Students s
--             WHERE e.NetId = s.NetId)"
322515,3893280,"SELECT 
    S.FirstName, S.LastName, S.NetId, SUM(E.Credits)
FROM 
    Students AS S, 
    Enrollments AS E
WHERE 
    S.NetId = E.NetID
GROUP BY 
    E.NetId  /* use Group in order to you aggreation SUM */
HAVING 
    SUM(E.Credits) > 12
ORDER BY
    SUM(E.Credits) DESC,
    S.FirstName ASC
    
    

    "
130618,3893280,"SELECT FirstName, LastName, NetId, s
FROM Students NATURAL JOIN (SELECT NetId, SUM(Credits) s FROM Enrollments GROUP BY NetId ) as temp
WHERE s > 12
ORDER BY s DESC, FirstName"
36209,3893280,"select s.FirstName, s.LastName, s.NetId, SUM(e.Credits) 
    FROM Students s JOIN Enrollments e ON s.NetId = e.NetId 
    GROUP BY e.NetId 
    HAVING SUM(e.Credits) > 12 
    ORDER BY SUM(e.Credits) DESC, s.FirstName ASC;"
33198,3893280,"SELECT S.FirstName, S.LastName, S.NetId, SUM(E.Credits)
FROM Students S, Enrollments E
WHERE S.NetId = E.NetId
GROUP BY S.FirstName, S.LastName, S.NetId
HAVING SUM(E.Credits) > 12
ORDER BY SUM(E.Credits) DESC, S.FirstName;"
5233,3893280,"SELECT FirstName, LastName, Students.NetId, Total
FROM    Students, 
        (select NetId, SUM(Credits) as Total from Enrollments GROUP BY NetId) as TotalCredits
WHERE Students.NetId = TotalCredits.NetId and Total > 12
ORDER BY Total DESC, FirstName"
5435,3893280,"SELECT s.FirstName, s.LastName, s.NetId, Credits
FROM Students s
LEFT JOIN (
        SELECT minE.NetId AS NetId, sum(minE.Credits) AS Credits
        FROM (
            SELECT e.NetId AS NetId, e.Credits AS Credits
            FROM Enrollments e
            ) AS minE
        GROUP BY minE.NetId
    ) AS enr
ON enr.NetId = s.NetId
WHERE Credits > 12
ORDER BY Credits DESC, FirstName
"
34026,3893280,"SELECT FirstName, LastName, NetId, SUM(Credits) total_credits
FROM Students JOIN Enrollments USING(NetId)
GROUP BY NetId
HAVING total_credits > 12
ORDER BY total_credits DESC, FirstName ASC
"
35847,3893280,"Select s.FirstName, s.LastName, s.NetId, e.p
from Students s, (select NetId, sum(Credits) as p from Enrollments group by NetId) e
where s.NetId = e.NetId AND e.p > 12
order by e.p desc, s.FirstName asc;"
9769,3893280,"Select S.FirstName, S.LastName, S.NetId, E.TCH
From Students S, (Select NetId, Sum(Credits) as TCH from Enrollments group by NetId) as E
Where S.NetId = E.NetId and E.TCH > 12
Order by E.TCH DESC, S.FirstName ASC"
124294,3893280,"SELECT FirstName, LastName, NetId, TotalCredits
FROM Students NATURAL JOIN (SELECT NetId, SUM(Credits) AS TotalCredits
FROM Enrollments
GROUP BY NetId) AS temp
WHERE TotalCredits > 12
ORDER BY TotalCredits DESC, FirstName"
6923,3893280,"SELECT s.FirstName, s.LastName, s.NetId, SUM(e.Credits)
From Students s JOIN Enrollments e ON s.NetId = e.NetId
GROUP BY e.NetId
HAVING SUM(e.Credits) > 12
ORDER BY SUM(e.Credits) DESC, s.FirstName;"
7426,3893280,"SELECT FirstName, LastName, NetId, sumCredit
FROM Students natural join (
    SELECT sum(Credits) as sumCredit, NetId
    FROM Enrollments E
    GROUP by NetId) as A
WHERE sumCredit > 12
ORDER by sumCredit DESC, FirstName"
34391,3893280,"SELECT
  Students.FirstName,
  Students.LastName,
  Enrollments.NetId,
  sum(Enrollments.Credits)
from
  Enrollments,
  Students
where Students.NetId = Enrollments.NetId
group by Enrollments.NetId
having sum(Enrollments.Credits) > 12
order by sum(Enrollments.Credits) desc , Students.FirstName

"
5768,3893280,"SELECT FirstName, LastName, NetID, SUM(Credits)
FROM Enrollments NATURAL JOIN Students
GROUP BY NetId
HAVING SUM(Credits) > 12
ORDER BY SUM(Credits) DESC, FirstName"
322502,3893280,"SELECT S.FirstName, S.LastName, S.NetId, SUM(E.Credits)
FROM Students S, Enrollments E
WHERE S.NetId = E.NetId
GROUP BY 1, 2, 3
HAVING SUM(E.Credits) > 12
ORDER BY SUM(E.Credits) DESC, S.FirstName ASC;"
36183,3893280,"SELECT s.FirstName, s.LastName, s.NetId, sum(e.Credits) AS totalCredits
FROM Students s JOIN Enrollments e ON (s.NetId = e.NetId)
GROUP BY s.NetId
HAVING SUM(e.Credits) > 12
ORDER BY totalCredits DESC, s.FirstName ASC"
35307,3893280,"SELECT DISTINCT FirstName, LastName, s.NetId, SUM(Credits) as credithours
FROM Students s NATURAL JOIN Enrollments e
GROUP BY NetId
HAVING SUM(Credits) > 12
ORDER BY credithours DESC, s.FirstName ASC"
313665,3893287,"SELECT C1.FirstName, C1.LastName, COUNT(P1.PurchaseId)
FROM Customers C1 NATURAL JOIN Purchases P1
WHERE C1.CustomerId IN (SELECT C.CustomerId
FROM Customers C, Purchases P
WHERE C.CustomerId=P.CustomerId
AND P.Price <= ALL (SELECT Price FROM Purchases p2
WHERE p2.ProductId=P.ProductId))
GROUP BY P1.CustomerId
ORDER BY P1.CustomerId DESC;"
335477,3893287,"select c1.FirstName, c1.LastName, count(distinct p2.PurchaseId)
from Customers c1 natural join Purchases p1, Purchases p2,
    (select p3.ProductId, min(p3.Price) as cn from Purchases p3 group by p3.ProductId) as tmp
where p1.ProductId = tmp.ProductId and p1.price = tmp.cn and p2.CustomerId = p1.CustomerId
group by p1.CustomerId
order by p1.CustomerId desc;"
10968,3893287,"SELECT c.FirstName, c.LastName, (SELECT count(p3.ProductId)
                                 FROM Purchases p3
                                 WHERE c.CustomerId = p3.CustomerId)
FROM Customers c
INNER JOIN Purchases p ON p.CustomerId = c.CustomerId
WHERE p.Price = (SELECT MIN(p2.price)
                 FROM Purchases p2
                 WHERE p2.ProductId = p.ProductId)
GROUP BY c.CustomerId
ORDER BY c.CustomerId DESC"
11323,3893287,"select FirstName,LastName,count(*)
from Customers natural join Purchases
where CustomerId in
    (select CustomerId
    from Customers natural join Purchases as total
    where Price = 
                (
                select min(Price) # lowest price for that product
                from Purchases
                where ProductId = total.ProductId
                )
    group by CustomerId
    )
group by CustomerId
order by CustomerId desc"
37657,3893287,"SELECT cust.FirstName, cust.LastName, PurchaseCount.numPurchases
FROM Customers cust, (SELECT CustomerId, COUNT(*) as numPurchases FROM Purchases GROUP BY CustomerId) AS PurchaseCount
WHERE cust.CustomerId = PurchaseCount.CustomerId
AND cust.CustomerId IN (SELECT CustomerId
                        FROM Customers
                        WHERE CustomerId IN (SELECT A.CustomerId
                                            FROM Purchases A, (SELECT MIN(Price) AS MinPrice FROM Purchases GROUP BY ProductId) AS B
                                            WHERE A.Price = B.MinPrice)
                        ORDER BY CustomerId DESC)
ORDER BY cust.CustomerId DESC"
5759,3893287,"SELECT Distinct * 
FROM   (Select c.FirstName, 
               c.LastName, 
               (SELECT Count(*) 
                FROM   Purchases P 
                WHERE  P.CustomerId = c.CustomerId) 
        From   Customers c 
               Natural Join (Select p1.CustomerId, 
                                    p1.ProductId 
                             From   Purchases p1 
                                    Join (Select Distinct ProductId, Min(price) minPrice 
                                          From   Purchases 
                                          Group  By ProductId) minpur 
                                    On p1.ProductId = minpur.ProductId 
                             Where  p1.price = minpur.minPrice) minpricepurchases 

        Order  By c.CustomerId DESC) rows "
36038,3893287,"select cu.FirstName, cu.LastName, purchaseAmountMapping.purchaseAmount
from Customers cu, 
(select CustomerId, Count(*) as purchaseAmount 
from Purchases
where CustomerId in 
(Select c.CustomerId  from Customers c inner join Purchases p 
on c.CustomerId = p.CustomerId
where
price in (select Min(Price) from Purchases 
Group by ProductId) 
Group by c.CustomerId
order by c.CustomerId desc)
group by CustomerId) purchaseAmountMapping
where cu.CustomerId = purchaseAmountMapping.CustomerId
order by cu.CustomerId desc
"
10955,3893287,"Select T.FirstName, T.LastName, T.total
from
(Select DISTINCT C.FirstName, C.LastName, (Select count(*) From Purchases where P.CustomerId = CustomerId) as total, C.CustomerId
From Customers C
Join Purchases P on C.CustomerId = P.CustomerId
Where P.Price = (Select Min(PP.Price) From Purchases PP where PP.ProductId = P.ProductId)
Order by C.CustomerId Desc) as T
"
35862,3893287,"SELECT FirstName, LastName, (SELECT Count(*) FROM Purchases x WHERE c.CustomerId = x.CustomerId)
FROM Customers c INNER JOIN Purchases p on c.CustomerId = p.CustomerId
WHERE p.Price <= ALL(SELECT Price FROM Purchases d WHERE p.ProductId = d.ProductId)
GROUP BY c.CustomerId
Order By c.CustomerId DESC"
4915,3893287,"SELECT FirstName, LastName, COUNT(*)
FROM Customers NATURAL JOIN Purchases
GROUP BY FirstName, LastName, CustomerId
HAVING CustomerId IN (
SELECT CustomerId
FROM Purchases P1
WHERE Price <= ALL(
SELECT price
FROM Purchases P2
WHERE P1.ProductId = P2.ProductId)
)
ORDER BY CustomerId DESC
"
33977,3893287,"select FirstName, LastName, count(*)
from Customers c, Purchases p
where c.CustomerId = p.CustomerId
and c.CustomerId in (select CustomerId
                     from Purchases
                     where Price in (select min(Price)
                                        from Purchases
                                        group by ProductId))
group by FirstName, LastName, c.CustomerId
order by c.CustomerId desc;"
11485,3893287,"Select x.FirstName, x.LastName, count(x.CustomerId)
from
    (Select g.FirstName, g.LastName, g.CustomerId, count(p1.ProductId) as counts
    from 
        (Select cx.CustomerId, cx.FirstName, cx.LastName
        From (Customers cx JOIN Purchases px on cx.CustomerId=px.CustomerId)
        Where px.Price < ALL (Select Price 
                         from Purchases p3 
                         where p3.ProductId = px.ProductId and 
                               px.CustomerId <> p3.CustomerId)
        ) as g JOIN
        Purchases p1 on g.CustomerId=p1.CustomerId
    group by p1.PurchaseId, g.CustomerId) as x
group by x.CustomerId
order by x.CustomerId DESC

"
325288,3893287,"SELECT c.FirstName, c.LastName, COUNT(p.PurchaseId)
FROM Customers c, Purchases p
WHERE c.CustomerId=p.CustomerId AND c.CustomerId IN (
    SELECT c1.CustomerId
    FROM Customers c1, Purchases p1
    WHERE c1.CustomerId=p1.CustomerId
    AND p1.Price <= ALL(SELECT p2.Price FROM Purchases p2 WHERE p1.ProductId=p2.ProductId)
)
GROUP BY p.CustomerId
ORDER BY c.CustomerId DESC;"
37668,3893287,"SELECT C.FirstName, C.LastName, ( SELECT COUNT(*)
                                  FROM Purchases
                                  WHERE CustomerId = C.CustomerId
                                )
FROM Customers C, Purchases P
WHERE C.CustomerId = P.CustomerId AND
      P.Price = (
        SELECT MIN(Price)
        FROM Purchases
        WHERE ProductId = P.ProductId
        )
GROUP BY C.CustomerId
ORDER BY C.CustomerId DESC
"
9606,3893287,"Select c.FirstName, c.LastName, count(p.Price)
From Customers c, Purchases p
Where c.CustomerId = p.CustomerId and c.CustomerId in (Select p1.CustomerId
From Purchases p1 
Where p1.Price = (Select Min(p2.Price)
From Purchases p2
Where p2.ProductId = p1.ProductId
Group By p2.ProductId))
Group By p.CustomerId
Order By c.CustomerId Desc"
34406,3893287,"select 
(select FirstName from Customers where CustomerId = pr.CustomerId),
(select LastName from Customers where CustomerId = pr.CustomerId),
(select count(*) from Purchases where CustomerId = pr.CustomerId)
from Purchases pr
where pr.Price = 
(select min(Price)
from Purchases
where ProductId = pr.ProductId)
group by pr.CustomerId
order by pr.CustomerId desc

-- select FirstName, LastName, 
-- ()
-- from Customers
-- where 
-- order by CustomerId"
331824,3893287,"SELECT M.FirstName, M.LastName, COUNT(M.CustomerId) AS CountNum 
FROM (
       SELECT C.CustomerId, C.FirstName, C.LastName 
       FROM Customers C  INNER JOIN (
                         SELECT pur.CustomerId
                         FROM Purchases pur JOIN (
                                 SELECT ProductId, MIN(Price) AS MINPRICE
                                 FROM Purchases 
                                 GROUP BY ProductId) AS MINT
                                 ON pur.ProductId = MINT.ProductId AND pur.Price = MINT.MINPRICE
                         GROUP BY pur.CustomerId) AS T
                         ON C.CustomerId = T.CustomerId) AS M
LEFT JOIN Purchases 
ON M.CustomerId = Purchases.CustomerId
GROUP BY M.CustomerId, M.FirstName, M.LastName 
ORDER BY M.CustomerId DESC;"
31817,3893287,"SELECT FirstName, LastName, (SELECT COUNT(Pi.ProductId)
                                FROM Purchases Pi
                                WHERE C.CustomerId = Pi.CustomerId)
FROM Customers C JOIN Purchases P ON C.CustomerId = P.CustomerId
WHERE Price IN (
    SELECT MIN(Price)
    FROM Purchases
    GROUP BY ProductId
    )
GROUP BY P.CustomerId
ORDER BY P.CustomerId DESC;"
33147,3893287,"SELECT FirstName, LastName, count(CustomerId)
FROM Customers c2 NATURAL JOIN Purchases p2
WHERE c2.CustomerId IN (SELECT DISTINCT CustomerId
FROM Customers c NATURAL JOIN Purchases p
WHERE p.Price = (SELECT MIN(Price)
                FROM Purchases p2
                WHERE p2.ProductId = p.ProductId)
GROUP BY CustomerId)
Group by CustomerId
ORDER BY CustomerId DESC
"
317203,3893287,"select FirstName, LastName, (select count(Purchases.CustomerId) from Purchases where a.CustomerId = Purchases.CustomerId)
from Customers a
where CustomerId = any (select CustomerId from Purchases b where b.Price = (select Min(price) from Purchases c where b.ProductId = c.ProductId))
order by CustomerId desc"
331548,3893287,"select c.FirstName, c.LastName, count(p.PurchaseId)
from Customers c join Purchases p
on c.CustomerId = p.CustomerId
where c.CustomerId in 
(
select p3.CustomerId 
from Purchases p3 join (select p2.ProductId, min(p2.Price) as minPrice from Purchases p2 group by p2. ProductId) as temp
on p3.ProductId = temp.ProductId
where p3.Price = temp.minPrice

)
group by c.CustomerId
order by c.CustomerId desc"
131080,3893287,"SELECT c.FirstName, c.LastName, COUNT(*) AS numPurchases
FROM Customers c JOIN Purchases p ON(c.CustomerId = p.CustomerId)

WHERE c.CustomerId IN (
SELECT DISTINCT c.CustomerId
FROM Customers c JOIN Purchases p ON(c.CustomerId = p.CustomerId)
WHERE Price <= (
    SELECT MIN(Price)
    FROM Purchases p2
    WHERE p.ProductId = p2.ProductId)
    
)

GROUP BY p.CustomerId
ORDER BY c.CustomerId DESC


"
11481,3893287,"Select T.FirstName, T.LastName, T.total
from
(Select DISTINCT C.FirstName, C.LastName, (Select count(*) From Purchases where P.CustomerId = CustomerId) as total, C.CustomerId
From Customers C
Join Purchases P on C.CustomerId = P.CustomerId
Where P.Price = (Select Min(PP.Price) From Purchases PP where PP.ProductId = P.ProductId)
Order by C.CustomerId Desc) as T"
33032,3893287,"Select hoho.FirstName, hoho.LastName, hoho.num
From (Select DISTINCT c.FirstName, c.LastName, (Select count(*) From Purchases p3 Where p3.Customerid = c.customerid) AS num, c.customerid
From Customers c, Purchases p
Where c.customerid = p.customerid && p.Price <= ALL( Select p2.price
  From Purchases p2 
  Where p.productID = p2.ProductID) ) AS hoho
#Group by c.customerID
Order by hoho.customerid DESC"
131447,3893287,"SELECT Customers.FirstName, Customers.LastName, COUNT(Purchases.PurchaseId)
FROM 
(SELECT Customers.CustomerId
    FROM Customers
    JOIN Purchases ON Purchases.CustomerId = Customers.CustomerId
    JOIN (SELECT Products.ProductId, MIN(Purchases.Price) AS Price
        FROM Purchases
        JOIN Products ON Products.ProductId = Purchases.ProductId
        GROUP BY Products.ProductName, Products.ProductId) AS cheapest
        ON cheapest.ProductId = Purchases.ProductId
    WHERE cheapest.Price = Purchases.Price
    GROUP BY Customers.CustomerId) AS c
JOIN Customers ON Customers.CustomerId = c.CustomerId
JOIN Purchases ON c.CustomerId = Purchases.CustomerId
GROUP BY Customers.FirstName, Customers.LastName, Customers.CustomerId
ORDER BY Customers.CustomerId DESC"
34549,3893287,"SELECT L.FirstName, L.LastName, R.CartSize
FROM
    Customers as L,
    (
    SELECT CustomerId, COUNT(CustomerId) as CartSize
    FROM Purchases
    WHERE CustomerId IN (
        SELECT CustomerId
        FROM Purchases as P,
            (
            SELECT ProductId, MIN(Price) as Price
            FROM Purchases
            GROUP BY ProductId
            ) as P_Min
        WHERE P.ProductId = P_Min.ProductId AND P.Price = P_Min.Price
    )
    GROUP BY CustomerId
    ) as R
WHERE
    L.CustomerId = R.CustomerId
ORDER BY L.CustomerId DESC"
32845,3893287,"SELECT FirstName, LastName, TotalPurchases
FROM (SELECT DISTINCT Customers.CustomerId, FirstName, LastName, TotalPurchases
      FROM Customers,
           Purchases,
           (SELECT ProductId, MIN(Price) AS LowestPrice FROM Purchases GROUP BY ProductId) AS LowestPrices,
           (SELECT CustomerId, COUNT(PurchaseId) AS TotalPurchases FROM Purchases GROUP BY CustomerId ORDER BY CustomerId DESC) AS CustomerReceipt
      WHERE Customers.CustomerId = Purchases.CustomerId AND
           Purchases.ProductId = LowestPrices.ProductId AND
           Purchases.Price = LowestPrices.LowestPrice AND
           CustomerReceipt.CustomerId = Customers.CustomerId
      ORDER BY Customers.CustomerId DESC
     ) AS ordered_table;
           
    "
128458,3893287,"SELECT t1.FirstName, t1.LastName, COUNT(p2.PurchaseId)
FROM
(SELECT Customers.FirstName as FirstName, Customers.LastName as LastName, Customers.CustomerId
FROM Customers
INNER JOIN Purchases p
ON Customers.CustomerId = p.CustomerId
INNER JOIN Products
ON Products.ProductId = p.ProductId
INNER JOIN Brands
ON Brands.BrandName = Products.BrandName
WHERE p.Price <= (SELECT MIN(Price) FROM Purchases INNER JOIN Products ON Products.ProductId = Purchases.ProductId WHERE p.ProductId = Purchases.ProductId)
GROUP BY Customers.CustomerId
ORDER BY Customers.CustomerId DESC) as t1
INNER JOIN Purchases as p2
ON p2.CustomerId = t1.CustomerId
GROUP BY t1.CustomerId
ORDER BY t1.CustomerId DESC

"
34603,3893287,"SELECT re.FirstName, re.LastName, COUNT(pr.PurchaseId)
FROM 
(SELECT DISTINCT c.FirstName, c.LastName, c.CustomerId
FROM Customers c JOIN  Purchases p ON c.CustomerId = p.CustomerId
WHERE p.Price IN (SELECT MIN(Price) FROM Purchases GROUP BY ProductId)
) re JOIN Purchases pr ON re.CustomerId = pr.CustomerId

GROUP BY re.CustomerId
ORDER BY re.CustomerId DESC




"
5749,3893287,"SELECT c.FirstName, c.LastName, (SELECT COUNT(*) FROM Purchases p WHERE p.CustomerId = c.CustomerId)
FROM Purchases pur1 
JOIN Customers c on pur1.CustomerId = c.CustomerId
WHERE pur1.Price IN (
    SELECT MIN(price)
    FROM Purchases pur2
    WHERE pur2.ProductId = pur1.ProductId
)
GROUP BY c.CustomerId
ORDER BY c.CustomerId DESC;"
127187,3893287,"SELECT FirstName, LastName, COUNT(Purchases.Price) FROM  Purchases JOIN Customers ON Purchases.CustomerId = Customers.CustomerId
WHERE Customers.CustomerId IN (SELECT Purchases.CustomerId FROM Purchases WHERE Price IN (SELECT MIN(PRICE) FROM Purchases GROUP BY Purchases.ProductId) GROUP BY CustomerId)
GROUP BY Purchases.CustomerId
ORDER BY Purchases.CustomerId DESC;"
34602,3893287,"SELECT FirstName, LastName, NumPurchases
FROM (
    SELECT CustomerId, FirstName, LastName, COUNT(PurchaseId) AS NumPurchases
    FROM Customers
    NATURAL JOIN Purchases
    WHERE CustomerId IN
    (
        SELECT CustomerId
        FROM Customers
        NATURAL JOIN Purchases
        WHERE (ProductId, Price) IN (
            SELECT ProductId, MIN(Price) AS MinPrice
            FROM Purchases
            GROUP BY ProductId
        )
    )
    GROUP BY CustomerId, FirstName, LastName
    ORDER BY CustomerId DESC, FirstName, LastName
) AS sub"
308057,3893287,"SELECT FirstName, LastName, COUNT(*)
FROM Customers NATURAL JOIN Purchases
WHERE CustomerId IN 
(SELECT CustomerId
    FROM Customers NATURAL JOIN Purchases
    WHERE (ProductId, Price) IN (SELECT ProductId, MIN(Price) FROM Purchases GROUP BY ProductId)
)
GROUP BY CustomerId
ORDER BY CustomerId DESC
"
36304,3893287,"Select ca.FirstName, ca.LastName, d.pprice
from Customers ca
inner join
(Select count(Purchases.PurchaseID) as pprice, Purchases.CustomerId
from Purchases
inner join 
(Select DISTINCT c.CustomerID, c.FirstName, c.LastName
from Customers c
inner join (Select *
    from Purchases as pu
    inner join (Select p.ProductID as pTable, MIN(p.Price) as minprice
    from Purchases p
    group by pTable) as a
where pu.ProductID = a.pTable AND pu.Price = a.minprice) as b
where c.CustomerID = b.CustomerID) as fintable
where Purchases.CustomerID = fintable.CustomerID
Group By Purchases.CustomerID) as d
where  ca.CustomerID = d.CustomerID
order by ca.CustomerID DESC"
126177,3893287,"Select cc.FirstName, cc.LastName, nameWithCount.theCounter
From Customers cc, (Select pu.CustomerId, Count(pu.CustomerId) as theCounter
    From Purchases pu , (SELECT Distinct a.CustomerId
        FROM Purchases a JOIN ( 
            SELECT ProductId, MIN(Price) minPrice
            FROM Purchases
            GROUP BY ProductId 
            ) minPriceTable 
        ON a.ProductId = minPriceTable.ProductId AND a.Price = minPriceTable.minPrice
        Order by a.CustomerId desc) minBuyers
    Where pu.CustomerId = minBuyers.CustomerId
    Group By pu.CustomerId
    Order By pu.CustomerId desc) nameWithCount
Where cc.CustomerId = nameWithCount.CustomerId
Order By cc.CustomerId desc"
30205,3893287,"SELECT output.FirstName, output.LastName, COUNT(*)
		FROM (SELECT DISTINCT Customers.FirstName, Customers.LastName, Customers.CustomerId
			FROM Purchases p
			INNER JOIN Customers ON p.CustomerId=Customers.CustomerId
			INNER JOIN Products ON p.ProductID = Products.ProductID
			INNER JOIN Brands ON Products.BrandName = Brands.BrandName
			WHERE (p.Price, p.ProductId) IN (SELECT MIN(Price), ProductId FROM Purchases GROUP BY ProductId)
			ORDER BY Customers.CustomerId DESC) as output
		LEFT JOIN Purchases 
		ON Purchases.CustomerId = output.CustomerId
		GROUP BY output.CustomerId
		ORDER BY output.CustomerId DESC"
12098,3893287,"SELECT FirstName, Lastname, COUNT(*)
FROM Customers c JOIN Purchases p3 ON c.CustomerId = p3.CustomerId
WHERE p3.CustomerId IN 
    (SELECT DISTINCT CustomerId
    FROM Purchases pu2 JOIN
        (SELECT ProductId, MIN(Price) as MinPrice
        FROM Purchases pu1
        GROUP BY ProductId) temp1
        ON temp1.ProductId = pu2.ProductId AND temp1.MinPrice = pu2.Price
)
GROUP BY p3.CustomerId
ORDER BY p3.CustomerId DESC;"
186896,3893287,"SELECT c.FirstName, c.LastName, (SELECT COUNT(*) 
                                 FROM Purchases pt 
                                 WHERE (c.CustomerId = pt.CustomerId))
FROM Customers c NATURAL JOIN Purchases p
WHERE p.Price = (SELECT MIN(pr.Price) 
                 FROM Purchases pr 
                 WHERE p.ProductId = pr.ProductId)
GROUP BY c.FirstName, c.LastName, c.CustomerId
ORDER BY c.CustomerId DESC"
83742,3893287,"SELECT a.FirstName, a.LastName, a.TotalPurchases
FROM
(SELECT c.FirstName, c.LastName, COUNT(*) AS TotalPurchases, c.CustomerId
FROM (
    SELECT DISTINCT CustomerId
    FROM Purchases p
    JOIN (
        SELECT MIN(PRICE) AS minPrice, ProductId
        FROM Purchases
        GROUP BY ProductId
        )mins 
    ON p.ProductId = mins.ProductId
    AND p.Price = mins.minPrice
) minPeeps
JOIN Customers c ON minPeeps.CustomerId = c.CustomerId
JOIN Purchases p ON minPeeps.CustomerId = p.CustomerId

GROUP BY c.FirstName, c.LastName, c.CustomerId
ORDER BY c.CustomerId DESC)
a;"
38711,3893287,"SELECT FirstName, LastName, COUNT(P.PurchaseId)
FROM Purchases P LEFT OUTER JOIN Customers C
    ON P.CustomerId = C.CustomerId

WHERE C.CustomerId IN 
    (SELECT DISTINCT C.CustomerId
    FROM (SELECT ProductId, MIN(Price) as minp
        FROM Purchases
        GROUP BY ProductId) as temp, Purchases P, Customers C
    WHERE (temp.ProductId = P.ProductId 
        and temp.minp = P.Price 
        and C.CustomerId = P.CustomerId))

GROUP BY C.CustomerId
ORDER BY C.CustomerId DESC"
33334,3893287,"SELECT FirstName, LastName, TotalNumber
FROM Customers NATURAL JOIN (SELECT CustomerId, COUNT(*) as TotalNumber 
FROM Purchases NATURAL JOIN (SELECT CustomerId FROM Purchases p JOIN (SELECT ProductId p0, MIN(Price) as MinPrice from Purchases GROUP BY ProductId) as pur0 
WHERE p.Price=MinPrice GROUP BY CustomerId) as pur1 GROUP BY CustomerId) as pur2
ORDER BY CustomerId DESC"
336531,3893287,"select c1.FirstName, c1.LastName, count(*) from  Purchases p1
join Customers c1 on c1.CustomerId = p1.CustomerId 
where c1.CustomerId in
(select p.CustomerId 
from Purchases p 
join 
(select min(Purchases.Price) as min_price, Purchases.ProductId as min_id
from Purchases
group by min_id) min_table
on min_table.min_id = p.ProductId
where p.Price=min_table.min_price
)
group by p1.CustomerId
order by c1.CustomerId DESC"
331920,3893287,"SELECT FirstName, LastName, COUNT(ProductID)
FROM
(SELECT DISTINCT c.FirstName, c.LastName, c.CustomerId
FROM Customers c, Purchases p
WHERE p.Price = (SELECT MIN(p3.Price) FROM Purchases p3 WHERE p3.ProductId = p.ProductId) and c.CustomerId = p.CustomerId) AS temp1 NATURAL JOIN Purchases p2
GROUP BY CustomerId
ORDER BY CustomerId DESC"
6193,3893287,"select c.FirstName, c.LastName, a.total_number from Customers c join (select CustomerId ,count(1) as total_number from Purchases p where CustomerId in (select CustomerId from Purchases p join (select p.ProductId, min(Price) as min_price from Purchases p group by p.ProductId) b on p.ProductId = b.ProductId where p.Price = b.min_price) group by CustomerId) a on c.CustomerId = a.CustomerId order by c.CustomerId desc


"
35368,3893287,"SELECT FirstName, LastName, count(PurchaseId)
FROM Purchases
INNER JOIN Customers c
ON c.CustomerId = Purchases.CustomerId
WHERE Purchases.CustomerId IN (
    SELECT p.CustomerId
    FROM Purchases p
    WHERE p.Price IN (
        SELECT min(p2.Price)
        FROM Purchases p2
        WHERE p.ProductId = p2.ProductId
    )
)
GROUP BY FirstName, LastName, c.CustomerId
ORDER BY c.CustomerId desc
"
5498,3893287,"SELECT c.FirstName, c.LastName, COUNT(p.PurchaseId)
FROM Customers c
INNER JOIN Purchases p ON c.CustomerId = p.CustomerId
WHERE c.CustomerId IN 
    (
        SELECT cus.CustomerId
        FROM Customers cus
        INNER JOIN Purchases pur ON cus.CustomerId = pur.CustomerId
        WHERE pur.Price = (SELECT MIN(Price) FROM Purchases WHERE ProductId = pur.ProductId)
    )
GROUP BY c.CustomerId
ORDER BY c.CustomerId DESC;"
34712,3893287,"select
    c.FirstName, c.LastName, final.pcnt
from
    Customers c
    inner join
    (select distinct
        FirstName, LastName, pc.cnt pcnt, c.CustomerId cid
    from
        (Customers c, Purchases pu)
        inner join
        (select 
            count(*) cnt, CustomerId
        from
            Purchases pu
        group by CustomerId) pc 
    on pc.CustomerId = pu.CustomerId
    where (c.CustomerId = pu.CustomerId
    and pu.Price in (
        select 
            min(Price)
        from
            Purchases
        group by
            ProductId
    ))) final
    on final.cid = c.CustomerId
    order by c.CustomerId desc"
5467,3893287,"select data_.FirstName, data_.LastName, data_.t
from(
    select distinct cust.FirstName, cust.LastName, (select count(*) from Purchases 
    where purch.CustomerId = CustomerId) as t, cust.CustomerId
    from Customers cust Join Purchases purch on 
    cust.CustomerId = purch.CustomerId
    where purch.Price = (
        select Min(purch_2.Price) from Purchases purch_2 where purch_2.ProductId = purch.ProductId
    )
    order by cust.CustomerId desc
) as data_;"
310293,3893287,"select p4.FirstName, p4.LastName, count(p4.CustomerId) as count from (
    select Customers.CustomerId, Customers.FirstName, Customers.LastName from Customers join (select p1.CustomerId from Purchases p1 join (
            select ProductId, min(Price) as min from Purchases group by ProductId
        ) as p2 on p1.ProductId = p2.ProductId and p1.Price = p2.min group by p1.CustomerId) as p3 on Customers.CustomerId = p3.CustomerId
    ) as p4 left join Purchases on p4.CustomerId = Purchases.CustomerId group by p4.CustomerId, p4.FirstName, p4.LastName order by p4.CustomerId DESC ;"
5739,3893287,"SELECT Customers.FirstName, Customers.LastName, COUNT(Purchases.CustomerId)
FROM Customers
NATURAL JOIN Purchases
WHERE Purchases.CustomerId IN (
    SELECT Purchases.CustomerId       #grabs customer who bought it at this price note: this wouldn't work if there were 2 products that has the same price? 
    FROM Purchases 
    WHERE Purchases.Price IN ( #checks lowest price
        SELECT MIN(Purchases.Price)
        FROM Purchases
        GROUP BY Purchases.ProductId
        )
    )
    GROUP BY Purchases.CustomerId
    ORDER BY CustomerId DESC"
32969,3893287,"select c.FirstName, c.LastName, count(p.PurchaseId)
from Customers c join Purchases p on c.CustomerId = p.CustomerId
where c.CustomerId in (select c2.CustomerId from Purchases p2 join Customers c2 on p2.CustomerId = c2.CustomerId where p2.Price = (select min(p3.Price) from Purchases p3 where p3.ProductId = p2.ProductId))
group by c.CustomerId
order by c.CustomerId desc


-- select prod.ProductName, min(purch.Price)
-- from Purchases purch join Products prod on purch.ProductId = prod.ProductId, Customers c
-- group by prod.ProductName

"
4397,3893287,"SElECT C.FirstName, C.LastName, (SELECT COUNT(*) FROM Purchases WHERE CustomerId = C.CustomerId)
FROM Customers C
JOIN Purchases P ON (P.CustomerId = C.CustomerId)
JOIN (SELECT P.ProductId, MIN(P.PRICE) as MPRICE FROM Purchases P GROUP BY P.ProductId) Pu ON (Pu.ProductId = P.ProductId AND Pu.MPRICE = P.PRICE)
GROUP BY C.CustomerId
ORDER BY C.CustomerId DESC "
33861,3893287,"select
c.FirstName,
c.LastName,
count(*)
from Purchases p1 inner join Customers c on p1.CustomerId=c.CustomerId
where 
c.CustomerId in (select p3.CustomerId from Purchases p3 where
p3.Price = (select min(p2.Price) from Purchases p2 where p2.ProductId=p3.ProductId))
group by c.FirstName, c.LastName, c.CustomerId
order by c.CustomerId desc"
202279,3893287,"SELECT FirstName, LastName, COUNT(PurchaseId)
FROM Purchases NATURAL JOIN Customers 
WHERE FirstName IN
(SELECT FirstName FROM Purchases NATURAL JOIN Customers
WHERE Purchases.Price IN (SELECT MIN(Price) FROM Purchases GROUP BY ProductId)
GROUP BY CustomerId)
GROUP BY CustomerId
ORDER BY MIN(CustomerId) DESC"
126834,3893287,"SELECT C.FirstName, C.LastName, COUNT(P.PurchaseId)
FROM Customers C, Purchases P, 
    (SELECT DISTINCT C.CustomerId
    FROM Customers C, Purchases P, (SELECT MIN(Price) AS Price FROM Purchases GROUP BY ProductId) AS MINP
    WHERE C.CustomerId = P.CustomerId 
    AND P.Price = MINP.Price) AS MINC
WHERE C.CustomerId = MINC.CustomerId AND P.CustomerId = C.CustomerId
GROUP BY C.CustomerId
ORDER BY C.CustomerId DESC"
7926,3893287,"select FirstName, LastName, c from 
(select CustomerId, count(CustomerId) as c from Purchases
where Purchases.CustomerId in
(select CustomerId from Purchases
inner join (select ProductId, min(Price) as minPrice from Purchases group by productId) as M
on Purchases.ProductId = M.ProductId and Purchases.Price = M.minPrice)
group by CustomerId) as O
left join
Customers on Customers.CustomerId = O.CustomerId
order by Customers.CustomerId desc"
36316,3893287,"SELECT FirstName AS f, LastName AS l, (SELECT COUNT(PurchaseId) FROM Purchases p JOIN Customers cus ON p.CustomerId = cus.CustomerId WHERE cus.FirstName = f AND cus.LastName = l GROUP BY p.CustomerId)
FROM Purchases pur JOIN Customers cus ON pur.CustomerId = cus.CustomerId
WHERE pur.Price IN (SELECT MIN(pu.Price) FROM Purchases pu GROUP BY pu.ProductId) 
GROUP BY pur.CustomerId
ORDER BY pur.CustomerId DESC;"
31860,3893287,"select cc.FirstName, cc.LastName, count(*) from Customers cc left outer join Purchases pp on cc.CustomerId = pp.CustomerId where cc.CustomerId in (select CustomerId from Purchases p left join (select ProductId, min(Price) as m from Purchases group by ProductId) x on p.ProductId = x.ProductId where p.Price = x.m) group by cc.CustomerId order by cc.CustomerId desc"
34139,3893287,"SELECT Customers.FirstName, Customers.LastName, COUNT(Purchases.PurchaseId)
FROM Customers
JOIN Purchases ON Customers.CustomerId = Purchases.CustomerId
WHERE Customers.CustomerId in 
(
    SELECT Customers.CustomerId
    FROM Customers
    JOIN Purchases ON Customers.CustomerId = Purchases.CustomerId
    WHERE Purchases.Price = (SELECT MIN(Price) FROM Purchases pur WHERE Purchases.ProductId = pur.ProductId)
    GROUP BY Customers.CustomerId
)
GROUP BY Customers.CustomerId
ORDER BY Customers.CustomerId DESC"
33326,3893287,"SELECT FirstName, LastName,
        (SELECT COUNT(*) FROM Purchases AS P WHERE P.CustomerId = Purchases.CustomerId)
    FROM Customers NATURAL JOIN Purchases
    WHERE (Price, ProductId) IN (
        SELECT MIN(Price), ProductId FROM Purchases
            GROUP BY ProductId
    )
    GROUP BY CustomerId
    ORDER BY CustomerId DESC"
36288,3893287,"SELECT bigsub.fir, bigsub.las, bigsub.ctt
FROM
(SELECT DISTINCT cus.FirstName as fir, cus.LastName as las, cus.CustomerId, ctr.ct as ctt
FROM Purchases pur1
JOIN (SELECT pur.ProductId, MIN(Price) as pri FROM Purchases pur
GROUP BY pur.ProductId) as pur2 on pur1.ProductId = pur2.ProductId AND pur1.Price = pur2.pri
JOIN Customers as cus on pur1.CustomerId = cus.CustomerId
JOIN (SELECT CustomerId, COUNT(*) as ct
FROM Purchases
GROUP BY CustomerId) as ctr on cus.CustomerId = ctr.CustomerId
ORDER BY cus.CustomerId DESC) as bigsub;"
33496,3893287,"SELECT FirstName, LastName, COUNT(C.CustomerId)
FROM Customers C
JOIN Purchases P ON C.CustomerId = P.CustomerId
WHERE C.CustomerId IN (
    SELECT CustomerId
    FROM Purchases A
    WHERE Price = (
        SELECT MIN(Price)
        FROM Purchases B
        WHERE A.ProductId = B.ProductId
    )
)
GROUP BY C.CustomerId
ORDER BY C.CustomerId DESC;"
34474,3893287,"select c.FirstName, c.LastName, count(*) 
from Customers as c JOIN Purchases as p ON c.CustomerId = p.CustomerId
Group By c.FirstName, c.LastName,c.CustomerId
HAVING c.CustomerId IN(SELECT p1.CustomerId From Purchases p1 where p1.Price <= ALL(select p2.Price From Purchases p2 where p1.ProductId = p2.ProductId))
Order By c.CustomerId DESC"
5259,3893287,"SELECT FirstName, LastName, total_purchase
FROM Customers NATURAL JOIN (SELECT CustomerId, count(PurchaseId) as total_purchase FROM Customers NATURAL JOIN Purchases GROUP BY CustomerId) AS Purchase_Table
WHERE CustomerId in (SELECT DISTINCT CustomerId FROM Purchases NATURAL JOIN (SELECT ProductId, MIN(Price) as Min_Price FROM Purchases GROUP BY ProductId) AS MIN_PRICE_TABLE WHERE Price = Min_Price)
ORDER BY CustomerId DESC;"
5265,3893287,"SELECT c.FirstName, c.LastName, COUNT(pc4.PurchaseId)
FROM (
    SELECT DISTINCT pc1.CustomerId  # Get distinct customer IDs so they're not counted more than once in above query
    FROM Purchases pc1
    WHERE pc1.Price < ALL(
        SELECT pc2.Price
        FROM Purchases pc2
        WHERE pc1.ProductId = pc2.ProductId  # Same product
        AND pc1.PurchaseId <> pc2.PurchaseId  # Diff purchase
    )
) AS pc3
NATURAL JOIN Customers c
NATURAL JOIN Purchases pc4
GROUP BY c.CustomerId
ORDER BY pc4.CustomerId DESC

# Why doesn't below query WORK? Is it because I'm performing a JOIN after a GROUP BY?
# SELECT DISTINCT c.FirstName, c.LastName, COUNT(pc4.PurchaseId)
# FROM (
#     SELECT pc1.ProductId, MIN(pc1.Price) AS minPrice
#     FROM Purchases pc1
#     GROUP BY pc1.ProductId
#     JOIN Purchases pc2
#     ON pc1.ProductId = pc2.ProductId
#     AND minPrice = pc2.Price
# ) AS pc3
# NATURAL JOIN Customers c
# NATURAL JOIN Purchases pc4
# GROUP BY c.CustomerId
# ORDER BY pc4.CustomerId DESC"
5503,3893287,"SELECT C.FirstName, C.LastName, COUNT(P.PurchaseId)
FROM Customers C
INNER JOIN Purchases P on P.CustomerId = C.CustomerId
WHERE C.CustomerId IN
(SELECT DISTINCT Cu.CustomerId
FROM Customers Cu
INNER JOIN Purchases Pu
ON Cu.CustomerId = Pu.CustomerId
WHERE Pu.Price = (SELECT MIN(Pu2.Price) from Purchases Pu2 WHERE Pu2.ProductId = Pu.ProductId))
GROUP BY C.CustomerId
ORDER BY C.CustomerId DESC




"
5271,3893287,"SELECT c.FirstName, c.LastName, COUNT(c.CustomerId)
FROM Customers c NATURAL JOIN Purchases p
WHERE c.CustomerID IN
    (SELECT DISTINCT CustomerId 
    FROM Purchases p1 INNER JOIN
    (
        SELECT ProductId, MIN(Price) MinPrice
        FROM Purchases
        GROUP BY ProductId
    ) p2 ON p1.ProductId = p2.ProductId AND p1.Price = p2.MinPrice
    )
GROUP BY c.CustomerId
ORDER BY c.CustomerId DESC"
4769,3893287,"SELECT cus.FirstName, cus.LastName, COUNT(pur.PurchaseId)
FROM Purchases pur NATURAL JOIN Customers cus
WHERE CustomerId = ANY( SELECT CustomerId 
                        FROM Purchases NATURAL JOIN (SELECT ProductId, MIN(Price) minPrice
                                                     FROM Purchases 
                                                     GROUP BY ProductId) minPriceProduct
                        WHERE Price = minPrice
                        )
GROUP BY CustomerId
ORDER BY CustomerId DESC"
35385,3893287,"SELECT Cu.FirstName, Cu.LastName, 
    (SELECT COUNT(*)
    FROM Purchases as C
    WHERE C.CustomerId = Cu.CustomerId
    )
FROM Customers as Cu
WHERE Cu.CustomerId IN
(SELECT Pur.CustomerId FROM Purchases as Pur INNER JOIN Products as Pro ON Pur.ProductId = Pro.ProductId WHERE Pur.Price = (SELECT MIN(PPP.Price) FROM Purchases as PPP WHERE PPP.ProductId = Pur.ProductId))
ORDER BY Cu.CustomerId DESC"
332195,3893287,"Select  c.FirstName, c.LastName, t.total
From Customers c, (Select CustomerId, count(PurchaseId) as total
                    From Customers Natural Join Purchases 
                    Group By CustomerId) as t
Where c.customerId IN (Select DISTINCT CustomerId
                      From Purchases p1
                      Where price =  (Select MIN(price)
                                        From Purchases p2
                                         Where p1.ProductId = p2.ProductId)
                     )
                    AND c.CustomerId = t.CustomerId
Order By c.CustomerId DESC"
335822,3893287,"select C.FirstName, C.LastName, count(P.PurchaseId)
from Customers as C left join Purchases as P on C.CustomerId = P.CustomerId
where C.CustomerId in (select CustomerId from Purchases,
(select ProductId, min(Price) as Price from Purchases group by ProductId) as minPrice
where Purchases.ProductId = minPrice.ProductId and Purchases.Price = minPrice.Price)
group by C.customerId
order by C.CustomerId DESC"
36117,3893287,"SELECT FirstName, LastName, COUNT(PurchaseId)
FROM Customers NATURAL JOIN (
    SELECT DISTINCT CustomerId
    FROM Purchases p
    WHERE Price = (SELECT MIN(Price) FROM Purchases WHERE ProductId = p.ProductId)
    ) as ThriftyCustomers 
    NATURAL JOIN Purchases
GROUP BY CustomerId
ORDER BY CustomerId desc;"
33084,3893287,"select st.FirstName, st.LastName, st.cts
from (select distinct *
from (select nm.FirstName, nm.LastName, cp.cts, nm.CustomerId
from (select c.FirstName, c.LastName, c.CustomerId
from Customers c, (select p.CustomerId
from Purchases p, (select min(Price) as minp, ProductId
from Purchases
group by ProductId) midx
where midx.ProductId = p.ProductId and midx.minp = p.Price) lowc
where c.CustomerId = lowc.CustomerId) nm, (select count(PurchaseId) as cts, CustomerId
from Purchases
group by CustomerId) cp
where nm.CustomerId = cp.CustomerId
) sth
) st
order by st.CustomerId DESC"
7276,3893287,"SELECT FIrstName, LastName, counts
FROM (
    SELECT FirstName, LastName, CustomerId, counts
    FROM Customers natural join(
    SELECT count(ProductId) as counts, CustomerId FROM Purchases p3 WHERE p3.CustomerId in (
    SELECT CustomerId FROM Purchases p1 WHERE p1.Price <= (
        SELECT min(Price) FROM Purchases p2 WHERE p2.ProductId = p1.ProductId)
    ) group by CustomerId
    )a ORDER BY CustomerId DESC
)b"
313213,3893287,"select FirstName, LastName, count(*)
from Customers C natural join Purchases where Purchases.CustomerId in 
    (select distinct P.CustomerId
    from Purchases P join
        (select ProductId, min(Price) as minPrice
        from Purchases
        group by ProductId) as T
    where P.ProductId = T.ProductId and T.minPrice = P.price)
group by Purchases.CustomerId
order by Purchases.CustomerId desc"
34660,3893287,"SELECT a.FirstName, a.LastName, COUNT(b.PurchaseId)
FROM Customers a RIGHT JOIN Purchases b 
    ON a.CustomerId = b.CustomerId
WHERE a.CustomerId IN (SELECT c.CustomerId FROM Customers c JOIN Purchases d ON c.CustomerId=d.CustomerId WHERE d.Price <= ANY(SELECT MIN(e.Price) FROM Purchases e WHERE e.ProductId = d.ProductId))
GROUP BY a.CustomerId
ORDER BY a.CustomerId DESC
"
33331,3893287,"Select A.FirstName, A.LastName, Count(D.PurchaseId)
From Customers A Natural Join Purchases D
Where CustomerId In (Select Cus.CustomerId
                      From Purchases B Natural Join Products C, Customers Cus
                      Where Cus.CustomerId = B.CustomerId and
                            (ProductId, B.Price) In (Select ProductId, Min(Pur.Price)
                                                    From Purchases Pur Natural Join Products Prod 
                                                    Group By ProductId))
Group By A.CustomerId, A.FirstName, A.LastName
Order By A.CustomerId Desc;"
34476,3893287,"select c.FirstName, c.LastName, tb1.ct from(select count(pur.PurchaseId) as ct, pur.CustomerId from Purchases pur group by pur.CustomerId)as tb1 join Customers c on c.CustomerId = tb1.CustomerId where c.CustomerId in (select pur2.CustomerId from Purchases pur2 where pur2.Price = (select min(pur3.Price) from Purchases pur3 where pur2.ProductId = pur3.ProductId)) order by c.CustomerId desc"
11185,3893287,"select A.FirstName, A.LastName, A.total
from (select distinct C.FirstName, C.LastName, (select count(*) 
                                                from Purchases
                                                where P.CustomerId = CustomerId) as total, C.CustomerId from Customers C join Purchases P on C.CustomerId = P.CustomerId
                                                where P.Price = (select min(P1.Price) from Purchases P1 where P1.ProductId = P.ProductId)
order by C.CustomerId desc) as A"
5460,3893287,"select C.FirstName, C.LastName, (select count(*) from Purchases where CustomerId = C.CustomerId) as _pCount
from Customers C
where C.CustomerId in (
    select Pch.CustomerId
    from Purchases Pch
    inner join (
        select ProductId, MIN(Price) Price
        from Purchases
        group by ProductId
    ) PB on Pch.ProductId = PB.ProductId and Pch.Price = PB.Price
)
order by C.CustomerId DESC;"
30765,3893287,"SELECT c.FirstName, c.LastName, COUNT(*)
FROM Customers c
NATURAL JOIN Purchases p1
WHERE c.CustomerId IN(
    SELECT DISTINCT p2.CustomerId
    FROM Purchases p2 NATURAL JOIN
        (SELECT p3.ProductId, MIN(p3.Price) AS minimum
         FROM Purchases p3 NATURAL JOIN Products
         GROUP BY ProductId) AS temp
    WHERE p2.Price=temp.minimum
)
GROUP BY c.CustomerId
ORDER BY c.CustomerId DESC;"
33739,3893287,"SELECT b.FirstName, b.LastName, count(*)
FROM Purchases p inner join Customers b on p.CustomerId=b.CustomerId
WHERE b.customerId in (SELECT p1.CustomerId from Purchases p1 where p1.Price = (select min(p2.Price) from Purchases p2 where p2.ProductId=p1.ProductId))
GROUP BY b.FirstName, b.LastName, b.CustomerId Order BY b.CustomerId desc









"
30542,3893287,"SELECT FirstName, LastName, counts 
FROM 
(
    SELECT DISTINCT FirstName, LastName, CustomerId,
        (SELECT COUNT(CustomerId) 
        FROM Purchases 
        WHERE CustomerId = p1.CustomerId) as counts
    FROM Purchases p1 NATURAL JOIN Customers
    WHERE Price <= ALL(SELECT Price FROM Purchases WHERE p1.ProductId = ProductId)
    ORDER BY CustomerId DESC
) as C1"
32963,3893287,"SELECT C3.FirstName, C3.LastName, (SELECT COUNT(P1.PurchaseId) FROM Purchases P1 WHERE C3.CustomerId = P1.CustomerId)
FROM (SELECT DISTINCT *
		FROM Customers C1
		WHERE C1.CustomerId = ANY(SELECT P2.CustomerId FROM Purchases P2 WHERE P2.Price = ANY(SELECT MIN(P3.Price) FROM Purchases P3 GROUP BY P3.ProductId))
        ORDER BY C1.CustomerId DESC) AS C3;"
5256,3893287,"SELECT FirstName, LastName, COUNT(CustomerId)
FROM Purchases NATURAL JOIN Customers
GROUP BY CustomerId
HAVING CustomerId = ANY(SELECT CustomerId
                        FROM Purchases
                        WHERE (ProductId, Price) = ANY(SELECT ProductId, MIN(Price)
                                          FROM Purchases
                                          GROUP BY ProductId))
ORDER BY CustomerId DESC"
31926,3893287,"SELECT FirstName, LastName, Num
FROM
    (SELECT DISTINCT PB.CustomerId, FirstName, LastName, NumPurchasesByCustomer.Num
    FROM Purchases PB RIGHT JOIN 
        (SELECT C.CustomerId, C.FirstName, C.LastName, COUNT(*) as Num
        FROM Customers C RIGHT JOIN Purchases P
        ON C.CustomerId = P.CustomerId
        GROUP BY C.CustomerId) AS NumPurchasesByCustomer ON NumPurchasesByCustomer.CustomerId = PB.CustomerId
    WHERE PB.Price IN
        (SELECT MIN(PC.Price)
        FROM Purchases PC
        GROUP BY PC.ProductId)
    ORDER BY PB.CustomerId DESC) AS Final"
33116,3893287,"SELECT Customers.FirstName, Customers.LastName, 
                            (SELECT COUNT(*)
                            FROM Purchases
    WHERE Purchases.CustomerId = Customers.CustomerId)
FROM Customers
WHERE Customers.CustomerId IN (
    SELECT Purchases.CustomerId
    FROM(
        SELECT min(PRICE) as Price, ProductId
        FROM Purchases
        GROUP BY ProductId) as temp, Purchases
    WHERE temp.Price = Purchases.Price and 
            temp.ProductId = Purchases.ProductId
)
ORDER BY CustomerId DESC"
11941,3893287,"SELECT O.FirstName, O.LastName, O.cnt
FROM (
SELECT DISTINCT
    C.FirstName, C.LastName, p.cnt, C.CustomerId
FROM
    Customers C
    JOIN
    (
        SELECT C.CustomerId, count(*) as cnt
        FROM 
            Customers C
            JOIN
            Purchases P
                on C.CustomerId = P.CustomerId
        GROUP by
            C.CustomerId
    ) as p 
        on C.CustomerId = p.CustomerId
WHERE
    C.CustomerId IN (
        SELECT CustomerId
        FROM
            Purchases P 
            JOIN (
                SELECT ProductId, MIN(Price) as MinPrice
                FROM Purchases
                GROUP by ProductId
            ) as m
                on P.ProductId = m.ProductId
        WHERE
            P.Price = m.MinPrice
    )
ORDER by C.CustomerId DESC
) as O
"
5678,3893287,"SELECT FirstName, LastName, COUNT(*)
FROM Customers c NATURAL JOIN Purchases p
WHERE CustomerId IN (SELECT CustomerId
                     FROM Purchases
                     WHERE price IN (SELECT MIN(Price) 
                                    From Purchases
                                    GROUP BY ProductId))
                     
GROUP BY CustomerId
ORDER BY CustomerId DESC"
86354,3893287,"SELECT c.FirstName, c.LastName, COUNT(*)
FROM
    (SELECT CustomerId
    FROM Purchases as p
    LEFT JOIN (SELECT ProductId, MIN(Price) AS minPrice FROM Purchases GROUP BY ProductId) AS m ON m.ProductId = p.ProductId
    WHERE Price <= minPrice
    GROUP BY CustomerId) AS custId
LEFT JOIN Customers AS c ON custId.CustomerId = c.CustomerId
INNER JOIN Purchases AS p ON c.CustomerId = p.CustomerId
GROUP BY c.CustomerId
ORDER BY c.CustomerId DESC;"
5308,3893287,"SELECT FirstName, LastName, COUNT(Purchases.CustomerId)
FROM Customers JOIN Purchases ON Customers.CustomerId = Purchases.CustomerId
WHERE Purchases.CustomerId IN
    (SELECT CustomerId
    FROM Purchases
    WHERE Price IN 
        (SELECT Min(Purchases.Price)
        FROM Purchases
        GROUP BY Purchases.ProductId))
GROUP BY Purchases.CustomerId
ORDER BY Purchases.CustomerId DESC
"
5283,3893287,"SELECT c.FirstName, c.LastName, COUNT(c.CustomerId)
FROM Customers c JOIN Purchases d ON (c.CustomerId = d.CustomerId)
WHERE c.CustomerId IN (SELECT CustomerId
FROM Purchases p 
WHERE p.price = (SELECT min(price) from Purchases q where p.productId = q.productId))
GROUP BY c.CustomerId
ORDER BY c.CustomerId DESC"
35941,3893287,"SELECT FirstName, LastName, COUNT(1)
FROM Customers c
INNER JOIN Purchases p1 ON c.CustomerId = p1.CustomerId
WHERE c.CustomerId in (
    SELECT p2.CustomerId
    FROM Purchases p2
    WHERE p2.Price = (
        SELECT MIN(p3.Price)
        FROM Purchases p3
        WHERE p3.ProductId = p2.ProductId
    )
)
GROUP BY FirstName, LastName, c.CustomerId
ORDER BY c.CustomerId DESC
"
34691,3893287,"SELECT C.FirstName, C.LastName, T.Num 
FROM (SELECT T.CustomerId, COUNT(P.PurchaseId) AS Num 
      FROM (SELECT DISTINCT P.CustomerId FROM Purchases P, (SELECT ProductId, MIN(Price) AS Price from Purchases GROUP BY ProductId) T WHERE P.ProductId = T.ProductId AND P.Price = T.Price) T, Purchases P 
      WHERE T.CustomerId = P.CustomerId 
      GROUP BY P.CustomerId) T, Customers C 
WHERE C.CustomerId = T.CustomerId 
ORDER BY C.CustomerId DESC;

"
36051,3893287,"SELECT Customers.FirstName, Customers.LastName, COUNT(Purchases.PurchaseId)
FROM Customers 
JOIN Purchases ON Customers.CustomerId = Purchases.CustomerId
WHERE Customers.CustomerId in
(
SELECT Customers.CustomerId
FROM Customers
JOIN Purchases ON Customers.CustomerId = Purchases.CustomerId
WHERE Purchases.Price = (
    SELECT MIN(Price)
    FROM Purchases P
    WHERE Purchases.ProductId = P.ProductId
)
GROUP BY Customers.CustomerId
) 
GROUP BY Customers.CustomerId
ORDER BY Customers.CustomerId DESC;
"
32394,3893287,"Select a.Firstname,a.LastName, Count(CustomerId)
From Customers a Natural Join Purchases b
where a.CustomerId in(
    select c.CustomerId
    From Purchases c natural join (
    select d.ProductId, MIN(d.Price) as lowest_price
    From Purchases d, Products e
    where d.ProductId = e.ProductId
    group by d.ProductId
    ) as sub_qu
    where c.Price = sub_qu.lowest_price
)
Group by a.CustomerId
Order by a.CustomerId DESC"
5645,3893287,"select FirstName, LastName, counts
from
(Select FirstName, LastName, CustomerId, counts
from Customers natural join (Select count(ProductId) as counts, CustomerId from Purchases p3 where p3.CustomerId in (Select CustomerId from Purchases p1 where p1.Price <= (Select min(Price) from Purchases p2 where p2.ProductId = p1.ProductId)) group by CustomerId) a
Order by CustomerId DESC) b

"
35616,3893287,"SELECT FirstName, LastName, COUNT(*)
FROM Purchases P
JOIN Customers C ON C.CustomerId = P.CustomerId
WHERE C.CustomerId IN (
    SELECT P1.CustomerId
    FROM Purchases P1
    WHERE P1.Price = (
        SELECT MIN(P2.Price)
        FROM Purchases P2
        WHERE P1.ProductId = P2.ProductId
    )
)
GROUP BY FirstName, LastName, C.CustomerId
ORDER BY C.CustomerId DESC"
331655,3893287,"select firstname, lastname, count(purchaseid)
from Customers c, Purchases p1
where c.customerid=p1.customerid 
  and c.customerid in 
  (select customerid from (select p2.customerid
  from (select productid, min(price) as min_price from Purchases group by productid) as t 
        join Purchases p2 on t.productid=p2.productid 
        where p2.price=min_price
        group by customerid) as temp)
group by c.customerid
order by c.customerid desc"
6573,3893287,"SELECT FirstName, LastName, (SELECT COUNT(ProductId)
                                      FROM Purchases P
                                      WHERE P.CustomerId = C.CustomerId)
FROM Customers C
WHERE EXISTS (SELECT *
              FROM Purchases P1, Products P2
              WHERE C.CustomerId = P1.CustomerId AND P1.ProductId = P2.ProductId AND P1.Price = 
                                       (SELECT MIN(Price) 
                                       FROM Purchases P3
                                       WHERE P3.ProductId = P1.ProductId)
                                        )
ORDER BY C.CustomerId DESC"
4370,3893287,"SELECT A.FirstName, A.LastName, (SELECT COUNT(E.PurchaseId) FROM Purchases E WHERE E.CustomerId = A.CustomerId)
FROM Customers A
INNER JOIN Purchases B ON B.CustomerId = A.CustomerId
WHERE B.Price = (SELECT MIN(F.Price) FROM Purchases F WHERE F.ProductId = B.ProductId)
ORDER BY A.CustomerId DESC;"
125841,3893287,"select Customers.FirstName, Customers.LastName, count(Purchases.PurchaseId)
from (
  select Customers.CustomerId
  from Customers
  join Purchases on Customers.CustomerId = Purchases.CustomerId
  join (
    select Products.ProductId, min(Purchases.Price) as Price
    from Purchases
    join Products on Products.ProductId = Purchases.ProductId
    group by Products.ProductName, Products.ProductId
  ) as lowest_price
  on lowest_price.ProductId = Purchases.ProductId
  where lowest_price.Price = Purchases.Price
  group by Customers.CustomerId
) as processed
join Purchases on processed.CustomerId = Purchases.CustomerId
join Customers on processed.CustomerId = Customers.CustomerId
group by Customers.FirstName, Customers.LastName, Customers.CustomerId
order by Customers.CustomerId desc"
5126,3893287,"SELECT C.FirstName, C.LastName, (SELECT COUNT(C2.CustomerId) FROM Customers C2, Purchases Pur2
        WHERE C.CustomerId = C2.CustomerId AND C2.CustomerId = Pur2.CustomerId )
FROM Customers C, Purchases Pur
WHERE C.CustomerId = Pur.CustomerId AND Pur.Price = (SELECT MIN(Pur3.Price) FROM Purchases Pur3 
    WHERE Pur3.ProductId = Pur.ProductId)
GROUP BY C.FirstName, C.LastName, C.CustomerId
ORDER BY C.CustomerId DESC"
125328,3893287,"select FirstName,LastName,cnt from 
(select DISTINCT FirstName,LastName,CustomerId,(select count(*) from Purchases p where p.CustomerId = c.CustomerId) as cnt
    from Customers c
    where c.CustomerId 
    in (select b.CustomerId from Purchases b where b.CustomerId in 
            (select a.CustomerId from Purchases a where a.price=
                (select Min(price)  from Purchases k where a.ProductId=k.ProductId)
            ) 
    )
order by c.CustomerId DESC
) d"
32807,3893287,"SELECT c.FirstName, c.LastName, COUNT(*)
FROM Customers c JOIN Purchases p ON (c.CustomerId = p.CustomerId)
WHERE c.CustomerId IN (
    -- Select the customer ID that corresponds to the minimum price for a product
    SELECT CustomerId 
    FROM Purchases pr
    WHERE pr.Price = (
        -- Select the minimum price for a given product ID
        SELECT MIN(Price)
        FROM Purchases
        GROUP BY ProductId
        HAVING ProductId = pr.ProductId
    )
)
GROUP BY c.FirstName, c.LastName, c.CustomerId
ORDER BY c.CustomerId DESC
"
10697,3893287,"SELECT FirstName, LastName, count(*)
FROM (SELECT DISTINCT CustomerId
      FROM (SELECT min(Price) AS LP, ProductId
            FROM Purchases 
            GROUP BY ProductId) AS F inner join Purchases P on F.LP = P.Price and F.ProductId = P.ProductId
      ) AS TEMP inner join Purchases C on C.CustomerId = TEMP.CustomerId INNER JOIN Customers G ON G.CustomerId = C.CustomerId
GROUP BY C.CustomerId
ORDER BY C.CustomerId DESC;
"
5246,3893287,"select FirstName, LastName, totalPurchases from (select FirstName, LastName, CustomerId, count(*) as totalPurchases from Purchases p natural join Customers c group by CustomerId) as sub natural join Purchases p where p.Price = (select min(pp.Price) from Purchases pp where pp.ProductId = p.ProductId) group by FirstName, LastName, totalPurchases order by min(sub.CustomerId) desc"
5722,3893287,"SELECT customers.FirstName, customers.LastName, COUNT(customers.CustomerId)
FROM Customers customers NATURAL JOIN Purchases purchases
GROUP BY customers.CustomerId
HAVING customers.CustomerId = ANY(
                        SELECT CustomerId
                        FROM Purchases purchases2
                        WHERE (purchases2.ProductId, purchases2.Price) = ANY(
                                                SELECT purchases3.ProductId, min(purchases3.Price)
                                                FROM Purchases purchases3
                                                GROUP BY purchases3.ProductId
                                                                            )
                                )
ORDER BY customers.CustomerId DESC"
5092,3893287,"SELECT c.FirstName, c.LastName, (
    SELECT COUNT(c1.CustomerId) FROM Customers c1, Purchases p1 WHERE c.CustomerId = c1.CustomerId AND c1.CustomerId = p1.CustomerId)
    FROM Purchases p, Customers c
    WHERE p.Price = (SELECT MIN(p2.Price) FROM Purchases p2 WHERE p2.ProductId = p.ProductId) AND c.CustomerId = p.CustomerId
    GROUP by c.FirstName, c.LastName, c.CustomerId
    ORDER by c.CustomerId DESC
"
126556,3893287,"SELECT FirstName, LastName, count1
FROM 
    (SELECT DISTINCT c.FirstName, c.LastName, cnt.count1, c.CustomerId
    FROM Customers c, (SELECT CustomerId, COUNT(CustomerId) as count1 FROM Purchases GROUP BY CustomerId) AS cnt,
     (SELECT * FROM Purchases WHERE PRICE IN 
            (SELECT MIN(Price) FROM Purchases GROUP BY ProductId)
     ) AS mins
    WHERE c.CustomerId = mins.CustomerId AND cnt.CustomerId = c.CustomerId) AS total
ORDER BY CustomerId DESC
"
10641,3893287,"select FirstName, LastName, count(*)
from Customers natural join Purchases
where CustomerId in 
(select c.CustomerId
            from Purchases pp natural join Customers c, 
                                        (select p.ProductId,min(p.price) as price
                                        from Purchases p
                                        group by p.ProductId
                                        ) as min_price
            where pp.price = min_price.price and pp.ProductId = min_price.ProductId
) 
group by CustomerId
order by CustomerId desc


-- natural join (
--                                             select CustomerId, count(*) as cnt
--                                             from Purchases
--                                             group by CustomerId
--                                         ) as temp
-- order by CustomerId desc"
8171,3893287,"SELECT C.FirstName, C.LastName, COUNT(P1.purchaseId)
FROM Customers AS C, Purchases AS P1
WHERE C.CustomerId = P1.CustomerId 
    AND C.CustomerId IN (SELECT CustomerId
        From Purchases AS P2
        WHERE P2.Price <= ALL(SELECT MIN(P3.Price)
            FROM Purchases P3
            WHERE P2.ProductId = P3.ProductId))
GROUP BY P1.CustomerId
ORDER BY C.CustomerId DESC;"
313637,3893287,"SELECT FirstName, LastName, COUNT(PurchaseId)
FROM Purchases NATURAL JOIN Customers
GROUP BY CustomerId
HAVING CustomerId IN (SELECT CustomerId
                      FROM Purchases p1
                      WHERE p1.Price <= ALL(SELECT p2.Price
                                         FROM Purchases p2
                                         WHERE p2.ProductId = p1.ProductId))
ORDER BY CustomerId DESC
"
130804,3893287,"Select c.FirstName, c.LastName, temp2.d
From Customers c, Purchases p, 
(select MIN(Price) p, productID pi From Purchases group by productID)
as temp,
(select c2.customerid cid, count(p2.PurchaseId) d from Customers c2, Purchases p2 
where c2.customerid = p2.customerid group by c2.customerid)
as temp2
Where c.customerID = p.customerID and p.price = temp.p and temp.pi = p.productID and temp2.cid = c.customerid
group by c.FirstName, c.LastName, c.CustomerID
order by c.CustomerID desc;"
122226,3893287,"SELECT
  FirstName,
  LastName,
  cnt
FROM
  Purchases p
  LEFT JOIN (
    SELECT
      ProductId,
      MIN(Price) min_price
    FROM
      Purchases
    GROUP BY
      ProductId
  ) t ON p.ProductId = t.ProductId
  INNER JOIN (
    SELECT COUNT(*) cnt, CustomerId
    FROM Purchases
    GROUP BY CustomerId
  ) thing ON p.CustomerId=thing.CustomerId
  AND p.Price = t.min_price
  INNER JOIN Customers c ON p.CustomerId=c.CustomerId
  GROUP BY c.CustomerId
  ORDER BY c.CustomerId DESC;"
127606,3893287,"select distinct * from (select c.FirstName, c.Lastname, (select count(*) from Purchases where CustomerId=c.CustomerId group by CustomerId)
from Customers c, Purchases p
where c.CustomerId=p.customerId and p.Price=(select min(price) from Purchases where ProductId=p.ProductId group by ProductId)
order by c.CustomerId DESC) as sub;"
37267,3893287,"SELECT FirstName, LastName, num
FROM
(SELECT DISTINCT p1.CustomerId, FirstName, LastName, NumPurchases.num
FROM Purchases p1 LEFT JOIN (
    SELECT c1.CustomerId, c1.FirstName, c1.LastName, COUNT(*) AS num 
    FROM Customers c1 LEFT JOIN Purchases p3 ON c1.CustomerId = p3.CustomerId
    GROUP BY c1.CustomerId
) as NumPurchases ON p1.CustomerId = NumPurchases.CustomerId
WHERE p1.price in(
    SELECT MIN(p2.price)
    FROM Purchases p2
    GROUP BY p2.productId
)
ORDER BY p1.CustomerId DESC) as BestCustomers
"
34020,3893287,"SELECT c.FirstName, c.LastName, COUNT(c.FirstName)
FROM Customers c LEFT JOIN Purchases z 
ON c.CustomerId = z.CustomerId
WHERE c.CustomerId IN
    (SELECT p.CustomerId
    FROM Purchases p
      INNER JOIN
      (
        SELECT ProductId, MIN(Price) MinPrice
        FROM Purchases
        GROUP BY ProductId
      ) p2
      ON p.ProductId = p2.ProductId
    WHERE p2.MinPrice = p.Price)
GROUP BY c.CustomerId
ORDER BY c.CustomerId DESC
"
35116,3893287,"SELECT FirstName, LastName, LOL.Z
FROM Customers, (SELECT CustomerId, COUNT(CustomerId) Z
FROM (SELECT *
FROM Purchases
WHERE CustomerId = ANY(SELECT DISTINCT CustomerId ZZ
FROM Purchases P, (SELECT ProductId, MIN(Price) PP
FROM Purchases
GROUP BY ProductId) as T
WHERE P.ProductId = T.productId and P.Price = T.PP)) as ZZZ
GROUP BY(CustomerId)) as LOL
WHERE Customers.CustomerId = LOL.CustomerId
ORDER BY LOL.CustomerId DESC

"
37517,3893287,"SELECT FirstName, LastName, Count(*)
FROM 
        (Customers natural join
            (SELECT DISTINCT CustomerId
            FROM Purchases natural join Products
            WHERE Price <= all (SELECT Price from Purchases natural join Products p where Products.ProductName = p.ProductName)) a) natural join Purchases
GROUP BY CustomerId
ORDER BY CustomerId DESC;

"
33188,3893287,"SELECT x1.FirstName,x1.LastName,COUNT(*)
FROM Customers x1 NATURAL JOIN Purchases x2
WHERE x1.CustomerId IN (
                        SELECT DISTINCT CustomerId
                        FROM Purchases NATURAL JOIN (SELECT ProductId,MIN(Price) AS MinPrice
                                                     FROM Purchases NATURAL JOIN Products
                                                     GROUP BY ProductId) AS table1
                        WHERE Price = table1.MinPrice
)
GROUP BY x1.CustomerId
ORDER BY x1.CustomerId DESC


"
30481,3893287,"SELECT FirstName, LastName, COUNT(*)
FROM Customers
NATURAL JOIN Purchases
WHERE CustomerId IN (SELECT CustomerId
    FROM Customers
    NATURAL JOIN Purchases P1
    WHERE P1.Price = (SELECT MIN(Price)
                      FROM Purchases P2
                      WHERE P1.ProductId = P2.ProductId))
GROUP BY CustomerId
ORDER BY CustomerId DESC"
36594,3893287,"SELECT C.FirstName, C.LastName, B.times
FROM Customers C
JOIN (SELECT CustomerId, COUNT(*) AS times
     FROM Purchases
     GROUP BY CustomerId)
     AS B ON B.CustomerId = C.CustomerId
WHERE C.CustomerId IN
      (SELECT C.CustomerId
      FROM Customers C
      JOIN Purchases P ON P.CustomerId = C.CustomerId
      JOIN (SELECT ProductId, MIN(Price) AS MinP
           FROM Purchases
           GROUP BY ProductId)
           AS P2 ON P.ProductId = P2.ProductId
      WHERE P.Price = P2.MinP)
ORDER BY C.CustomerId DESC"
5753,3893287,"select c.FirstName, c.LastName, (select count(*) from Purchases p3 where c.CustomerId = p3.CustomerId)
from Customers c
where c.CustomerId in (select CustomerId from Purchases op where op.Price = (select min(ip.Price) from Purchases ip where ip.ProductId = op.ProductId))
order by c.CustomerId desc"
7637,3893287,"SELECT FirstName, LastName, totalPurchases
FROM (SELECT cust.FirstName, cust.Lastname, cust.CustomerID, COUNT(pu.PurchaseId) AS totalPurchases 
      FROM Customers cust JOIN Purchases pu ON cust.CustomerId = pu.CustomerId
      WHERE cust.CustomerID IN (SELECT pu1.CustomerId
                                FROM Purchases pu1 
                                WHERE (pu1.ProductId, pu1.Price) IN (SELECT pu2.ProductId, MIN(pu2.Price) AS minPrice
                                                                    FROM Purchases pu2
                                                                    GROUP BY pu2.ProductId))
      GROUP BY cust.CustomerId) AS T
ORDER BY CustomerId DESC"
37112,3893287,"SELECT C.FirstName, C.LastName, count(P.PurchaseId)
FROM Purchases P NATURAL JOIN Customers C
WHERE P.CustomerId IN (SELECT Pu.CustomerId
FROM Purchases Pu
WHERE Pu.Price = (SELECT MIN(pum.Price) FROM Purchases pum WHERE pum.ProductId=Pu.ProductId)
GROUP BY CustomerId)
GROUP BY C.CustomerId
ORDER BY C.CustomerId DESC

-- SELECT Pu.CustomerId
-- FROM Purchases Pu
-- WHERE Pu.Price = (SELECT MIN(pum.Price) FROM Purchases pum WHERE pum.ProductId=Pu.ProductId)
-- GROUP BY CustomerId

-- SELECT MIN(pum.Price) FROM Purchases pum WHERE pum.ProductId=Pu.ProductId"
5791,3893287,"select FirstName, LastName, count(*) 
from Customers natural join Purchases
where CustomerId in (
    select distinct CustomerId
    from Purchases natural join (
        select ProductId, min(Price) as Price
        from Purchases
        group by ProductId
    ) t1
)
group by CustomerId
order by CustomerId desc;"
31826,3893287,"SELECT FirstName,LastName,numPurchases
FROM(
SELECT DISTINCT FirstName,LastName,numPurchases,temp.CustomerId 
FROM (SELECT C.CustomerId, C.FirstName,C.LastName,Count(P.PurchaseId) as numPurchases
FROM Customers C inner join Purchases P on C.CustomerId = P.CustomerId 
GROUP BY C.CustomerId ORDER BY C.CustomerId DESC) temp,Purchases p1
WHERE temp.CustomerId = p1.CustomerId and p1.Price <= ALL(SELECT Price FROM Purchases p2 WHERE p2.ProductId = p1.ProductId)) as temp2
ORDER BY CustomerId DESC"
33758,3893287,"SELECT FirstName, LastName, counts FROM 
(
    SELECT DISTINCT FirstName, LastName, CustomerId,
        (SELECT COUNT(CustomerId) FROM Purchases WHERE CustomerId = p.CustomerId) as counts
    FROM Purchases p NATURAL JOIN Customers
    WHERE Price <= ALL(SELECT Price FROM Purchases WHERE p.ProductId = ProductId)
    ORDER BY CustomerId DESC
) as custPurchases
"
36387,3893287,"SELECT Customers.FirstName, Customers.LastName, COUNT(Purchases.ProductId)
FROM Customers
INNER JOIN Purchases ON Customers.CustomerId = Purchases.CustomerId
WHERE Customers.CustomerId IN 
(SELECT C.CustomerId 
FROM Customers C, Purchases P
WHERE C.CustomerId = P.CustomerId
AND P.Price <= (SELECT MIN(P2.Price) FROM Purchases P2 WHERE P2.ProductId = P.ProductId GROUP BY P2.ProductId))
GROUP BY Customers.CustomerId
ORDER BY Customers.CustomerId DESC;"
336388,3893287,"SELECT FirstName, LastName, res.number
FROM Customers
JOIN
(SELECT  COUNT(CustomerId) as number, CustomerId
FROM Purchases
WHERE CustomerId IN (
SELECT CustomerId
FROM Purchases
JOIN
(SELECT ProductId, MIN(Price) as MinPrice
FROM Purchases
GROUP BY ProductId) AS mt
WHERE Purchases.ProductId = mt.ProductId AND Purchases.Price = mt.MinPrice
GROUP BY CustomerId)
GROUP BY CustomerId) AS res
ON Customers.CustomerId = res.CustomerId
ORDER BY Customers.CustomerId DESC;"
65042,3893287,"Select alias.FirstName, alias.LastName, alias.total
from (Select distinct c.FirstName, c.LastName, (Select count(*) from Purchases where p.CustomerId = CustomerId) as total, c.CustomerId
        from Customers c join Purchases p on c.CustomerId = p.CustomerId
        where p.Price = (Select Min(p2.Price) 
                            from Purchases p2 where p2.ProductId = p.ProductId)
        order by c.CustomerId Desc) as alias "
9781,3893287,"SELECT FirstName, LastName, Counts
FROM (SELECT DISTINCT CustomerId, FirstName, LastName
FROM Customers NATURAL JOIN Purchases AS PurchaseCounts 
WHERE PurchaseId in (SELECT PurchaseId
FROM Purchases pu
WHERE Price = (SELECT MIN(Price) FROM Purchases WHERE ProductId = pu.ProductId))
ORDER BY CustomerId DESC) as bbb NATURAL JOIN (SELECT CustomerId, COUNT(CustomerId) Counts FROM Purchases GROUP BY CustomerId) AS aaa"
33006,3893287,"SELECT Customers.FirstName, Customers.LastName, Count(Purchases.PurchaseId)
FROM Customers, Purchases,
    (SELECT DISTINCT CustomerId
    FROM Purchases,
        (SELECT MIN(Price) as Mprice, ProductId
        FROM Purchases
        GROUP BY ProductId) as MinPriceTable
    WHERE Purchases.ProductId = MinPriceTable.ProductId and Purchases.Price = MinPriceTable.Mprice) as PoorPeople
WHERE Customers.CustomerId = PoorPeople.CustomerId and Purchases.CustomerId = Customers.CustomerId
GROUP BY PoorPeople.CustomerId
ORDER BY PoorPeople.CustomerId DESC 
        "
33358,3893287,"SELECT c.FirstName, c.LastName, COUNT(p.ProductId)
FROM
    (SELECT DISTINCT c.CustomerId
    FROM (SELECT MIN(pu.Price) AS minp, pu.ProductId
          FROM Purchases pu, Products pr, Customers cu
          WHERE pu.ProductId = pr.ProductId and pu.CustomerId = cu.CustomerId
          GROUP BY pu.ProductId) AS a, Purchases p, Customers c
    WHERE c.CustomerId = p.CustomerId and p.ProductId = a.ProductId and p.Price = a.minp)AS b, Purchases p, Customers c
WHERE p.CustomerId = b.CustomerId and c.CustomerId = b.CustomerId
GROUP BY p.CustomerId
ORDER BY p.CustomerId DESC"
331540,3893287,"Select FirstName,LastName,count(ProductId)
from Customers NATURAL JOIN Purchases
where CustomerId IN (
Select P.CustomerId
from Purchases P,Products P1
where P.ProductId=P1.ProductId and price <= ALL (
Select P2.Price
from Purchases P2
where P1.ProductId=P2.ProductId
)
)
group by CustomerId DESC,FirstName,LastName

"
322515,3893287,"SELECT 
    C1.FirstName, C1.LastName, COUNT(P1.PurchaseId)
FROM 
    (Customers C1 JOIN Purchases P1 
                    ON C1.CustomerId = P1.CustomerId) 
WHERE C1.CustomerId IN   (SELECT C2.CustomerId
                            FROM (Customers C2 JOIN Purchases P2 
                                                 ON C2.CustomerId = P2.CustomerId) 
                           WHERE P2.Price <= ANY(SELECT MIN(P3.Price) 
                                                 FROM Purchases P3 
                                                 WHERE P2.ProductId = P3.ProductId))
GROUP BY C1.CustomerId
ORDER BY C1.CustomerId DESC
"
130618,3893287,"SELECT FirstName, LastName, c
FROM Customers NATURAL JOIN (SELECT CustomerId, COUNT(*) as c FROM Purchases NATURAL JOIN (SELECT CustomerId FROM Purchases p NATURAL JOIN (SELECT ProductId p0, MIN(Price) as m from Purchases GROUP BY ProductId) as temp WHERE p.Price=m GROUP BY CustomerId) as temp2 GROUP BY CustomerId) as temp3
ORDER BY CustomerId DESC

"
36209,3893287,"SELECT c.FirstName, c.LastName, 
        (SELECT Count(*) 
        FROM Purchases p
        WHERE c.CustomerId = p.CustomerId)
    FROM Customers c
    WHERE 
        c.CustomerId IN 
            (SELECT p2.CustomerId 
                FROM Purchases p2
                WHERE p2.Price = (SELECT MIN(p3.Price) FROM Purchases p3 WHERE p3.productId = p2.productId))
    ORDER BY c.CustomerId DESC;
"
33198,3893287,"SELECT Customers.FirstName, Customers.LastName, COUNT(*)
FROM Purchases 
INNER JOIN Customers ON Customers.CustomerId=Purchases.CustomerId
WHERE Customers.CustomerId IN (SELECT p.CustomerId 
FROM Purchases p
WHERE p.Price = (SELECT MIN(Purchases.Price) FROM Purchases WHERE Purchases.ProductId=p.ProductId))
GROUP BY Customers.CustomerId DESC, Customers.FirstName, Customers.LastName;"
5233,3893287,"SELECT a.FirstName, a.LastName, a.t
FROM (SELECT DISTINCT c.CustomerId, c.FirstName, c.LastName, Totals.TotalPurchases AS t
FROM Purchases AS o
    INNER JOIN (
        SELECT ProductId, MIN(Price) AS MinPrice FROM Purchases GROUP BY ProductId
    ) AS i ON o.Price=i.MinPrice
    INNER JOIN Customers AS c
        ON c.CustomerId=o.CustomerId
    INNER JOIN (
        SELECT CustomerId, COUNT(*) as TotalPurchases FROM Purchases GROUP BY CustomerId
    ) as Totals ON Totals.CustomerId=c.CustomerId
) AS a
ORDER BY a.CustomerId DESC"
5435,3893287,"SELECT DISTINCT FirstName, LastName, countCustomers
FROM (
    SELECT *
    FROM Customers
    ORDER BY CustomerId DESC
) AS c
JOIN (
    SELECT rp.CustomerId, count(rp.PurchaseId) AS countCustomers
    FROM Purchases rp
    WHERE rp.CustomerId = ANY (
        SELECT pur.CustomerId
        FROM Purchases pur
        JOIN (
            SELECT pp.ProductId AS ProductId, MIN(pp.Price) AS minPrice
            FROM Purchases pp
            GROUP BY ProductId
        ) AS minPro
        ON minPro.ProductId = pur.ProductId
        WHERE pur.Price = minPro.minPrice
    )
    GROUP BY rp.CustomerId
    ORDER BY rp.CustomerId DESC
) AS p
ON c.CustomerId = p.CustomerId"
35847,3893287,"select c.FirstName, c.LastName, count(p.PurchaseId)
from Customers c inner join Purchases p on c.CustomerId = p.CustomerId
where c.CustomerId in (select g.CustomerId from Purchases g where g.Price in (Select min(Price) from Purchases where Purchases.ProductId = g.ProductId))
group by c.CustomerId
order by c.CustomerId desc"
9769,3893287,"select Customers.FirstName, Customers.LastName, Fre.Frequency
from Customers, (select CustomerId, Count(*) as Frequency
      from Customers natural join Purchases
       group by CustomerId) as Fre
where Customers.CustomerId in (select Purchases.CustomerId
                               from (select ProductId, min(Price) as lowest
                                     from Customers natural join Purchases
                                      group by ProductId) as price_table, Purchases
                                      where Purchases.ProductId = price_table.ProductId and Purchases.Price = price_table.lowest)
                                      and Customers.CustomerId = Fre.CustomerId
order by Customers.CustomerId DESC



"
124294,3893287,"SELECT c.FirstName, c.LastName, COUNT(c.CustomerId) 
FROM Customers c NATURAL JOIN Purchases p
WHERE c.CustomerId IN (
    SELECT DISTINCT c.CustomerId
    FROM Customers c NATURAL JOIN Purchases p
    WHERE p.Price <= ALL(
        SELECT Price
        FROM Purchases pur
        WHERE pur.ProductId = p.ProductId
    ))
GROUP BY c.CustomerId
ORDER BY c.CustomerId DESC;"
7426,3893287,"select FirstName, LastName, counts
from
(Select FirstName, LastName,CustomerId, counts
from Customers natural join (Select count(ProductId) as counts, CustomerId from Purchases p3 where p3
.CustomerId in (Select CustomerId from Purchases p1 where p1.price<=(Select min(Price) from
Purchases p2 where p2.ProductId = p1.ProductId))group by CustomerId) a
Order by CustomerId DESC ) b"
5768,3893287,"SELECT Distinct *
FROM (Select c.FirstName, c.LastName, (SELECT COUNT(*) FROM Purchases p0 WHERE p0.CustomerId = c.CustomerId)
From Customers c Natural Join (Select p1.CustomerId, p1.ProductId
                                From Purchases p1 Join (Select Distinct ProductId, MIN(price) minPrice
                                                        From Purchases
                                                        Group By ProductId) p2
                                                    On p1.ProductId = p2.ProductId
                                Where p1.price = p2.minPrice) p3 
Order By c.CustomerId DESC) pDone"
322502,3893287,"SELECT c.FirstName, c.LastName, COUNT(p.ProductId)
FROM Customers c LEFT JOIN Purchases p ON (c.CustomerId = p.CustomerId)
WHERE c.CustomerId IN (SELECT cid FROM(
                        SELECT p1.CustomerId AS cid
                        FROM Purchases p1
                        WHERE p1.Price IN (SELECT minPrice FROM(
                            SELECT ProductId, MIN(Price) as minPrice
                            FROM Purchases
                            GROUP BY ProductId) AS tmp2)
                        ) AS tmp1)
GROUP BY c.CustomerId DESC;
"
36183,3893287,"SELECT c.FirstName, c.LastName,  (SELECT COUNT(*)
                                            FROM Purchases p1
                                            WHERE c.CustomerId = p1.CustomerId)
FROM Purchases p JOIN Customers c ON (c.CustomerId = p.CustomerId)
WHERE p.Price = (SELECT MIN(Price)
                FROM Purchases p2
                WHERE p2.ProductId = p.ProductId)
GROUP BY c.CustomerId
ORDER BY c.CustomerId DESC

"
5259,4014115,"SELECT hometown as visited
FROM Employee
WHERE empName = 'Ben'
UNION ALL
SELECT DISTINCT deptLocation as visited
FROM Department NATURAL JOIN Employee
WHERE empName = 'Ben'"
5265,4014115,"SELECT hometown
FROM Employee e
WHERE e.empName = 'Ben'
UNION (
    SELECT deptLocation AS hometown
    FROM Employee e
    NATURAL JOIN Department
    WHERE e.empName = 'Ben'
)
"
331540,4014115,"Select hometown
from Employee
where empName LIKE 'Ben'
UNION
Select deptLocation
from Department,Employee
where Department.deptID = Employee.deptID and empName LIKE 'Ben'

"
322502,4014115,"SELECT hometown 
FROM Employee 
WHERE empName = 'Ben'
UNION
SELECT d.deptLocation AS hometown
FROM Employee e, Department d
WHERE e.deptID = d.deptID
    AND e.empName = 'Ben';"
313665,4014112,"select d.deptName, d.deptLocation, count(e.empID)
from Employee e natural join Department d
group by d.deptID
having count(e.empID) >= all(select count(e1.empID)
    from Employee e1 natural join Department d1
    group by d1.deptID)"
37657,4014112,"SELECT deptName, deptLocation, COUNT(*) 
FROM Employee e NATURAL JOIN Department d
GROUP BY d.deptID
HAVING COUNT(*) = ( SELECT MAX(empCnt) FROM (SELECT COUNT(*) as empCnt
FROM Employee 
GROUP BY deptID) as temp)"
34820,4014112,"SELECT d.deptName, d.deptlocation, COUNT(*) as numofEmp
FROM Employee e JOIN Department d ON(e.deptID = d.deptID)
GROUP BY d.deptID
HAVING COUNT(*) = 

(SELECT MAX(empCnt) FROM (SELECT COUNT(*) as empCnt
FROM Employee
GROUP BY deptID) as temp )
-- (SELECT MAX(cnt) FROM )"
36038,4014112,"Select d.deptName, d.deptLocation, Count(*)
from Employee e natural join Department d
Group by d.deptID
Having count(*) = (Select max(empCnt)
from (Select count(*) as empcnt
from Employee
Group By deptID) as temp)"
325288,4014112,"SELECT d.deptName, d.deptLocation, COUNT(*) as numOfEmp
FROM Employee e NATURAL JOIN Department d 
GROUP BY d.deptID
HAVING numOfEmp = 
    (SELECT MAX(empCounter)
    FROM (  SELECT COUNT(*) as empCounter
            FROM Employee
            GROUP BY deptID) as temp
    );



"
34406,4014112,"SELECT d.deptName, d.deptLocation, COUNT(*)
FROM Department d NATURAL JOIN Employee e
GROUP BY d.deptID
HAVING COUNT(*) =
(
SELECT MAX(ct)
FROM (SELECT COUNT(*) as ct
FROM Employee
GROUP BY deptID) AS temp
)"
129745,4014112,"SELECT d.deptName, d.deptLocation, COUNT(*) 
FROM Employee e NATURAL JOIN Department d
GROUP BY d.deptID
HAVING COUNT(*) = (SELECT MAX(empCnt) FROM (
    SELECT COUNT(*) as empCnt 
    FROM Employee GROUP BY deptID
) AS temp);"
34602,4014112,"SELECT d.deptName, d.deptLocation, COUNT(*)
FROM Employee e NATURAL JOIN Department d
GROUP BY d.deptId
HAVING COUNT(*) = (
    SELECT MAX(empCount)
    FROM (
    SELECT COUNT(*) AS empCount
    FROM Employee
    GROUP BY deptID
    ) AS temp
)"
124539,4014112,"Select * 
FROM (SELECT Department.deptName, Department.deptLocation, Count(*) AS deptFreq
FROM Employee NATURAL JOIN Department
GROUP BY Department.deptName, Department.deptLocation) as temp
WHERE deptFreq > 1
ORDER BY deptName DESC
"
308057,4014112,"SELECT deptName, deptLocation, COUNT(*) 
FROM Department NATURAL JOIN Employee
GROUP BY deptID
HAVING COUNT(*) = (
        SELECT COUNT(*) 
        FROM Employee
        GROUP BY deptID
        ORDER BY COUNT(*) DESC
        LIMIT 1
    )"
186896,4014112,"SELECT d.deptName, d.deptLocation, COUNT(*)
FROM Employee e LEFT OUTER JOIN Department d ON e.deptID = d.deptID
GROUP BY d.deptName, d.deptLocation
HAVING COUNT(*) >=  ALL(SELECT COUNT(*)
                        FROM Employee e2
                        GROUP BY e2.deptID)
ORDER BY d.deptName DESC;"
5259,4014112,"SELECT deptName, deptLocation, total_employee
FROM Department NATURAL JOIN (SELECT deptID, count(empID) as total_employee FROM Department NATURAL JOIN Employee GROUP BY deptID) AS E1
WHERE total_employee = (SELECT MAX(total_employee) FROM (SELECT count(empID) as total_employee FROM Department NATURAL JOIN Employee GROUP BY deptID) AS E2);"
324318,4014112,"SELECT d.deptName, deptLocation, COUNT(*) as numofEmp
FROM Employee e JOIN Department d ON (e.deptID = d.deptID)
GROUP BY d.deptID
HAVING COUNT(*) = (SELECT MAX(empCnt)
FROM (
SELECT COUNT(*) as empCnt
FROM Employee 
GROUP BY deptID ) as  temp)"
6575,4014112,"SELECT d.deptName, d.deptLocation, COUNT(*)
FROM Employee e NATURAL JOIN Department d
GROUP BY d.deptID
HAVING COUNT(*)= (SELECT MAX(empCNT) 
                FROM (SELECT COUNT(*) as empCNT 
                    FROM Employee 
                    GROUP BY deptID) temp)"
5256,4014112,"SELECT d.deptName, d.deptLocation, COUNT(*)
FROM Employee e NATURAL JOIN Department d
GROUP BY d.deptID
HAVING COUNT(*) = (SELECT MAX(empCNT)
                   FROM (SELECT COUNT(*) AS empCNT
                         FROM Employee
                         GROUP BY deptID) temp)"
36050,4014112,"SELECT d.deptName, d.deptLocation, count(*)
FROM Department d, Employee e 
WHERE (d.deptId = e.deptId)
GROUP BY d.deptID
HAVING COUNT(*) = (SELECT MAX(empCNT)
FROM (SELECT COUNT(*) as empCNT FROM Employee
GROUP BY deptID) temp)"
316610,4014112,"select deptName, deptLocation, count(*)
from Employee e natural join Department d
group by d.deptID having count(*) =
(select max(empCount)
from (select count(*) as empCount from Employee group by deptID) as tmp)"
126556,4014112,"SELECT d.deptName, d.deptLocation, count(*)
FROM Department d NATURAL JOIN Employee e
GROUP BY d.deptId
HAVING count(*) = (SELECT MAX(empCnt) 
                    FROM (SELECT count(*) as empCnt FROM Employee e GROUP BY e.deptId) temp)"
10641,4014112,"select d.deptName, deptLocation, count(*) as cnt
from Employee e join Department d on (e.deptID = d.deptID)
group by e.deptID
having cnt = (select max(empCnt)
from (select count(*) as empCnt
from Employee
group by deptID) as bahaha)
"
32153,4014112,"SELECT d.deptName, d.deptLocation, COUNT(*)
FROM Employee e NATURAL JOIN Department d #know that after the natural join, each department id 
GROUP BY d.deptID                           # mathes the number of employees
HAVING COUNT(*) = (SELECT MAX(empCnt)
                    FROM (SELECT COUNT(*) as empCnt
                        FROM Employee
                        GROUP BY deptID) as temp)
    "
313637,4014112,"SELECT d.deptName, d.deptLocation, COUNT(e.empID)
FROM Employee e NATURAL JOIN Department d
GROUP BY d.deptID
HAVING COUNT(e.empID) >= ALL (SELECT new.c FROM (SELECT d2.deptID, COUNT(e2.empID) AS c
                                        FROM Employee e2 NATURAL JOIN Department d2
                                        GROUP BY d2.deptID) AS new)"
37112,4014112,"SELECT d.deptName, d.deptlocation, COUNT(*) as numofEmp
FROM Employee e JOIN Department d ON (e.deptID = d.deptID)
GROUP BY d.deptID
HAVING COUNT(*) = (SELECT MAX(empCnt)
                   FROM (SELECT COUNT(*) as empCnt
                         FROM Employee
                         GROUP BY deptID) as temp)
"
331540,4014112,"Select D.deptName,D.deptLocation,count(*) as employee_count
from Department D,Employee E
where D.deptID = E.deptID 
group by D.deptID
having count(*) >= ALL (
Select count(*) as employee_count
from Department,Employee 
where Department.deptID = Employee.deptID
group by Department.deptID
order by employee_count DESC
) 





"
322502,4014112,"SELECT d.deptName, d.deptLocation, COUNT(*) AS numOfEmp
FROM Employee e JOIN Department d ON (e.deptID = d.deptID)
GROUP BY d.deptID
HAVING COUNT(*) = (SELECT MAX(empCnt)
                   FROM (SELECT COUNT(*) AS empCnt
                         FROM Employee
                         GROUP BY deptID) AS temp);"
36183,4014112,"SELECT d.deptName, d.deptLocation, COUNT(*) as numofEmp
FROM Employee e JOIN Department d ON (e.deptID = d.deptID) -- table where we have every employee plus their department info
GROUP BY d.deptID
HAVING COUNT(*) = 
(SELECT MAX(empCount)
FROM 
(SELECT COUNT(*) as empCount
FROM Employee e 
GROUP BY deptID) as temp)

-- aggregate function i.e. COUNT(*) but combined with d.attribute, we ask for something else, then you have to group by
-- cannot have anything in the select clause that is in the group by clause

-- cannot use aggregate function in the where clause

-- MAX EMPLOYEES (2)
-- SELECT MAX(empCount)
-- FROM 
-- (SELECT COUNT(*) as empCount
-- FROM Employee e 
-- GROUP BY deptID as temp))

-- -- find number of employees (1)
-- SELECT COUNT(*) as empCount
-- FROM Employee e 
-- GROUP BY deptID as temp -- this will help you see per dept the number of employees "
313665,3893281,"SELECT DISTINCT FirstName, LastName, NetId
FROM Students NATURAL JOIN Enrollments
WHERE Department='ECE' AND
(Firstname LIKE 'T%' OR
    CRN IN(
        SELECT CRN FROM Courses
        WHERE Department='CS'
    )
    
)
ORDER BY NetId DESC;"
335477,3893281,"select distinct s.FirstName, s.LastName, s.NetId
from Students s
where s.Department = 'ECE' and 
    (s.FirstName like 'T%' or 
     s.NetId in (select ss.NetId 
                 from Students ss, Enrollments ee, Courses cc 
                 where ss.NetId = ee.NetId and ee.CRN = cc.CRN and cc.Department='CS')
    )
order by s.NetId DESC;"
10968,3893281,"SELECT FirstName, LastName, NetId
From Students
WHERE Department = 'ECE' AND (FirstName LIKE 'T%' OR 'CS' = ANY (SELECT DEPARTMENT
FROM Courses
INNER JOIN Enrollments ON Enrollments.CRN = Courses.CRN
WHERE Students.NetId = Enrollments.NetId))
ORDER BY NetId DESC
"
11323,3893281,"SELECT DISTINCT FirstName, LastName, NetId
FROM Students Natural join Enrollments 
WHERE Department = ""ECE"" and (SUBSTRING(FirstName, 1, 1) = ""T"" or CRN in 
(
Select CRN
FROM Courses
WHERE Department = ""CS""
)
)
Order by Netid desc"
30662,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM 
Students s JOIN Enrollments e ON s.NetId = e.NetId JOIN Courses c ON e.CRN = c.CRN WHERE ((s.FirstName LIKE 'T%') OR (c.Department = 'CS')) AND s.Department = 'ECE'
ORDER BY s.NetId DESC
/*FROM Employee emp JOIN Department dept
ON emp.DepartmentID = dept.DepartmentID*/"
37657,3893281,"SELECT DISTINCT FirstName, LastName, e.NetId
FROM Students s NATURAL JOIN Enrollments e JOIN Courses c on e.CRN = c.CRN
WHERE s.Department = ""ECE"" AND (c.Department = ""CS"" OR s.FirstName LIKE ""T%"")
ORDER BY NetId DESC"
5759,3893281,"SELECT S.FirstName, S.LastName, S.NetId
FROM Students S
WHERE S.Department = 'ECE' And (S.FirstName LIKE 'T%' OR Exists (Select *
    From Enrollments E Natural Join Courses C
    Where E.NetId = S.NetId And C.Department = 'CS'))
Order By S.NetId Desc"
85741,3893281,"SELECT FirstName, LastName, NetId
FROM Students
WHERE (Department=""ECE"" AND (FirstName LIKE ""T%"" OR
    (SELECT COUNT(CRN) FROM Courses WHERE Department=""CS"" AND CRN IN (Select CRN FROM Enrollments WHERE Enrollments.NetId=Students.NetId))>0 ) )
ORDER BY NetId DESC"
125568,3893281,"SELECT DISTINCT FirstName, LastName, s.NetId
FROM Students s
INNER JOIN Enrollments e ON s.NetId = e.NetId
INNER JOIN Courses c ON e.CRN = c.CRN
WHERE s.Department = ""ECE"" AND (c.Department = ""CS"" OR FirstName = ""T%"")
ORDER BY s.NetId DESC"
34820,3893281,"SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetId
FROM Students
WHERE  Students.Department = ""ECE"" AND ((Students.FirstName LIKE ""T%"") OR EXISTS(SELECT Enrollments.NetId FROM Enrollments WHERE Enrollments.NetId =  Students.NetId  AND EXISTS ( SELECT Courses.CRN FROM Courses WHERE Courses.CRN = Enrollments.CRN AND Courses.Department = ""CS"" )));"
36038,3893281,"select distinct FirstName, LastName, NetId from Students s
natural join Enrollments e inner join Courses c
on e.CRN = c.CRN
where (FirstName like 'T%'and s.department = ""ECE"") 
or (s.department = ""ECE"" and  c.department = ""CS"")
order by NetId desc"
10955,3893281,"Select Distinct Stu.FirstName, Stu.LastName, Stu.NetId
From Students Stu
Join Enrollments En on Stu.NetId = En.NetId
Join Courses Cn on En.CRN = Cn.CRN
Where Stu.Department = 'ECE' And (Stu.FirstName like 'T%' Or Cn.Department = 'CS')
Order by Stu.NetId Desc;
"
35862,3893281,"SELECT s.FirstName, s.LastName, s.NetId
FROM Students s INNER JOIN Enrollments e on s.NetId = e.NetId
WHERE s.FirstName LIKE 'T%' and s.Department='ECE' or (s.Department = 'ECE'
and (SELECT Department from Courses c WHERE CRN = e.CRN) = 'CS')
GROUP BY s.NetId
ORDER BY NetId DESC"
4915,3893281,"SELECT DISTINCT FirstName, LastName, NetId 
FROM Students NATURAL JOIN Enrollments
WHERE Department = 'ECE' AND (FirstName LIKE 'T%' OR NetId IN (
SELECT NetId 
FROM Enrollments NATURAL JOIN Courses
WHERE Department = 'CS'))
ORDER BY NetId DESC;"
33977,3893281,"select distinct s.FirstName, s.LastName, e.NetId
from Students s join Enrollments e on (s.NetId = e.NetId), Courses c
where (s.FirstName like 'T%' and s.Department = ""ECE"") or (s.Department = ""ECE"" and c.Department = ""CS"" and e.CRN = c.CRN)
order by e.NetId desc;"
11485,3893281,"Select * 
from
   (select FirstName, LastName, NetId
    from Students b
    where b.FirstName LIKE ""T%"" and b.Department = ""ECE""
        union
    (select FirstName, LastName, s.NetId
    from (Students s JOIN Enrollments e ON s.NetId = e.NetId )
    where s.Department=""ECE"" and e.CRN in (Select CRN from Courses h where h.Department=""CS""))) as x
order by x.NetId DESC


"
325288,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s
WHERE s.Department = 'ECE' AND (s.FirstName LIKE 'T%' OR EXISTS
    (SELECT e.CRN
    FROM Enrollments e NATURAL JOIN Courses c
    WHERE s.NetId = e.NetId AND c.Department = 'CS'))
ORDER BY s.NetId DESC;"
37668,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Students S
WHERE S.Department = 'ECE' AND (
      S.FirstName LIKE 'T%' OR 
      EXISTS (SELECT *
              FROM Enrollments, Courses
              WHERE Enrollments.NetId = S.NetId AND
                    Courses.CRN = Enrollments.CRN AND
                    Courses.Department = 'CS'
             )
    )
ORDER BY S.NetId DESC
    "
9606,3893281,"Select FirstName, LastName, NetId
From Students
Where Department = 'ECE' and (FirstName like 'T%' or NetId in (select NetId
from Enrollments e natural join Courses c
where department = 'CS'))
Order by NetId desc"
34406,3893281,"SELECT FirstName, LastName, NetId
FROM Students
WHERE (Department = ""ECE"" AND FirstName LIKE ""T%"")
OR (Department = ""ECE"" AND
NetId IN
(SELECT DISTINCT(e.NetId) AS NetId
FROM Enrollments e JOIN Courses c
WHERE e.CRN = c.CRN
AND c.Department = ""CS""))
ORDER BY NetId
"
36577,3893281,"SELECT DISTINCT FirstName, LastName,  NetId FROM
(SELECT FirstName, LastName, NetId, CRN
FROM (SELECT * FROM Students s
WHERE s.Department = 'ECE') AS temp1
NATURAL JOIN Enrollments e) AS temp2
JOIN Courses c ON temp2.CRN = c.CRN
WHERE FirstName LIKE 'T%' or c.Department = 'CS'
ORDER BY NetId DESC"
342776,3893281,"SELECT es.FirstName, es.LastName, es.NetId
FROM
    (SELECT FirstName, LastName, NetId
    FROM Students
    WHERE Department = ""ECE"") es
WHERE (es.FirstName LIKE 'T%') OR (es.NetId IN (SELECT DISTINCT NetId
FROM Enrollments e JOIN Courses c ON e.CRN = c.CRN
WHERE Department = ""CS""))
ORDER BY es.NetId DESC"
129745,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s
WHERE (
        s.Department='ECE' 
        AND s.NetId IN (
            SELECT e2.NetId 
            FROM Enrollments e2
            NATURAL JOIN Courses c2
            WHERE c2.Department='CS'
        )
    ) 
    OR s.FirstName LIKE 'T%';"
331824,3893281,"SELECT FirstName, LastName, NetId
FROM  (SELECT * FROM Students WHERE Department = 'ECE') AS A
WHERE FirstName LIKE 'T%' OR NetId IN (
    SELECT DISTINCT NetId FROM Enrollments WHERE CRN IN(
    SELECT CRN FROM Courses WHERE Department = 'CS'))
ORDER BY NetId DESC"
31817,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Students S, Enrollments E, Courses C
WHERE S.Department = 'ECE' AND (S.FirstName LIKE 'T%' OR (S.NetId = E.NetId AND E.CRN = C.CRN AND C.Department = 'CS'))
ORDER BY NetId DESC;"
33147,3893281,"SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetId
FROM Students, Enrollments,Courses
WHERE (Students.FirstName like ""T%"" and Students.Department = ""ECE"") or (Students.Department = ""ECE"" and Enrollments.NetId = Students.NetId and Enrollments.CRN = Courses.CRN and Courses.Department = ""CS"")
ORDER BY Students.NetId DESC"
8045,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
From Students S, Enrollments E, Courses C,(SELECT DISTINCT E.NetId, C.Department
From Enrollments E, Courses C
WHERE E.CRN = C.CRN AND C.Department = ""CS"") AS Student_taking_CS_Class
WHERE (S.Department = 'ECE' AND S.FirstName LIKE ""T%"") OR (S.Department = 'ECE' AND S.NetId = Student_taking_CS_Class.NetId)
ORDER BY S.NetId

"
9367,3893281,"SELECT
    DISTINCT Students.FirstName, Students.LastName, Students.NetId

FROM 
    Students, Enrollments, Courses

WHERE
    Students.Department = 'ECE' and Students.FirstName like 'T%' or Students.Department = 'ECE' and Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN and Courses.Department = 'CS'
    
Order BY
    Students.NetId DESC;"
317203,3893281,"Select Distinct FirstName, LastName, NetId
From Students Natural Join Enrollments
where Department = 'ECE' And (FirstName Like 'T%' or CRN = any (Select CRN 
From Courses where Department = 'CS') )
Order by NetId DESC
"
32932,3893281,"Select S.FirstName, S.LastName, S.NetId
From Students S, Enrollments E, Courses C
where S.FirstName like 'T%' and S.Department = 'ECE' or S.Department = 'ECE' and S.NetId = E.NetId and E.CRN = C.CRN and C.Department ='CS'
group by S.NetId
order by S.NetId desc "
331548,3893281,"SELECT DISTINCT FirstName, LastName, s.NetId

FROM Students s left join Enrollments e on s.NetId = e.NetId
left join Courses c on e.CRN = c.CRN

WHERE s.Department = ""ECE"" and (c.Department = ""CS"" or s.FirstName LIKE ""T%"")


ORDER BY s.NetID DESC
"
11481,3893281,"select distinct S.FirstName, S.LastName, S.Netid
from Students S
join Enrollments E on S.NetId=E.NetId
join Courses C on E.CRN=C.CRN
where S.Department='ECE' AND (S.FirstName like 'T%' or C.Department='CS')
order by S.NetId desc;"
33032,3893281,"Select DISTINCT s.FirstName, s.LastName, s.NetID
From Students s
Where s.Department = 'ECE' and 
( (s.FirstName = 'T%') OR (EXISTS 
  (Select*
From Enrollments e, Courses c
Where s.netID = e.NetID and e.CRN = c.CRN and c.Department = 'CS'
  ) )
)
Order by NETID desc"
131447,3893281,"SELECT DISTINCT ECEMajors.FirstName, ECEMajors.LastName, ECEMajors.NetId
FROM (
    SELECT FirstName, LastName, NetId
    FROM Students
    WHERE Students.Department LIKE ""ECE"") AS ECEMajors
JOIN Enrollments ON Enrollments.NetId = ECEMajors.NetId
JOIN Courses ON Enrollments.CRN = Courses.CRN
WHERE Courses.Department LIKE ""CS"" OR ECEMajors.FirstName LIKE ""T%""
ORDER BY ECEMajors.NetId DESC"
34549,3893281,"SELECT DISTINCT  s.FirstName, s.LastName, s.NetId
FROM    (
        SELECT DISTINCT e.NetId
        FROM    Courses c LEFT JOIN Enrollments e ON c.CRN = e.CRN
        WHERE  Department LIKE 'CS'
        ) AS joined, Students s
WHERE   joined.NetId = s.NetId AND s.Department LIKE 'ECE'
ORDER BY s.NetId DESC"
32845,3893281,"SELECT DISTINCT FirstName, LastName, Students.NetId
FROM Students, (SELECT Enrollments.NetId FROM Enrollments, Courses WHERE Enrollments.CRN = Courses.CRN AND Courses.Department = 'CS') AS CSTakingStudents
WHERE Department = 'ECE' AND (FirstName LIKE 'T%' OR CSTakingStudents.NetId = Students.NetId)
Order BY NetId DESC;"
128458,3893281,"SELECT FirstName, LastName, Students.NetId as netid FROM Students INNER JOIN Enrollments on Students.NetId = Enrollments.NetId INNER JOIN Courses on Courses.CRN = Enrollments.CRN WHERE (Students.Department = ""ECE"" AND Students.FirstName like ""T%"") OR (Students.Department = ""ECE"" AND Courses.Department = ""CS"")
GROUP BY netid
ORDER BY netid DESC
"
37281,3893281,"SELECT DISTINCT FirstName, LastName, s.netId
From Enrollments e INNER JOIN Students s on e.NetId = s.NetId INNER JOIN Courses c ON e.CRN = c.CRN
WHERE s.department = ""ECE"" AND (s.FirstName LIKE ""T%"" OR c.Department = 'CS')
ORDER BY s.netID DESC"
34603,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s JOIN Enrollments e ON s.NetId = e.NetId
WHERE (s.FirstName LIKE ""T%"" AND s.Department = ""ECE"")
OR (s.Department = ""ECE"" AND e.CRN IN (SELECT CRN FROM Courses WHERE Department = ""CS""))
ORDER BY s.NetId DESC"
34415,3893281,"select distinct s.FirstName, s.LastName, s.NetId
from Students s, Enrollments e, Courses c
where
    s.NetId = e.NetId
    and ((s.Department = ""ECE""
    and e.CRN = c.CRN
    and c.Department = ""CS"")
    or (s.FirstName like ""T%"" and s.Department = ""ECE""))
order by s.NetId desc
"
5749,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s 
JOIN Enrollments e ON s.NetId = e.NetId
JOIN Courses c on e.CRN = c.CRN
WHERE (s.Department = ""ECE"" AND FirstName LIKE ""T%"") OR
(s.Department = ""ECE"" AND c.Department=""CS"")
ORDER BY s.NetId DESC;


"
127187,3893281,"SELECT DISTINCT FirstName, LastName, s.NetId
FROM Enrollments e JOIN Students s ON s.NetId = e.NetId JOIN Courses c ON c.CRN = e.CRN
WHERE (FirstName LIKE 'T%' OR s.NetId = ANY(SELECT s.NetId FROM Enrollments e JOIN Students s ON s.NetId = e.NetId JOIN Courses c ON c.CRN = e.CRN WHERE c.Department = 'CS')) AND s.Department = 'ECE'
ORDER BY s.NetId DESC;"
34602,3893281,"SELECT DISTINCT FirstName, LastName, s.NetId
FROM Students s
NATURAL JOIN Enrollments e
WHERE Department = 'ECE' AND (FirstName LIKE 'T%' OR CRN IN (
    SELECT CRN 
    FROM Courses
    WHERE Department = 'CS'))
ORDER BY NetId DESC"
38010,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s
WHERE s.Department = ""ECE"" AND (s.FirstName LIKE 'T%' OR EXISTS
                                (SELECT c.Department FROM Courses c, Enrollments e
                                WHERE c.CRN = e.CRN AND e.NetId = s.NetId AND c.Department = ""CS""))
                                
ORDER BY NetId DESC"
33743,3893281,"SELECT DISTINCT S.FirstName, S.LastName, E.NetId 
FROM Enrollments E LEFT JOIN Students S
ON E.NetId = S.NetId LEFT JOIN Courses C ON C.CRN=E.CRN
WHERE  S.Department = 'ECE' AND (C.Department = 'CS' OR S.FirstName LIKE 'T%')
ORDER BY E.NetId DESC;"
308057,3893281,"SELECT DISTINCT FirstName, LastName, s.NetId
FROM Students s, Enrollments e, Courses c
WHERE s.NetId = e.NetId AND e.CRN = c.CRN 
AND s.Department = ""ECE"" AND (FirstName LIKE ""T%"" OR c.Department = ""CS"")
ORDER BY FirstName DESC 
"
126177,3893281,"SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetId
From Students, (Enrollments Natural Join Courses)
WHERE Students.Department = ""ECE"" AND (Students.FirstName Like ""T%"" OR (Enrollments.NetId = Students.NetId
                                                                    AND Courses.Department = ""CS""))
ORDER BY Students.NetId DESC"
318960,3893281,"SELECT DISTINCT FirstName,LastName,NetId
FROM Students S
WHERE S.Department='ECE' AND (
    S.FirstName LIKE 'T%'
    OR 
    EXISTS( SELECT *
            FROM Enrollments NATURAL JOIN Courses
            WHERE S.NetId=NetId AND Department='CS'
            )
                            )
ORDER BY NetId DESC;"
30205,3893281,"SELECT DISTINCT x.FirstName, x.LastName, x.NetId
FROM (
SELECT Students.FirstName, Students.LastName, Students.NetId, Students.Department, Courses.Department as ID
FROM Students
INNER JOIN Enrollments ON Students.NetId=Enrollments.NetId 
INNER JOIN Courses ON Enrollments.CRN = Courses.CRN
HAVING Students.Department=""ECE"" AND ( ID=""CS"" OR Students.FirstName LIKE ""T%"")
) as x
ORDER BY x.NetId DESC"
12098,3893281,"SELECT DISTINCT temp.FirstName, temp.LastName, temp.NetId
FROM
    (SELECT s.FirstName, s.LastName, s.NetId, s.Department, e.CRN
        FROM Students s JOIN Enrollments e ON s.NetId = e.NetId) as temp
    JOIN Courses c ON temp.CRN = c.CRN
WHERE temp.Department = ""ECE"" AND (c.Department = ""CS"" OR temp.FirstName LIKE ""T%"")
ORDER BY 
    temp.NetId DESC;"
186896,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
-- FROM Students s, Enrollments e LEFT OUTER JOIN Courses c ON e.CRN = c.CRN
FROM Students s, Enrollments e NATURAL JOIN Courses c
WHERE ((s.NetId = e.NetId) AND (s.Department = 'ECE') AND ((s.FirstName LIKE 'T%') 
                                                            OR (c.Department = 'CS')))
ORDER BY s.NetId DESC;"
83742,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s

WHERE s.Department = 'ECE' AND 

(s.NetId IN (SELECT NetId 
    FROM Enrollments e JOIN Courses c ON e.CRN = c.CRN 
        WHERE c.Department LIKE 'CS')
            
OR s.FirstName LIKE 'T%')
            
ORDER BY s.NetId DESC;"
38711,3893281,"SELECT DISTINCT FirstName, LastName, S.NetId
FROM Students S LEFT OUTER JOIN Enrollments E
    ON S.NetId = E.NetId
    LEFT OUTER JOIN Courses C
    ON E.CRN = C.CRN
    
WHERE (S.Department = 'ECE' 
       AND (S.FirstName LIKE 'T%' OR C.Department = 'CS'))
ORDER BY S.NetId DESC

"
33334,3893281,"SELECT distinct FirstName,LastName,Students.NetId
FROM Students LEFT OUTER JOIN Enrollments
    on Students.NetId = Enrollments.NetId
WHERE Department = 'ECE' AND ((FirstName LIKE 'T%') or Students.NetId IN

(SELECT distinct Enrollments.NetId
FROM Enrollments left outer join Courses 
    ON Enrollments.CRN = Courses.CRN
WHERE Department = 'CS'))
ORDER BY NetId DESC;"
336531,3893281,"select distinct Students.FirstName, Students.LastNAME, Enrollments.NetId
from Students  join Enrollments  join Courses
on Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN
where  (Students.Department=""ECE"") and (Students.FirstName LIKE ""T%"" or Courses.Department=""CS"" )
order by Enrollments.NetId DESC"
331920,3893281,"SELECT DISTINCT FirstName, LastName, NetId
FROM (SELECT * FROM Students st NATURAL JOIN Enrollments en WHERE st.Department = ""ECE"") AS temp
WHERE temp.FirstName LIKE ""T%"" OR ""CS"" = ANY(SELECT Department FROM Courses cr WHERE cr.CRN = temp.CRN)
ORDER BY NetId DESC;"
6193,3893281,"Select DISTINCT s.FirstName, s.LastName, s.NetId from Students s where s.Department = ""ECE""  and (s.Firstname like ""T%"" or  s.NetId in (select NetId from Enrollments e join Courses c on e.CRN = c.CRN where c.Department = ""CS"")) order by s.NetId desc"
35368,3893281,"SELECT FirstName, LastName, Students.NetId
FROM Students, Enrollments, (SELECT Students.NetId as id FROM Students, Courses, Enrollments WHERE Students.NetId = Enrollments.NetId AND Courses.CRN = Enrollments.CRN AND Courses.Department = 'CS') as temp
WHERE Students.NetId = Enrollments.NetId AND Students.Department = 'ECE' AND (FirstName LIKE 'T%' OR Students.NetId = temp.id)
GROUP BY FirstName, LastName, Students.NetId
ORDER BY Students.NetId DESC"
35801,3893281,"select distinct Students.FirstName, Students.LastName, Students.NetId
from Students
where Students.Department='ECE' and Students.FirstName like 'T%'

union

select distinct Students.FirstName, Students.LastName, Students.NetId
from Students
inner join Enrollments on Enrollments.NetId=Students.NetId and Students.Department='ECE'
inner join Courses on Enrollments.CRN=Courses.CRN and Courses.Department='CS'
order by NetId desc"
5498,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s 
INNER JOIN Enrollments e ON s.NetId = e.NetId
INNER JOIN Courses c ON e.CRN = c.CRN
WHERE s.Department = 'ECE' AND (s.FirstName = 'T%' OR c.Department = 'CS')
ORDER BY s.NetId DESC;
"
34712,3893281,"select distinct
    FirstName, LastName, s.NetId
from
    Students s, Enrollments e, Courses c
where (s.Department = 'ECE' AND s.FirstName like 'T%')
or s.NetId in (
    select s.NetId
    from Students s, Enrollments e, Courses c
    where (s.Department = 'ECE' and s.NetId = e.NetId And e.CRN = c.CRN And c.Department = 'CS')
    )
order by
s.NetId desc
"
5467,3893281,"Select * from
((Select DISTINCT Students.FirstName, Students.LastName, Students.NetId
FROM Enrollments INNER JOIN Courses ON Enrollments.CRN = Courses.CRN, Students

where Students.NetId = Enrollments.NetId and Courses.Department = ""CS"" and Students.Department = ""ECE"")
UNION
(SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetId
from Students
where Students.Department = ""ECE"" and Students.FirstName Like ""T%"")) as T
ORDER BY T.NetId DESC
"
313229,3893281,"SELECT DISTINCT FirstName, LastName, NetId
FROM Students S
WHERE Department = 'ECE' AND (FirstName Like 'T%' OR EXISTS (SELECT * 
                                                            FROM Enrollments E NATURAL JOIN Courses C
                                                            WHERE S.NetId = E.NetId AND C.Department = 'CS'))
ORDER BY NetId DESC"
310293,3893281,"SELECT Distinct s.FirstName, s.LastName, s.NetId FROM

(Students s left Join Enrollments e on s.NetId = e.NetId) right join Courses c on e.CRN = c.CRN

WHERE s.Department = 'ECE' and (left(s.FirstName, 1) = 'T' or c.Department = 'CS');"
4397,3893281,"SElECT S.FirstName, S.LastName, E.NetId
FROM Students S 
JOIN Enrollments E on S.NetId = E.NetId
JOIN Courses C on E.CRN=C.CRN
WHERE S.Department = ""ECE"" AND (S.FirstName=""T%"" OR C.department=""CS"")
GROUP BY E.NetId
ORDER BY E.NetId DESC "
10699,3893281,"SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetId
FROM Students, Courses, Enrollments
WHERE Students.NetId=Enrollments.NetId and Enrollments.CRN=Courses.CRN
and Students.Department=""ECE"" and (Students.NetId LIKE 'T%' or Courses.Department=""CS"")
ORDER BY Students.NetId DESC"
202279,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Students as S LEFT OUTER JOIN Enrollments as E ON S.NetId = E.NetId
LEFT OUTER JOIN Courses as C ON E.CRN = C.CRN
WHERE (C.Department = 'CS' AND S.Department = 'ECE') OR (S.FirstName LIKE 'T%' AND S.Department = 'ECE')
ORDER BY S.NetId DESC"
318962,3893281,"select s.FirstName, s.LastName, s.NetId
from Students s
where s.Department = 'ECE' and 
(s.FirstName like 'T%' or 
s.NetId in
(select e.NetId
from Enrollments e natural join Courses c
where c.Department = 'CS'))
order by s.NetId desc"
126834,3893281,"SELECT S.FirstName, S.LastName, S.NetId
FROM Students AS S
WHERE S.Department = 'ECE' AND (S.FirstName LIKE 'T%' OR
S.NetId IN (SELECT E.NetId FROM Enrollments E, Courses C WHERE E.CRN = C.CRN AND C.Department = 'CS'))
ORDER BY S.NetId DESC;
"
7926,3893281,"select FirstName, LastName, S.NetID
from Students as S
left join Enrollments as E on S.NetId = E.NetId
left join Courses as C on E.CRN = C.CRN
where S.Department = ""ECE"" and (C.Department = ""CS"" or SUBSTRING(FirstName, 1, 1) = ""T"")
group by S.NetId
order by NetId desc"
36316,3893281,"SELECT DISTINCT stud.FirstName, stud.LastName, stud.NetId
FROM Students stud
LEFT JOIN (SELECT e.NetId, c.Department FROM Enrollments e NATURAL JOIN Courses c) dept
ON stud.NetId = dept.NetId
WHERE stud.Department = 'ECE' AND (stud.FIRSTNAME LIKE 'T*' OR dept.Department = 'CS')
ORDER BY stud.NetId DESC;"
31860,3893281,"select Students.FirstName, Students.LastName, Students.NetId from Students join Enrollments on Students.NetId = Enrollments.NetId where (Enrollments.CRN in (select CRN from Courses where Department = ""CS"") and Students.Department = ""ECE"") or (Students.FirstName like ""T%"" and Students.Department = ""ECE"") group by Students.NetId order by Students.NetId desc"
34139,3893281,"SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetId
FROM Students
INNER JOIN Enrollments ON Enrollments.NetId = Students.NetId AND Students.Department = ""ECE""
INNER JOIN Courses ON Courses.CRN = Enrollments.CRN AND Courses.Department = ""CS""
OR Students.FirstName LIKE 'T%' 
ORDER BY Students.NetId DESC"
38065,3893281,"select distinct FirstName, LastName, NetId
from Students    
where (NetId in (select distinct NetId
                from Enrollments
                where CRN in (select CRN
                             from Courses
                             where Department = 'CS'))
                or FirstName like 'T%') and Department = 'ECE'
order by NetId desc"
33326,3893281,"SELECT FirstName, LastName, NetId
    FROM Students
    WHERE (DEPARTMENT = ""ECE"") AND (FirstName = ""T%"" OR NetId IN (
        SELECT NetId 
            FROM Enrollments NATURAL JOIN Courses
            WHERE Department = ""CS""
    ))
    ORDER BY NetId DESC"
36288,3893281,"SELECT DISTINCT stu.FirstName, stu.LastName, stu.NetId
FROM Students as stu join Enrollments as enr on stu.NetId = enr.NetId join Courses as cou on enr.CRN = cou.CRN
WHERE stu.Department = 'ECE' AND (LEFT(stu.FirstName, 1) = 'T""' OR 
    stu.NetId in (SELECT enr2.NetId FROM Enrollments as enr2 join Courses as cou2 on cou2.CRN = enr2.CRN where cou.Department='CS')
    )
ORDER BY stu.NetId DESC;"
33496,3893281,"SELECT FirstName, LastName, NetId
FROM Students
WHERE Department = ""ECE"" AND (FirstName LIKE ""T%"" OR NetId IN (
    SELECT NetId
    FROM Enrollments
    WHERE CRN IN (
        SELECT CRN
        FROM Courses
        WHERE Department = ""CS""
    )
))
ORDER BY NetId DESC"
34474,3893281,"select DISTINCT s.FirstName, s.LastName, s.NetId from Students as s 
JOIN Enrollments as e ON e.NetId = s.NetId
JOIN Courses as c ON c.CRN = e.CRN 
where s.Department = 'ECE' 
and ((s.FirstName LIKE 'T%') OR 
		(s.Department = 'ECE' and c.Department = 'CS'))
ORDER BY s.NetId DESC "
33327,3893281,"SELECT FirstName, LastName, NetId
From 
(
    SELECT FirstName, LastName, NetId, a.CRN, a.Department as ""StuDept"", Courses.Department as ""CourseDept""
    FROM
    (
        SELECT FirstName, LastName, Students.NetId as ""NetId"", Department, CRN
        FROM Students RIGHT JOIN Enrollments ON Students.NetId = Enrollments.NetId
    ) a
    RIGHT JOIN Courses ON a.CRN = Courses.CRN
    WHERE a.Department = ""ECE"" and ((Courses.Department = ""CS"") or (FirstName LIKE 'T%'))
    )  as T
GROUP BY NetId
ORDER BY NetId DESC;"
5259,3893281,"SELECT FirstName, LastName, NetId
FROM Students
WHERE Department = 'ECE' AND (FirstName LIKE 'T%' OR NetId in (SELECT DISTINCT NetId FROM Enrollments NATURAL JOIN Courses WHERE Department = 'CS'))
ORDER BY NetID DESC;"
5265,3893281,"SELECT DISTINCT se.FirstName, se.LastName, se.NetId
FROM (
    SELECT *
    FROM Students s
    NATURAL JOIN Enrollments e
    WHERE s.Department = 'ECE'
) AS se
JOIN Courses c
ON se.CRN = c.CRN
WHERE se.FirstName LIKE 'T%'
OR c.Department = 'CS'
ORDER BY se.NetId DESC"
5503,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId FROM Students S
INNER JOIN Enrollments E ON S.NetId = E.NetId
INNER JOIN Courses C ON E.CRN = C.CRN
WHERE S.Department = ""ECE""
AND (S.FirstName LIKE ""T%"" OR C.Department = ""CS"")
ORDER BY S.NetId DESC"
5271,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s, Enrollments e
WHERE s.Department = 'ECE' AND ( (s.FirstName LIKE 'T%') OR (s.Department = 'ECE' AND s.NetId = e.NetId AND e.CRN IN (SELECT CRN FROM Courses WHERE Department = 'CS')) )
ORDER BY s.NetId DESC"
324318,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s
WHERE (s.Department ='ECE' )
AND (s.FirstName LIKE 'T%'  
OR s.NetId IN
(SELECT e.NetId
FROM Enrollments e JOIN Courses c ON e.CRN = c.CRN 
WHERE c.Department='CS'))
ORDER BY NetId DESC;"
4769,3893281,"SELECT FirstName, LastName, NetId
FROM Courses cour NATURAL JOIN Enrollments enro NATURAL JOIN (SELECT FirstName, LastName, NetId
                                            FROM Students
                                            WHERE Department = 'ECE') as ECEstud
WHERE cour.Department = 'CS' or FirstName LIKE 'T%'
GROUP BY NetId
ORDER BY NetId DESC"
35385,3893281,"SELECT S.FirstName, S.LastName, S.NetID
FROM Enrollments as E 
INNER JOIN Students as S on S.NetId = E.NetId
WHERE S.Department = 'ECE' AND (S.FirstName LIKE 'T%' OR E.CRN IN 
(SELECT E.CRN 
FROM Enrollments as E 
INNER JOIN Courses as C on C.CRN = E.CRN
WHERE C.Department = 'CS'))
GROUP BY S.NetId
ORDER BY S.NetId DESC"
332195,3893281,"Select DISTINCT FirstName, LastName, NetId
From Students
Where Department = ""ECE"" AND FirstName LIKE ""T%"" OR Department = ""ECE"" AND NetID in (
                                                              Select DISTINCT NetID
                                                              From Enrollments e Natural Join Courses c
                                                              Where c.Department = ""CS""
                                                                                )
Order By NetID DESC;"
335822,3893281,"select FirstName,LastName,NetId
from Students
where Department = 'ECE' and NetId in 
(select DISTINCT NetId from Enrollments as E inner join Courses as C on E.CRN = C.CRN where C.Department = 'CS')
order by NetId DESC;"
12089,3893281,"Select Distinct FirstName, LastName, Students.NetId
From Students,
    (SELECT NetId
     From   Enrollments, (SELECT CRN
                          FROM Courses
                          Where Department LIKE 'CS') as temp1
     WHERE Enrollments.CRN LIKE temp1.CRN
     ) as temp2
Where Students.NetID like temp2.NetID AND Students.Department like 'ECE'
GROUP BY Students.NetId Desc;
"
36117,3893281,"SELECT FirstName, LastName, NetId
FROM Students S
WHERE Department = 'ECE' AND ((FirstName LIKE 'T%') OR EXISTS (
    SELECT CRN
    FROM Enrollments NATURAL JOIN Courses
    WHERE NetId = S.NetId AND Department = 'CS'
    )
)
ORDER BY NetId desc;"
33084,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s
WHERE s.Department = 'ECE' AND EXISTS (SELECT *
FROM Enrollments e, Courses c
WHERE s.NetId = e.NetId AND e.CRN = c.CRN AND c.Department = 'CS')
ORDER BY NetId DESC"
7276,3893281,"SELECT FirstName, LastName, NetId
FROM (SELECT * FROM Students WHERE Department = 'ECE') as EStudents
WHERE FirstName like 'T%' OR NetId in(
    SELECT DISTINCT NetId from Enrollments where CRN in(
        SELECT CRN from Courses WHERE Department = 'CS'
        )
)
Order BY NetId DESC"
313213,3893281,"select distinct FirstName, LastName, NetId 
from Students
where Department=""ECE"" and (FirstName=""T%"" or NetID in
(select NetID
from Enrollments
where CRN in (select CRN
from Courses
where Department=""CS"")))
Order by NetId desc"
34660,3893281,"SELECT DISTINCT FirstName, LastName, Students.NetId
FROM Students
WHERE Department = 'ECE' AND (FirstName = 'T%' OR Students.NetId IN (
    SELECT Enrollments.NetId
    FROM Enrollments LEFT JOIN Courses
    ON Enrollments.CRN = Courses.CRN
    WHERE Courses.Department = 'CS'
))
ORDER BY Students.NetId DESC"
33331,3893281,"SELECT A.FirstName, A.LastName, A.NetID
FROM Students A, (Select C.NetId 
                From Enrollments C Natural Join Courses D
                Where D.Department = 'CS'
                Group By C.NetId
                Having COUNT(D.Department) > 0) as temp2
Where (A.Department = 'ECE' AND A.FirstName LIKE 'T%') or (A.Department = 'ECE' AND A.NetId = temp2.NetId)
GROUP BY A.NETID
ORDER BY A.NetId DESC"
332008,3893281,"select FirstName, LastName, NetId  from Students where (NetId in (select NetId from Enrollments natural join Courses where Courses.Department = 'CS') or Students.FirstName like 'T%' ) and Department = 'ECE'  order by NetId desc"
332020,3893281,"SELECT DISTINCT FirstName, LastName, NetID, Courses.Department
FROM Students NATURAL JOIN Courses 
WHERE Students.Department= 'ECE' AND (Students.FirstName LIKE 'T%'  or Courses.Department = 
                            ANY (SELECT Courses. Department	
                              FROM Courses
                              WHERE Courses.Department='CS'))
GROUP BY NetID 
#SELECT FirstName, LastName, NetID, Department
#FROM Students NATURAL JOIN Courses 
#WHERE Department = ANY  (SELECT Department
 #           FROM Courses
#            WHERE Department= 'CS')
#GROUP BY NetID"
11185,3893281,"select distinct S.FirstName, S.LastName, S.NetId
from ((Enrollments E inner join Students S
                                    on E.NetId = S.NetId) inner join Courses C
                                    on E.CRN = C.CRN)
where S.Department = 'ECE' and (S.FirstName like 'T%' or C.Department = 'CS')
order by S.NetId desc;
                   "
5460,3893281,"select S.FirstName, S.LastName, S.NetId
from Students S
where S.Department = ""ECE"" and (S.FirstName = ""T%"" or exists (select 1
                                  from Enrollments E Natural Join Courses C
                                  where E.NetId = S.NetId and C.Department = ""CS""))
order by S.Netid DESC;"
30765,3893281,"SELECT DISTINCT s2.FirstName, s2.LastName, s2.NetId
FROM Students s2, Enrollments e2, Courses c2
WHERE s2.Department='ECE' AND s2.NetId=e2.NetId AND e2.CRN=c2.CRN and c2.Department='CS'
ORDER BY s2.NetId DESC; 
"
33739,3893281,"SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetId
FROM Students, Enrollments, Courses
WHERE (Students.NetId = Enrollments.NetId AND Students.Department = 'ECE' AND Students.FirstName LIKE 'T%') OR (Students.NetId = Enrollments.NetId AND Students.Department = 'ECE' AND Enrollments.CRN = Courses.CRN AND Courses.Department = 'CS')
ORDER BY Students.NetId DESC
"
30542,3893281,"SELECT DISTINCT * FROM 
(SELECT * FROM 
    (
    SELECT FirstName, LastName, NetId
    FROM Students
    WHERE FirstName LIKE 'T%' AND Department = 'ECE'
    ) AS T1
UNION
SELECT * FROM
    (
    SELECT FirstName, LastName, NetId
    FROM Students 
    WHERE Department = ""ECE"" AND
    NetId IN 
        (
        SELECT NetId
        FROM Enrollments E
        NATURAL JOIN Courses C
        WHERE C.Department = ""CS""
        )
    ) AS T2
) AS T3
ORDER BY NetId DESC"
32963,3893281,"SELECT DISTINCT FirstName, LastName, NetId
FROM Students
WHERE Department = 'ECE' AND 
		(FirstName LIKE 'T%' OR 
        NetId IN (SELECT DISTINCT NetId
			FROM Enrollments JOIN Courses
				ON Enrollments.CRN = Courses.CRN
            WHERE Department = 'CS'))
ORDER BY NetId DESC;"
5726,3893281,"SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetId
FROM Students 
INNER JOIN Enrollments ON Students.NetId = Enrollments.NetId 
INNER JOIN Courses ON Enrollments.CRN = Courses.CRN
WHERE Students.Department = 'ECE' AND ((Students.FirstName LIKE 'T%') OR Courses.Department = 'CS')
ORDER BY Students.NetId DESC;"
6575,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s, Enrollments e, Courses c
WHERE ((s.Department = 'ECE') AND (s.FirstName LIKE 'T%'))
OR (s.Department = 'ECE' AND s.NetId IN (SELECT e2.NetId FROM Enrollments e2, Courses c2
                WHERE e2.CRN = c2.CRN AND c2.Department ='CS'))
ORDER BY s.NetId desc

"
5256,3893281,"SELECT FirstName, LastName, NetId
FROM Students NATURAL JOIN Enrollments NATURAL JOIN Courses
WHERE Department = ""ECE"" AND (FirstName LIKE ""T%"" OR Courses.Department = ""CS"")"
12133,3893281,"SELECT DISTINCT S1.FirstName, S1.LastName, S1.NetId
FROM ((Enrollments E1
INNER JOIN Courses C1 ON C1.CRN = E1.CRN)
INNER JOIN Students S1 on S1.NetId = E1.NetId)
WHERE S1.Department = 'ECE' AND (S1.FirstName LIKE 'T%' OR C1.Department = 'CS')
ORDER BY S1.NetId DESC;"
31926,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Enrollments E LEFT JOIN Students S
ON E.NetID = S.NetId LEFT JOIN Courses C
ON E.CRN = C.CRN
WHERE S.Department = 'ECE' AND (S.FirstName LIKE 'T%' OR C.Department = 'CS')
ORDER BY S.NetId DESC;"
5493,3893281,"SELECT FirstName, LastName, NetId 
FROM Students 
WHERE Department = 'ECE' AND (FirstName LIKE 'T%' OR NetID IN (SELECT e.NetId FROM Enrollments e NATURAL JOIN Courses c WHERE c.Department = 'CS'))
ORDER BY NetId DESC;"
11941,3893281,"SELECT DISTINCT
    S.FirstName,
    S.LastName,
    S.NetId
FROM
    Students S 
    JOIN Enrollments E
        ON S.NetId = E.NetId
    JOIN Courses C
        ON E.CRN = C.CRN
WHERE
    S.Department = ""ECE""
    AND (
        S.FirstName LIKE ""T%""
        OR
        C.Department = ""CS""
    )
ORDER BY
    S.NetId DESC "
5678,3893281,"SELECT DISTINCT FirstName, s.LastName, s.NetId
FROM Students s INNER JOIN Enrollments e ON s.NetId = e.NetId
       INNER JOIN Courses c ON e.CRN = c.CRN

WHERE s.Department = ""ECE"" AND (FirstName = ""T%"" OR c.Department = ""CS"")
ORDER BY NetId DESC

"
86354,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students AS s
INNER JOIN Enrollments AS e ON s.NetId = e.NetId
INNER JOIN Courses as c ON c.CRN = e.CRN
WHERE s.FirstName LIKE 'T%' AND s.Department = ""ECE"" OR s.Department = ""ECE"" AND c.Department = ""CS""
ORDER BY s.NetId DESC;
"
5308,3893281,"SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetId
FROM Students JOIN Enrollments ON Students.NetId = Enrollments.NetId JOIN Courses ON Courses.CRN = Enrollments.CRN
WHERE (Students.Department = 'ECE' AND Students.FirstName LIKE ""T%"") OR (Students.Department = 'ECE' AND Courses.Department = 'CS')
ORDER BY Students.NetId DESC"
36050,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s,   (SELECT e.NetId
                    FROM Enrollments e, Courses c
                    WHERE e.CRN = c.CRN and c.Department = ""CS"") cs_NetIds
WHERE s.Department = ""ECE"" AND
(s.FirstName Like ""T%"" OR s.NetId = cs_NetIds.NetId)
ORDER BY s.NetId  DESC

"
5283,3893281,"SELECT distinct s.FirstName, s.LastName, s.NetId
From Students s, Enrollments e, Courses c
WHERE s.Department = ""ECE"" and ((s.FirstName LIKE ""T%"" ) OR (s.NetId = e.NetId and e.CRN = c.CRN and c.Department = ""CS""))
Order by s.NetId DESC"
35941,3893281,"SELECT FirstName, LastName, Students.NetId
FROM Students, Enrollments, Courses
WHERE Students.Department = ""ECE"" AND (FirstName LIKE 'T%' OR (Courses.Department = ""CS"" AND Courses.CRN = Enrollments.CRN AND Enrollments.NetId = Students.NetId))
ORDER BY Students.NetId DESC"
34691,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetID
FROM Students S, Enrollments E, Courses C
WHERE S.Department = 'ECE' and (S.FirstName LIKE 'T%' or (E.NetId = S.NetID and E.CRN = C.CRN and C.Department = 'CS'))
ORDER BY NetID DESC
"
36051,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Students S
JOIN Enrollments E ON S.NetId = E.NetId
JOIN Courses C ON E.CRN = C.CRN
WHERE S.Department = ""ECE"" AND LEFT(S.FirstName, 1) = ""T"" 
OR S.Department = ""ECE"" AND C.Department = ""CS""
ORDER BY S.NetId;
"
32394,3893281,"SELECT Distinct A.FirstName, A.LastName, NetID
FROM Students A Natural Join Enrollments B, Courses C
WHERE (A.FirstName LIKE 'T%' AND A.Department = ""ECE"") OR (A.Department = ""ECE"" AND B.CRN = C.CRN AND C. Department = ""CS"")
ORDER BY NetId DESC"
5645,3893281,"SELECT FirstName, LastName, NetId 
from (select * from Students where Department = 'ECE') ECEStudents
where FirstName like 'T%' or NetId in (
  select DISTINCT NetId from Enrollments where CRN in (
    select CRN from Courses where Department = 'CS'
  )
)
Order by NetId DESC"
35616,3893281,"SELECT DISTINCT FirstName, LastName, S.NetId
FROM Students S, Enrollments E, Courses C
WHERE S.Department = 'ECE' AND (FirstName LIKE 'T%' OR (S.NetId = E.NetId AND E.CRN = C.CRN AND C.Department = 'CS'))
ORDER BY S.NetId DESC"
5669,3893281,"select distinct FirstName, LastName, NetId 
    from (Students s Natural Join Enrollments e) 
    Join
        -- Join Courses c on e.CRN = c.CRN
        -- group by FirstName, LastName
        (select c.Department, c.CRN from Courses c) x on e.CRN = x.CRN
    where s.Department = 'ECE' and (FirstName like 'T%' or x.Department = 'CS')
    order by NetId desc
    ;"
331655,3893281,"select FirstName, LastName, NetId
from Students
where NetId in (select distinct S.NetId
from Students S, Enrollments E, Courses C
where S.department = ""ECE"" && 
    ((S.NetId = E.NetId && E.crn = C.crn && C.Department = ""CS"") || S.FirstName like ""T%""))"
6573,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Students S
WHERE S.Department = 'ECE' and (S.FirstName LIKE 'T%' or EXISTS (SELECT*
                                    FROM Enrollments E, Courses C
                                    WHERE E.NetId = S.NetID and E.CRN = C.CRN and C.Department = 'CS'
                                                                ))  
ORDER BY S.NetId DESC;"
4370,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s
WHERE s.Department LIKE ""ECE"" AND (s.FirstName LIKE ""T%"" OR EXISTS (
SELECT e.NetId
FROM Enrollments e JOIN Courses c ON c.CRN = e.CRN
WHERE c.Department LIKE ""CS"" AND e.NetId = s.NetId))
ORDER BY s.NetId DESC;
"
8204,3893281,"SELECT DISTINCT Firstname, Lastname, NetId
FROM Students
WHERE (Department='ECE' AND Firstname LIKE 'T%') OR (Department='ECE' AND NetId in(SELECT NetId FROM Enrollments natural join Courses WHERE Department='CS'))
ORDER BY NetId DESC"
125841,3893281,"select Students.FirstName, Students.LastName, Students.NetId
from Students
where Students.Department = 'ECE' 
AND (Students.FirstName like 'T%'
OR exists (
  SELECT Enrollments.NetId, Enrollments.CRN
  FROM Enrollments
  inner join (
    select Courses.CRN, Courses.Department
    from Courses
    where Courses.Department = 'CS'
  ) as g on g.CRN = Enrollments.CRN
  where Enrollments.NetId = Students.NetId
))
order by Students.NetId desc;"
186898,3893281,"Select Distinct S.FirstName, S.LastName, S.NetId FROM Students S
JOIN Enrollments E ON S.NetId=E.NetId
JOIN Courses C ON E.CRN=C.CRN
WHERE (S.FirstName LIKE 'T%' AND S.Department = ""ECE"")
OR (S.Department = ""ECE"" AND C.Department = 'CS')
ORDER BY S.NetId DESC"
34723,3893281,"SELECT DISTINCT ece.FirstName, ece.LastName, ece.NetId 
FROM ((SELECT * FROM Students WHERE Department = 'ECE') AS ece NATURAL JOIN Enrollments e) JOIN Courses c ON e.CRN = c.CRN
WHERE ece.NetId = ANY (SELECT DISTINCT e.NetId
                                FROM Enrollments e NATURAL JOIN Courses c
                                WHERE c.Department = 'CS')
ORDER BY ece.NetId DESC




"
5126,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId 
FROM Students S, Enrollments E, Courses C 
WHERE S.Department = ""ECE"" AND S.FirstName LIKE ""T%""
    OR ( S.Department = ""ECE"" AND S.NetId = E.NetId AND E.CRN = C.CRN 
        AND C.Department = ""CS"")
ORDER BY S.NetId DESC"
125328,3893281,"select distinct  s.FirstName, s.LastName, s.NetId from Students s
    left join Enrollments e on s.NetId = e.NetId
    left join Courses c on e.CRN = c.CRN
    where (s.Department='ECE' and c.Department='CS') or (left(s.FirstName,1)='T'and s.Department='ECE' )
    order by s.NetId DESC"
5130,3893281,"SELECT DISTINCT FirstName, LastName, s.NetId
FROM Students s INNER JOIN Enrollments e ON s.NetId = e.NetId INNER JOIN Courses c ON c.CRN = e.CRN
WHERE (s.Department = 'ECE' AND FirstName LIKE 'T%') OR (s.Department = 'ECE' AND c.Department = 'CS')
ORDER BY NetId DESC;"
10697,3893281,"SELECT DISTINCT FirstName, LastName, NetId
FROM Students NATURAL JOIN Enrollments
WHERE (FirstName LIKE ""T%"" AND Department = ""ECE"") or ( Department = ""ECE"" AND CRN IN (SELECT CRN
                                          FROM Courses
                                          WHERE Department = ""CS""
                                          ) 
                            )
ORDER BY NetId DESC;"
5246,3893281,"select distinct FirstName, LastName, NetId from Enrollments e natural join Students s join Courses c on e.CRN = c.CRN where s.Department = ""ECE"" and (s.FirstName like 'T%' or c.Department = ""CS"") order by NetId desc"
5722,3893281,"SELECT DISTINCT Students.FirstName, Students.LastName, Students.NetId
FROM (Students
NATURAL JOIN Enrollments)
JOIN Courses ON Enrollments.CRN = Courses.CRN
WHERE Students.Department = 'ECE' AND (FirstName LIKE 'T%' OR Courses.Department = 'CS')
ORDER BY NetId DESC;"
5092,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s
WHERE s.Department = ""ECE"" AND (s.FirstName LIKE ""T%"" OR s.NetId IN (SELECT s1.NetId FROM Students s1 NATURAL JOIN Enrollments e JOIN Courses c ON e.CRN = c.CRN WHERE c.Department = ""CS""))
ORDER BY s.NetId DESC"
126556,3893281,"SELECT FirstName, LastName, NetId
FROM Students
WHERE Department = ""ECE"" AND (FirstName LIKE ""T%"" OR NetId IN 
    (SELECT NetId FROM Enrollments WHERE CRN IN 
        (SELECT CRN FROM Courses WHERE Department = ""CS"")
    )
) ORDER BY NetId DESC;"
10641,3893281,"select FirstName, LastName, NetId
from Students s 
where s.FirstName like ""T%"" and s.Department = ""ECE""
union
select distinct FirstName, LastName, s.NetId
from (Students s natural join Enrollments e) inner join Courses c on e.CRN = c.CRN 
where c.Department = ""CS"" and s.Department = ""ECE""
order by NetId desc 
"
8171,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Students AS S, Enrollments AS E, Courses AS C
WHERE S.Department = ""ECE"" AND
    (S.FirstName LIKE 'T%' OR (S.NetId = E.NetId
        AND E.CRN = C.CRN
        AND C.Department = 'CS'))
ORDER BY S.NetId DESC;"
37573,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Enrollments E INNER JOIN Students S ON S.NetId = E.NetId
WHERE S.Department = ""ECE"" AND (S.FirstName LIKE ""%T"" OR E.CRN IN (
SELECT E.CRN
FROM Enrollments E INNER JOIN Courses C on C.CRN = E.CRN
WHERE C.Department = ""CS"" ))
GROUP BY S.NetId
ORDER BY S.NetId DESC;"
32153,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s 
WHERE s.Department = ""ECE""
AND (s.FirstName Like ""T%""
OR s.NetId IN  (SELECT e.NetId
                FROM Enrollments e Natural Join Courses c
                WHERE Department = ""CS"")
)
ORDER BY s.NetId DESC

"
313637,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Students S JOIN Enrollments E JOIN Courses C ON S.NetId = E.NetId AND E.CRN = C.CRN
WHERE (S.Department = 'ECE') AND (S.FirstName LIKE 'T%' OR C.Department = 'CS')
ORDER BY S.NetId DESC "
130804,3893281,"select s.FirstName, s.LastName, s.NetID
from Students s, Enrollments e, Courses c
where s.Department = ""ECE"" and  s.NetID = e.NetID and c.CRN = e.CRN
group by  s.NetID, s.FirstName, s.LastName
HAVING left(s.FirstName, 1) = 'T' or sum(c.Department = ""CS"") >= 1
order by s.netid desc;"
122226,3893281,"SELECT DISTINCT FirstName, LastName, Students.NetId 
FROM Students 
JOIN Enrollments ON Students.NetId = Enrollments.NetId
JOIN Courses ON Courses.CRN = Enrollments.CRN
WHERE 
Students.Department = ""ECE"" AND (Courses.Department = ""CS"" OR FirstName LIKE 'T%')
ORDER BY Students.NetId desc;
"
35048,3893281,"SELECT FirstName, LastName, NetId FROM (SELECT * FROM Students S NATURAL JOIN Enrollments E WHERE S.Department = ""ECE"") as temp JOIN Courses C ON temp.CRN = C.CRN WHERE C.Department = ""CS"" OR temp.FirstName = ""T%"""
201123,3893281,"select distinct FirstName, LastName, Students.NetId 
from ((Students
inner join Enrollments on Students.netId = Enrollments.NetId)
inner join Courses on Enrollments.CRN = Courses.CRN)
where FirstName like 't%'
and Students.Department = 'ECE' or 
Courses.Department Like 'CS'
and Students.Department = 'ECE' 
order by NetId desc;"
127606,3893281,"select distinct s.FirstName, s.LastName, s.NetID
from Students s, Enrollments e, Courses c
where s.Department = 'ECE' and (s.FirstName like 'T%' or (s.NetId = e.NetId and e.CRN=c.CRN and c.Department = 'CS'))
order by s.NetId desc;"
37267,3893281,"SELECT DISTINCT FirstName, LastName, Students.NetId
FROM Students
WHERE Department = 'ECE' 
AND (FirstName LIKE 'T%' 
OR NetId IN (
SELECT Enrollments.NetId 
FROM Enrollments NATURAL JOIN Courses
WHERE Courses.Department = 'CS'
)
)
ORDER BY NetId DESC"
34020,3893281,"SELECT FirstName, LastName, NetId
FROM Students
WHERE (NetId IN
    (SELECT DISTINCT NetId /*Select Netids of students taking CS Courses*/
    FROM Enrollments
    WHERE CRN IN 
        (SELECT CRN  /*Select CS Courses*/
        FROM Courses
        WHERE Department = 'CS')) AND Students.Department = 'ECE') OR (Students.Department = 'ECE' AND Students.FirstName = 'T%')
ORDER BY NetId DESC"
35116,3893281,"SELECT FirstName, LastName, T.NetId
FROM(
SELECT DISTINCT NetID
FROM(SELECT T.NetId, E.CRN 
FROM (SELECT NetId 
FROM Students 
WHERE Department = 'ECE') as T, Enrollments E
WHERE E.NetId = T.NetId) as T, Courses C
WHERE C.CRN = T.CRN and C.Department = 'CS') as T, Students S
WHERE T.NetId = S.NetId
ORDER BY NetId DESC


"
37517,3893281,"select FirstName, LastName, NetId
from Students
where Department = 'ECE' AND 
    (FirstName like 'T%' OR EXISTS (select * from Enrollments natural join Courses where Department = 'CS' and NetId = Students.NetId))
order by NetId DESC;
"
36027,3893281,"SELECT DISTINCT FirstName, LastName, NetId
FROM 
(SELECT FirstName, LastName, NetId, CRN, Department
FROM Enrollments e NATURAL JOIN Students s
WHERE Department = ""ECE"" AND (FirstName LIKE ""T%"" OR CRN = ANY (SELECT CRN FROM Courses WHERE Department = ""CS""))) AS temp
ORDER BY NetID DESC

"
319746,3893281,"SELECT S.FirstName, S.LastName, S.NetID 
From Students S
Where S.Department = ""ECE"" AND (S.Firstname LIKE 'T%' OR EXISTS (
SELECT *
FROM Enrollments E LEFT OUTER JOIN Courses C ON E.CRN = C.CRN
Where C.Department = ""CS"" AND E.NetID = S.NetID))
ORDER BY NetID DESC;"
33188,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s, Enrollments e, Courses c
WHERE s.Department = 'ECE' AND (s.FirstName LIKE 'T%' OR 
(s.NetId = e.NetId AND e.CRN = c.CRN AND c.Department = 'CS'))
ORDER BY NetId DESC"
30481,3893281,"SELECT DISTINCT S.FirstName, S.LastName, NetId
FROM Students S
NATURAL JOIN Enrollments E
LEFT OUTER JOIN Courses C ON E.CRN = C.CRN
WHERE (S.FirstName LIKE 'T%' AND S.Department LIKE 'ECE')
    OR (S.Department LIKE 'ECE' AND C.Department LIKE 'CS')
ORDER BY NetId DESC"
33375,3893281,"SELECT s.FirstName, s.LastName, s.NetId
FROM Students s
WHERE s.Department = 'ECE' AND (s.FirstName LIKE 'T%' OR s.NetId IN (SELECT e.NetId FROM Enrollments e NATURAL JOIN Courses c WHERE c.Department = 'CS'))
order by s.NetId desc



    "
36594,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Students S
     JOIN Enrollments E ON S.NetId = E.NetId
     JOIN Courses C ON E.CRN = C.CRN
WHERE S.Department = 'ECE' AND (C.Department = 'CS' OR S.FirstName LIKE 'T%')
ORDER BY S.NetID DESC"
5753,3893281,"select distinct s.FirstName, s.LastName, s.NetId
from Students s inner join Enrollments e on s.NetId = e.NetId inner join Courses c on e.CRN = c.CRN
where s.Department = ""ECE"" and (c.Department = ""CS"" or s.FirstName like ""T%"")
order by s.NetId desc"
337120,3893281,"SELECT  DISTINCT FirstName, LastName, NetId
FROM (SELECT FirstName, LastName, NetId FROM Students WHERE Department = 'ECE') AS ECEStudents
WHERE NetId IN (SELECT NetId FROM (SELECT NetId, CRN FROM (SELECT NetId FROM Students WHERE Department = 'ECE') AS ECEStuNetId NATURAL JOIN Enrollments WHERE ECEStuNetId.NetId = Enrollments.NetId) AS ECEStuEnroll NATURAL JOIN (SELECT CRN FROM Courses WHERE Department = 'CS') AS CSCourses WHERE ECEStuEnroll.CRN = CSCourses.CRN) OR FirstName LIKE 'T%'
ORDER BY NetId DESC"
7637,3893281,"SELECT DISTINCT FirstName, LastName, s.NetID
FROM Students s JOIN (Enrollments e JOIN Courses c ON e.CRN = c.CRN) ON s.NetID = e.NetID
WHERE s.Department = ""ECE"" AND (c.Department = ""CS"" OR s.FirstName LIKE 'T%')
ORDER BY s.NetID DESC"
5791,3893281,"select FirstName, LastName, NetId
from Students
where Department = ""ECE""
and (
    FirstName like ""T%""
    or NetId in (
        select NetId
        from Enrollments natural join (
            select *
            from Courses
            where Department = ""CS""
        ) t1
    )
)
order by NetId desc"
85373,3893281,"select distinct Students.FirstName, Students.LastName, Students.NetID
from Students, Courses, Enrollments
where Students.FirstName like 'T%' and Students.Department = ""ECE"" or Students.Department = ""ECE"" and Students.NetID = Enrollments.NetID and Enrollments.CRN = Courses.CRN and Courses.Department = ""CS""
order by Students.NetID DESC
-- in  or Courses.Department = ""CS"" "
31826,3893281,"SELECT DISTINCT S.FirstName,S.LastName,S.NetID 
FROM Students S,Enrollments E, Courses C
Where S.Department='ECE' and (S.FirstName like 'T%' or S.NetId=E.NetId and E.CRN=C.CRN and C.Department='CS'
)
ORDER by NetID DESC"
33758,3893281,"SELECT DISTINCT FirstName, LastName, NetId FROM 
(
    SELECT FirstName, LastName, NetId, CRN FROM
    (
        SELECT FirstName, LastName, NetId, CRN, Department
        FROM Students NATURAL JOIN Enrollments
        WHERE Department = ""ECE""
    ) as ECE
    WHERE EXISTS (SELECT Department, CRN FROM Courses WHERE (ECE.CRN = CRN AND Department = ""CS"") OR ECE.FirstName = ""T%"")
) as names
ORDER BY NetId DESC
    "
36387,3893281,"SELECT Students.FirstName, Students.LastName, Students.NetId
FROM Students
INNER JOIN Enrollments ON Students.NetId = Enrollments.NetID
INNER JOIN Courses ON Enrollments.CRN = Courses.CRN
WHERE Students.Department = 'ECE' AND (Students.NetId LIKE 'T%' OR Courses.Department = 'CS')
GROUP BY Students.NetId
ORDER BY Students.NetId DESC;"
336388,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students AS s
JOIN (SELECT Enrollments.NetId, Courses.Department
      FROM Enrollments
      JOIN Courses
      ON Enrollments.CRN = Courses.CRN) AS c
ON s.NetId = c.NetId
WHERE (s.Department = 'ECE' AND (s.FirstName LIKE 'T%' OR c.Department = 'CS'))
ORDER BY s.NetId DESC"
65042,3893281,"select distinct s.FirstName, s.LastName, s.NetId
from Students s, Courses c join Enrollments e on c.CRN = e.CRN
where s.NetId = e.NetId AND s.Department = 'ECE' AND (s.FirstName like 'T%' OR c.Department = 'CS')
order by s.NetId DESC"
9781,3893281,"SELECT FirstName, LastName, NetId
FROM Students stu
WHERE Department = ""ECE"" AND (FirstName like ""T%"" OR EXISTS(SELECT NetId FROM Enrollments NATURAL JOIN Courses
WHERE Department = ""CS"" AND NetId = stu.NetId))
ORDER BY NetId desc"
33006,3893281,"SELECT *
FROM (

    SELECT FirstName, LastName, NetId
    FROM Students
    WHERE Department = ""ECE"" and FirstName = ""T%""
    
    UNION
    
    SELECT  Students.FirstName, Students.LastName, Students.NetId
    FROM Students, Enrollments, Courses
    WHERE Students.Department = ""ECE"" and Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN and Courses.Department = ""CS""
    ) 
    
    as C
    
ORDER BY NetId DESC    



"
33358,3893281,"SELECT DISTINCT b.FirstName, b.LastName, b.NetId
FROM(SELECT a.FirstName, a.LastName, a.NetId, c.Department
     FROM ( SELECT *
            FROM Students s
            WHERE s.Department = 'ECE'
    ) AS a, Enrollments AS e, Courses AS c
    WHERE a.NetId = e.NetId and e.CRN = c.CRN
    )AS b
WHERE (b.FirstName Like 'T%') or b.Department = 'CS'
ORDER BY b.NetId DESC"
331540,3893281,"Select FirstName,LastName,NetId
from Students NATURAL JOIN Courses
where Department LIKE ""ECE"" and FirstName LIKE ""T%""
group by NetId DESC

UNION

Select FirstName,LastName,NetId
from Students NATURAL JOIN Courses
where Department LIKE ""ECE"" and NetId IN (
Select DISTINCT NetId 
from Enrollments NATURAL JOIN Courses 
where Department LIKE ""CS"" 
)
group by NetId DESC

"
10556,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM  Students s JOIN Enrollments e ON s.NetId = e.NetId JOIN Courses c ON e.CRN = c.CRN
WHERE (s.FirstName LIKE 'T%' and s.Department = 'ECE') or (s.Department = 'ECE' and c.Department = 'CS')
ORDER BY s.NetId DESC;"
322515,3893281,"SELECT 
    DISTINCT S.FirstName, S.LastName, S.NetId
FROM 
    Students S JOIN Enrollments E ON S.NetId = E.NetId
    JOIN Courses C ON C.CRN = E.CRN
WHERE 
    S.Department = ""ECE""
    AND
    (SUBSTRING(S.FirstName, 1, 1) = ""T""
    OR
    C.Department = ""CS"")
ORDER BY
    S.NetId DESC"
130618,3893281,"SELECT FirstName, LastName L, NetId
FROM Students s
WHERE (FirstName LIKE 'T%' OR EXISTS (SELECT NetId FROM Enrollments NATURAL JOIN Courses WHERE Courses.Department = ""CS"" AND s.NetId = Enrollments.NetId)) AND s.Department = ""ECE""
ORDER BY NetId DESC"
36209,3893281,"SELECT FirstName, LastName, NetId 
    FROM Students 
    WHERE Department = ""ECE"" AND 
        (LEFT(FirstName, 1) = ""T"" OR 
        NetId IN 
            (SELECT e.NetId 
            FROM Enrollments e 
            JOIN Courses c ON e.CRN = c.CRN 
            WHERE c.Department = ""CS"")
        )
    ORDER BY NetId DESC;
"
33198,3893281,"SELECT S.FirstName, S.LastName, S.NetId
FROM Students S, Enrollments E, Courses C
WHERE S.NetId = E.NetId AND E.CRN = C.CRN AND LEFT(S.Department, 3) = 'ECE' AND (LEFT(S.FirstName, 1) = 'T'OR LEFT(C.Department, 2) = 'CS')
GROUP BY S.NetId DESC;
"
5233,3893281,"select distinct FirstName, LastName, Students.NetId from Students, Enrollments, Courses where Students.Department=""ECE"" and (Students.FirstName like ""T%"" OR (Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN and Courses.Department = ""CS"")) order by Students.NetId DESC"
5435,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s
LEFT JOIN (
        SELECT e.NetId, Department AS classDept
        FROM Enrollments e
        LEFT JOIN (
            SELECT CRN, Department
            FROM Courses
        ) AS c
        ON c.CRN = e.CRN
    ) AS enr
ON enr.NetId = s.NetId
WHERE s.Department = 'ECE' 
AND (s.FirstName LIKE 'T%' 
OR classDept = 'CS')
ORDER BY s.NetId DESC
"
35847,3893281,"select distinct s.FirstName, s.LastName, s.NetId 
from Students s, Enrollments e, Courses c
where s.Department = 'ECE' and (s.FirstName like 'T%' or s.NetId in (select ei.NetId from Enrollments ei, Courses ci where ei.CRN = ci.CRN and ci.Department = 'CS'))
order by s.NetId desc
;"
9769,3893281,"select ECE.FirstName, ECE.LastName, ECE.NetId
from (select * from Students where Students.Department = ""ECE"") as ECE
where ECE.NetId in (select distinct Enrollments.NetId
                  from Enrollments
                  where Enrollments.CRN in (select CRN from Courses where Department = ""CS"") and Enrollments.NetId in (select NetId  from Students where Students.Department = ""ECE"")) or ECE.FirstName like 'T%'
Order by ECE.NetId DESC"
124294,3893281,"SELECT FirstName, LastName, NetId
FROM Students
WHERE Department = ""ECE"" AND (
    FirstName = ""T%""
    OR
    NetId IN (
        SELECT NetId
        FROM Enrollments NATURAL JOIN Courses
        WHERE Department = ""CS""
    )
)
ORDER BY NetId DESC;"
6923,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Students s NATURAL JOIN Enrollments e
WHERE (s.Department LIKE 'ECE') AND (s.FirstName LIKE 'T%' OR e.CRN IN (SELECT c.CRN FROM Courses c WHERE c.Department LIKE 'CS'))
ORDER BY s.NetId DESC;"
7426,3893281,"SELECT FirstName, LastName, NetId
FROM (SELECT* 
    FROM Students
    WHERE Department = 'ECE') 
        ECEStudents
    WHERE FirstName like 'T%' or NetId in (
        SELECT DISTINCT NetId FROM Enrollments 
        WHERE CRN in (
        SELECT CRN FROM Courses WHERE Department = 'CS'
        )
)
ORDER by NetId DESC"
34391,3893281,"SELECT Students.FirstName, Students.LastName, Students.NetId
from Students, Enrollments, Courses
where Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN and Students.Department = ""ECE""
and (Students.NetId like 'T%' or Courses.Department = ""CS"")
group by Students.NetId
order by Students.NetId desc

"
5768,3893281,"SELECT DISTINCT FirstName, LastName, s.NetId
FROM Courses c JOIN Enrollments e ON e.CRN = c.CRN JOIN Students s ON e.NetId = s.NetId
WHERE s.Department = 'ECE' AND (c.Department = 'CS' OR s.FirstName LIKE 'T%')
ORDER BY s.NetId DESC"
322502,3893281,"SELECT DISTINCT S.FirstName, S.LastName, S.NetId
FROM Students S, Enrollments E, Courses C
WHERE (S.Department = 'ECE' AND S.FirstName = 'T%') OR (S.Department = 'ECE' AND S.NetId = E.NetId AND E.CRN = C.CRN AND C.Department = 'CS')
ORDER BY S.NetId DESC;"
36183,3893281,"SELECT DISTINCT s.FirstName, s.LastName, s.NetId
FROM Enrollments e 
JOIN Courses c ON (e.CRN = c.CRN)
JOIN Students s ON (s.NetId = e.NetId)  
WHERE ((SUBSTRING(s.FirstName, 1, 1) = 'T' AND s.Department = ""ECE"") OR ((c.Department = ""CS"") AND (s.Department = ""ECE"") AND (s.NetId = e.NetId)))
ORDER BY s.NetId DESC

-- QUERY TO FIND ECE STUDENTS WHOSE FIRST NAME STARTS WITH T
-- SELECT *
-- FROM Students s
-- WHERE(SUBSTRING(s.FirstName, 1, 1) = 'T' AND s.Department = ""ECE"")

-- QUERY TO FIND ECE STUDENTS TAKING AT LEAST ONE COURSE IN CS DEPARTMENT
-- SELECT * 
-- FROM Enrollments e 
-- JOIN Courses c ON (e.CRN = c.CRN)
-- JOIN Students s ON (s.NetId = e.NetId)  
-- WHERE(c.Department = ""CS"") AND (s.Department = ""ECE"") AND (s.NetId = e.NetId)

"
35307,3893281,"SELECT DISTINCT FirstName, LastName, NetId
FROM Students
WHERE Department = ""ECE"" AND ((FirstName LIKE 'T%') OR (NetId IN (SELECT NetId FROM Enrollments WHERE CRN IN (SELECT CRN FROM Courses WHERE Department = ""CS""))))
ORDER BY NetId DESC"
313665,3893288,"select A.ProductName,count(T.CustomerId)
from Products A,Purchases T
where T.PurchaseId in
(select F.PurchaseId from Customers B,Purchases F
where (B.FirstName like 'J%' or (B.PhoneNumber-4)%10=0 or B.CustomerId in 
    (select CustomerId from Products Pr,Purchases Pu where Pr.ProductId = Pu.ProductId and (Pr.BrandName = 'Apple' or Pr.BrandName = 'Google'))
    ) and F.CustomerId=B.CustomerId)
and A.BrandName='Samsung'
and A.ProductId = T.ProductId
group by T.ProductId
order by ProductName asc;"
335477,3893288,"select p1.ProductName, count(p2.CustomerId)
from Products p1 natural join Purchases p2
where p1.BrandName='Samsung' and p2.CustomerId in (select cc.CustomerId as cid 
     from Customers cc natural join Purchases pp1 natural join Products pp2 
     where cc.FirstName like 'J%' or CAST(cc.PhoneNumber as CHAR) like '%4' or pp2.BrandName = 'Apple' or pp2.BrandName = 'Google')
group by p1.ProductName
order by p1.ProductName;"
10968,3893288,"SELECT p.ProductName, COUNT(c.CustomerId)
FROM Products p INNER JOIN Purchases h ON p.ProductId = h.ProductId
                INNER JOIN Customers c ON c.CustomerId = h.CustomerId
WHERE p.BrandName = 'Samsung' AND
      (c.FirstName LIKE ""J%"" OR
       c.PhoneNumber LIKE ""%4"" OR 
       c.CustomerId IN (SELECT h2.CustomerId
                        FROM Purchases h2 INNER JOIN Products p2 ON h2.ProductId = p2.ProductId
                        WHERE p2.BrandName = 'Google' or p2.BrandName = 'Apple'))
       
GROUP BY p.ProductName
ORDER BY p.ProductName ASC"
11323,3893288,"select ProductName, count(*)
from Products natural join Purchases as total
where BrandName = 'Samsung' and (CustomerId in (
                                            select CustomerId
                                            from Customers
                                            where SUBSTRING(FirstName, 1, 1) = 'J'
                                            )
                                or
                                 CustomerId in (
                                            select CustomerId
                                            from Customers
                                            where PhoneNumber like '%4'
                                              )
                                or
                                CustomerId in (
                                            select CustomerId
                                            from Purchases
                                            where CustomerId = total.CustomerId and 
                                                     ProductId in (
                                                                   select ProductId
                                                                   from Products
                                                                   where BrandName = 'Apple' or 'Google'
                                                                  )
                                            )
                            )
                     
                            
group by ProductName
-- select right('ss1234',1)"
30662,3893288,"SELECT ProductName, COUNT(CustomerId)
FROM Products pr NATURAL JOIN Purchases pu NATURAL JOIN Customers cu
WHERE pr.BrandName = ""Samsung"" AND (cu.PhoneNumber LIKE ""%4"" OR cu.FirstName LIKE ""J%"" OR pu.CustomerId IN(
    SELECT pur.CustomerID
    FROM Products pro NATURAL JOIN Purchases pur
    WHERE pro.BrandName = ""Google"" or pro.BrandName = ""Apple""
))
Group By ProductName"
37657,3893288,"SELECT p.ProductName, COUNT(*)
FROM Products p NATURAL JOIN Purchases pu NATURAL JOIN Customers c
WHERE p.BrandName = ""Samsung"" 

AND (c.FirstName LIKE ""J%"" 
OR c.PhoneNumber LIKE ""%4""
OR c.CustomerId IN (SELECT CustomerId FROM Customers NATURAL JOIN Purchases NATURAL JOIN Products WHERE BrandName = ""Google"" OR BrandName = ""Apple"")
)

GROUP BY p.ProductName

"
5759,3893288,"Select P.ProductName, (Select COUNT(*) 
    From Purchases Pr Natural Join Customers C 
    Where Pr.ProductId = P.ProductId And (C.FirstName Like 'J%' Or CAST(C.PhoneNumber As Char) Like '%4' Or C.CustomerId In(Select P2.CustomerId 
            From   Purchases P2 Natural Join Products Pro 
            Where  Pro.BrandName = 'Apple' Or Pro.BrandName = 'Google') )) CS
     
From Products P 
Where P.BrandName = 'Samsung' 
Order By P.ProductName "
36038,3893288,"select ProductName, count(ProductID) 
from Products natural join Purchases natural join Customers
where (BrandName = ""Samsung"" and FirstName = ""j%"") or (BrandName = ""Samsung"" and PhoneNumber = ""%4"") or (BrandName = ""Samsung"" and CustomerId in (select CustomerId
from Products natural join Purchases natural join Customers
where (BrandName = ""Apple"" or BrandName = ""Google"")
))
group by ProductName


"
10955,3893288,"Select Prod.ProductName, (Select Count(C.CustomerId) From Purchases Pur
                        Join Customers C on C.CustomerId = Pur.CustomerId
                        Join Products Pr on Pr.ProductId = Pur.ProductId
                        Where Prod.ProductId = Pur.ProductId and (C.FirstName like 'J%' Or C.PhoneNumber%10 = 4 or (C.CustomerId in (
                        Select AP.CustomerId From Purchases AP Join Products Ppp On AP.ProductId = Ppp.ProductId Where (Ppp.BrandName = 'Apple' or Ppp.BrandName = 'Google'))))) as num
From Products Prod
Where (Prod.BrandName = 'Samsung')
Order by Prod.ProductName Asc;"
35862,3893288,"SELECT ProductName, Count(*)
FROM Products p INNER JOIN Purchases d ON p.ProductId = d.ProductId
WHERE p.BrandName = 'Samsung' 
and ((Select FirstName FROM Customers c WHERE c.CustomerId = d.CustomerId) LIKE 'J%' 
or  (Select PhoneNumber FROM Customers c WHERE c.CustomerId = d.CustomerId) LIKE '%4'
or (Select Count(*) FROM Purchases x WHERE d.CustomerId = x.CustomerId and (SELECT BrandName FROM Products y WHERE x.ProductId = y.ProductId) IN ('Google', 'Apple')) >= 1)
GROUP BY ProductName
ORDER BY ProductName"
4915,3893288,"SELECT ProductName, COUNT(*)
FROM Customers NATURAL JOIN Purchases NATURAL JOIN Products
WHERE BrandName = 'Samsung' AND (FirstName LIKE 'J%' OR PhoneNumber LIKE '%4' OR CustomerId IN 
(SELECT CustomerId 
FROM Purchases NATURAL JOIN Products
WHERE BrandName = 'Apple' OR BrandName = 'Google'))
GROUP BY ProductName"
33977,3893288,"select p.ProductName, count(*)
from Purchases pu, Products p
where pu.ProductId = p.ProductId
and p.BrandName like ""Samsung%""
and (pu.CustomerId in (select CustomerId from Customers
                        where FirstName like ""J%""
                        or PhoneNumber like ""%4"")
    or
    pu.CustomerId in (select c.CustomerId from Customers c, Purchases pu, Products p
                        where c.CustomerId = pu.CustomerId
                        and pu.ProductId = p.ProductId
                        and p.BrandName in (""Apple"", ""Google""))
    )
group by p.ProductName
order by p.ProductName;"
11485,3893288,"Select p1.ProductName, count(p1.ProductId)+1
from Customers c1, Products p1
where 
   p1.ProductID in (
                                Select ProductId from Products
                                where brandName=""Samsung"")
   and
   c1.CustomerId in ( Select CustomerId from Purchases p2
                              where p1.ProductId = p2.ProductId)
    and (c1.FirstName LIKE ""J%"" 
      or MOD(c1.PhoneNumber, 10) = 4
      or c1.CustomerId in (Select p2.CustomerId 
                            from Purchases p2, Products pr2
                            where p2.ProductId = pr2.ProductId and 
                                  (pr2.BrandName = ""Apple"" or pr2.BrandName=""Google"")))
                              
   
group by p1.ProductId
order by p1.ProductName ASC"
325288,3893288,"SELECT pro.ProductName, COUNT(pur.PurchaseId)
FROM Products pro NATURAL JOIN Purchases pur
WHERE pro.BrandName = 'Samsung'
AND (pur.CustomerId IN (SELECT pu.CustomerId
                        FROM Purchases pu NATURAL JOIN Products pr
                        WHERE pr.BrandName = 'Apple' OR pr.BrandName = 'Google')
    OR pur.CustomerId IN ( SELECT c1.CustomerId
                            FROM Customers c1
                            WHERE c1.FirstName LIKE 'J%' OR c1.PhoneNumber LIKE '%4'))
GROUP BY pro.ProductName;
"
9606,3893288,"Select pr.ProductName, count(pu.PurchaseId)
From Products pr, Purchases pu
Where pr.BrandName = ""Samsung"" and pr.ProductId = pu.ProductId
and (pu.CustomerId in (Select c.CustomerId
From Customers c
Where c.FirstName = ""J%"" or c.PhoneNumber = ""%4"")
or pu.CustomerId in (Select pu1.CustomerId
From Purchases pu1
Where pu1.ProductId in (Select b.ProductId
From Products b
Where b.BrandName = ""Apple"" or b.BrandName = ""Google"")))
Group By pu.ProductId
Order By pr.ProductName"
34406,3893288,"SELECT ProductName, COUNT(*)
FROM Purchases pr JOIN Products pd
WHERE pr.ProductId = pd.ProductId
AND
(pr.CustomerId IN (SELECT CustomerId FROM Customers WHERE FirstName LIKE ""J%"" OR PhoneNumber LIKE ""%4"") 
OR pr.CustomerId IN (SELECT CustomerId FROM Purchases a JOIN Products b WHERE a.ProductId = b.ProductId AND b.BrandName IN (""Apple"", ""Google""))
)
AND pd.BrandName = ""Samsung""
GROUP BY ProductName"
36577,3893288,"SELECT ProductName, COUNT(Purchases.CustomerId)
FROM Products, Purchases, Customers
WHERE BrandName = ""Samsung"" AND Products.ProductId = Purchases.ProductId
AND Purchases.CustomerId = Customers.CustomerId 
AND (
    Customers.FirstName LIKE ""J%"" 
    OR CAST(Customers.PhoneNumber as Char) LIKE ""%4"" 
    OR Customers.CustomerId IN 
    (SELECT Purchases.CustomerId FROM Purchases WHERE Purchases.ProductId IN
        (
        SELECT Products.ProductId FROM Products WHERE BrandName = ""APPLE"" OR BrandName = ""Google""
        )
    )
)
GROUP BY ProductName
ORDER BY ProductName ASC

-- SELECT pr.ProductName, COUNT(pr.ProductName)
-- FROM(SELECT c.CustomerId
--     FROM Customers c
--     WHERE c.FirstName LIKE 'J%' 
--           OR CAST(c.PhoneNumber as Char) LIKE '%4' 
--           OR (c.CustomerId in (SELECT c.CustomerId
--                               FROM  Products pr, Purchases pu, Customers c
--                               WHERE c.CustomerId = pu.CustomerId 
--                                      and pu.ProductId = pr.ProductId 
--                                      and (pr.BrandName = 'Apple' or pr.BrandName = 'Google')
--                               )
--               )
--     )AS a, Purchases pu, Products pr
-- WHERE a.CustomerId = pu.CustomerId and pu.ProductId = pr.ProductId and pr.BrandName = 'Samsung'
-- GROUP BY pr.ProductName"
7000,3893288,"SELECT Pr.ProductName, T.CustomerCount
FROM
(
SELECT P.ProductId AS ProductId, COUNT(P.CustomerId) AS CustomerCount
FROM (Purchases P JOIN Customers C USING (CustomerId))
WHERE C.FirstName LIKE ""J%"" 
    OR C.PhoneNumber LIKE ""%4"" 
    OR EXISTS (
        (SELECT * FROM Purchases P2 NATURAL JOIN Products Pr2
         WHERE P2.CustomerId = C.CustomerId 
                AND Pr2.BrandName IN (""Apple"", ""Google""))
        )
GROUP BY P.ProductId
) T
JOIN
Products Pr
USING (ProductId)

WHERE Pr.BrandName=""Samsung"" 
ORDER BY Pr.ProductName

        -- (SELECT ProductId FROM Purchases WHERE CustomerId = C.CustomerId)
        -- INTERSECT 
        -- (SELECT ProductId FROM Products WHERE BrandName IN (""Apple"", ""Google""))
"
129745,3893288,"SELECT prod.ProductName, COUNT(pur.PurchaseId)
FROM Products prod
    NATURAL JOIN Purchases pur
    NATURAL JOIN Customers c
WHERE prod.BrandName='Samsung'
    AND (
        c.PhoneNumber LIKE ""%4""
        OR c.FirstName LIKE ""j%""
        OR c.CustomerId IN (
            SELECT pur2.CustomerId
            FROM Purchases pur2
            NATURAL JOIN Products prod2
            WHERE prod2.BrandName = ""apple""
                OR prod2.BrandName = ""google""
        )
    )
GROUP BY prod.ProductId
ORDER BY prod.ProductName;"
331824,3893288,"SELECT ProductName, count(Customers.CustomerId)
FROM  Customers  NATURAL JOIN Purchases 
                 NATURAL JOIN Products 
                 NATURAL JOIN Brands 
WHERE Products.BrandName = 'Samsung'  AND (FirstName LIKE 'J%' 
                                OR PhoneNumber LIKE '%4'
                                OR Purchases.CustomerId IN (
                                  SELECT Purchases.CustomerId
                                  FROM Purchases NATURAL JOIN Products 
                                  WHERE Products.BrandName = 'Apple' OR Products.BrandName = 'Google'))
                                  GROUP BY Products.ProductId
                                  ORDER BY ProductName"
31817,3893288,"SELECT ProductName, COUNT(Pu.CustomerId)
FROM Customers C, Purchases Pu JOIN Products P ON Pu.ProductId = P.ProductId
WHERE C.CustomerId = Pu.CustomerId AND P.BrandName = 'Samsung' AND (FirstName LIKE 'J%' OR PhoneNumber LIKE '%4' OR Pu.CustomerId IN
    (SELECT CustomerID
    FROM Purchases Pu NATURAL JOIN Products P
    WHERE BrandName = 'Apple' OR BrandName = 'Google'))
GROUP BY Pu.ProductId
ORDER BY ProductName;"
33147,3893288,"SELECT p1.ProductName, count(*)
FROM Products p1 NATURAL JOIN Purchases NATURAL JOIN Customers c1
WHERE
(c1.FirstName LIKE ""J%"" OR c1.PhoneNumber LIKE ""%4"" OR c1.CustomerId IN (SELECT CustomerId FROM (Customers NATURAL JOIN Purchases NATURAL JOIN Products) WHERE BrandName = ""Google"" OR BrandName = ""Apple"")) AND p1.BrandName = ""Samsung""

GROUP BY p1.ProductName
ORDER BY p1.ProductName
"
317203,3893288,"select distinct ProductName, count(*)
from Products Natural Join Purchases p
where BrandName = ""Samsung"" and ((CustomerId = any (select CustomerId from Customers where (FirstName like 'J%' or PhoneNumber like '%4'))) or (CustomerId = any (select CustomerId from Purchases where ProductId = any(select ProductId from Products where BrandName = ""Apple"" or ""Google""))))
group by ProductName
order by ProductName
;"
331548,3893288,"select sc.ProductName, count(sc.customerId)

from (select customerId, pr.ProductName
from Purchases pu join Products pr
on pu.ProductId = pr.ProductId 
where pr.BrandName = ""Samsung"") as sc

where sc.customerId in 
(select customerId
from Purchases pu join Products pr
on pu.ProductId = pr.ProductId
where pr.BrandName = ""Apple"" or pr.BrandName = ""Google"")

or sc.customerId in 
(select customerId
from Customers
where FirstName like ""J%""
or PhoneNumber like ""%4"")

group by sc.ProductName
order by sc.ProductName"
11481,3893288,"Select Prod.ProductName, (Select Count(C.CustomerId) From Purchases Pur
                        Join Customers C on C.CustomerId = Pur.CustomerId
                        Join Products Pr on Pr.ProductId = Pur.ProductId
                        Where (C.FirstName like 'J%' Or C.PhoneNumber%10 = 4 or (C.CustomerId in (
                        Select Pu.CustomerId From Purchases Pu Join Products Pr On Pu.ProductId = Pr.ProductId Where (Pr.BrandName = 'Apple' or Pr.BrandName = 'Google'))))and Prod.ProductId = Pur.ProductId) as a
From Products Prod
Where (Prod.BrandName = 'Samsung')
having a > 0
Order by Prod.ProductName Asc;"
33032,3893288,"Select p.ProductName, (Select Count(c.customerid)
From Purchases pu, Customers c
Where pu.ProductID = p.productID && c.customerid = pu.customerid && (c.Firstname LIKE 'J%' OR c.phoneNumber LIKE '%4' OR Exists (Select* 
From Purchases p2,Products p3
Where p2.Customerid = c.customerid && p2.productid = p3.productid && (p3.Brandname = 'Apple' OR  p3.Brandname = 'Google'))
) 
)AS sub1
From Products p
Where p.BrandName = 'Samsung'

Order by p.ProductName
"
131447,3893288,"SELECT Products.ProductName, COUNT(Purchases.CustomerId)
FROM Products
JOIN Purchases ON Purchases.ProductId = Products.ProductId
JOIN Customers ON Customers.CustomerId = Purchases.CustomerId
WHERE Products.BrandName = ""Samsung"" AND 
    (Customers.FirstName LIKE ""J%"" OR
    MOD(Customers.PhoneNumber, 10) = 4 OR 
    Customers.CustomerId IN (
        SELECT Customers.CustomerId 
        FROM Customers
        JOIN Purchases ON Customers.CustomerId = Purchases.CustomerId
        JOIN Products ON Purchases.ProductId = Products.ProductId
        WHERE Products.BrandName LIKE ""Google"" OR Products.BrandName LIKE ""Apple""))
GROUP BY Products.ProductName"
34549,3893288,"SELECT ProductName, COUNT(ProductName)
FROM Purchases, Products
WHERE Purchases.ProductId = Products.ProductId
    AND Products.BrandName = ""Samsung""
    AND (
        Purchases.CustomerId IN (
            SELECT CustomerId
            FROM Purchases
            WHERE ProductId IN (
                SELECT ProductId
                FROM Products
                WHERE BrandName = ""Apple"" OR BrandName = ""Google""
    )
        )
        OR
        Purchases.CustomerId IN (
            SELECT CustomerId
            FROM Customers
            WHERE FirstName LIKE ""J%"" OR PhoneNumber LIKE ""%4""
        )
    )
GROUP BY Products.ProductId, ProductName
ORDER BY ProductName"
32845,3893288,"SELECT ProductName, NumBuyers
FROM Products, (
                SELECT ProductId, COUNT(*) AS NumBuyers
                FROM Purchases NATURAL JOIN Customers 
                WHERE Customers.FirstName LIKE 'J%' OR Customers.PhoneNumber LIKE '%4' OR Customers.CustomerId IN (SELECT CustomerId FROM Purchases NATURAL JOIN Products WHERE BrandName = 'Apple' OR BrandName = 'Google')
                GROUP BY ProductId
               ) AS ConditionalProductTally
WHERE Products.ProductId = ConditionalProductTally.ProductId AND Products.BrandName = 'Samsung'
ORDER BY ProductName ASC;"
128458,3893288,"SELECT Products.ProductName, COUNT(Products.ProductName)
FROM Customers c
INNER JOIN Purchases
ON c.CustomerId = Purchases.CustomerId
INNER JOIN Products
ON Products.ProductId = Purchases.ProductId
INNER JOIN Brands
ON Brands.BrandName = Products.BrandName
WHERE Brands.BrandName = ""Samsung"" 
AND (c.FirstName LIKE ""J%""
OR CAST(c.PhoneNumber as CHAR) LIKE ""%4.0""
OR EXISTS(SELECT * FROM Customers 
INNER JOIN Purchases
ON Customers.CustomerId = Purchases.CustomerId
INNER JOIN Products
ON Products.ProductId = Purchases.ProductId
WHERE (Products.BrandName = ""Apple"" OR Products.BrandName = ""Google"") AND (c.CustomerId = Customers.CustomerId)))
GROUP BY Products.ProductName
ORDER BY Products.ProductName ASC"
34603,3893288,"SELECT pr.ProductName, COUNT(c.CustomerId)
FROM Purchases p JOIN Customers c ON p.CustomerId = c.CustomerId JOIN Products pr ON pr.ProductId = p.ProductId
WHERE pr.BrandName = ""SamSung""
      AND
    (  
        (
        /*who purchase samsung products*/
      c.CustomerId IN (SELECT CustomerId 
                        FROM Purchases 
                        WHERE ProductId IN (SELECT ProductId FROM Products WHERE BrandName = ""Samsung"")
                        )
                        
      AND ((c.CustomerId IN (SElECT CustomerId FROM Customers WHERE FirstName LIKE 'j%' OR PhoneNumber LIKE '%4')
          ) OR (c.CustomerId IN (SELECT CustomerId 
                                FROM Purchases 
                                WHERE ProductId IN (SELECT ProductId FROM Products WHERE BrandName IN (""Apple"", ""Google""))
                                )
                )
            )
        ) 
      
    )
GROUP BY pr.ProductName
ORDER BY pr.ProductName
        
    
    
    
   

 
        


"
34415,3893288,"select a.ProductName, count(*)
from Products a, Purchases b
where a.BrandName = ""Samsung""
    and a.ProductId = b.ProductId

and ((b.CustomerId in (select x.CustomerId 
    from Customers x where x.FirstName like ""J%""))
or (b.CustomerId in (select x.CustomerId 
    from Customers x where x.PhoneNumber like ""%4""))
or (b.CustomerId in (select x.CustomerId 
    from Customers x, Purchases b, Products a
            where b.CustomerId = x.CustomerId
                and b.ProductId = a.ProductId
                        and (a.BrandName = ""Apple"" or a.BrandName = ""Google"")))

)

group by a.ProductName"
5749,3893288,"SELECT prod1.ProductName, COUNT(prod1.ProductID)
FROM Purchases pur1
JOIN Products prod1 ON pur1.ProductId = prod1.ProductId
JOIN Customers c1 ON c1.CustomerId = pur1.CustomerId
WHERE prod1.BrandName = ""Samsung"" AND (pur1.CustomerId IN
(SELECT c.CustomerId
FROM Customers c
WHERE c.FirstName LIKE ""J%"" OR
c.PhoneNumber LIKE ""%4"" OR
EXISTS(
SELECT *
FROM Purchases pur2
JOIN Products prod2
WHERE pur2.CustomerId = c.CustomerId AND (
prod2.BrandName = ""Apple"" OR
prod2.BrandName = ""Google""))) )
GROUP BY prod1.ProductID
ORDER BY prod1.ProductName
"
127187,3893288,"SELECT ProductName, COUNT(Purchases.PurchaseId)
FROM Products JOIN Purchases ON Purchases.ProductId = Products.ProductId JOIN Customers ON Customers.CustomerId
= Purchases.CustomerId
WHERE BrandName = ""Samsung"" AND (Customers.FirstName LIKE ""J%"" OR Customers.PhoneNumber = ""%4"" OR Customers.CustomerId IN (SELECT Customers.CustomerId FROM Products JOIN Purchases ON Purchases.ProductId = Products.ProductId JOIN Customers ON Customers.CustomerId
= Purchases.CustomerId WHERE Products.BrandName = ""Google"" OR Products.BrandName=""Apple"" GROUP BY Customers.CustomerId))
GROUP BY ProductName
ORDER BY ProductName;"
34602,3893288,"SELECT ProductName, COUNT(p1.CustomerId)
FROM Purchases p1
NATURAL JOIN Customers c
NATURAL JOIN Products p2
NATURAL JOIN Brands b
WHERE b.BrandName = 'Samsung' AND (c.FirstName LIKE 'J%' OR c.PhoneNumber LIKE '%4' OR CustomerId IN
(SELECT CustomerId
FROM Customers c
NATURAL JOIN Products p2
WHERE p2.BrandName = 'Apple' OR 'Google')
)
GROUP BY ProductName
ORDER BY ProductName;"
308057,3893288,"SELECT ProductName, COUNT(*)
FROM Customers NATURAL JOIN Purchases NATURAL JOIN Products
WHERE BrandName = ""Samsung"" AND (FirstName LIKE ""J%"" OR PhoneNumber % 10 = 4 OR
CustomerId IN (SELECT CustomerId FROM Customers NATURAL JOIN Purchases NATURAL JOIN Products WHERE BrandName IN (""Apple"", ""Google"")))
GROUP BY ProductId
ORDER BY ProductName
"
36304,3893288,"Select pro.ProductName, count(*)
from Customers c join Purchases pur on c.CustomerID = pur.CustomerID join Products pro
on pro.ProductID = pur.ProductID
where (pro.BrandName = ""Samsung"") AND (c.FirstName LIKE 'J%' OR c.PhoneNumber LIKE '%4' 
OR EXISTS(
    Select *
    from Products as p2
    inner join Purchases p3
    on p3.ProductID = p2.ProductID
    where c.CustomerID = p3.CustomerID AND (p2.BrandName = ""Apple"" OR p2.BrandName = ""Google"")
))
group by pro.ProductName"
126177,3893288,"Select ans.ProductName, count(ans.Productname)        
From (Select distinct samsungBuyers.ProductName, samsungBuyers.CustomerId, samsungBuyers.PurchaseId
    From (Select distinct cu.CustomerId
        From ((Products po inner join Purchases pu on po.ProductId = pu.ProductId) inner join Customers cu on cu.CustomerId = pu.CustomerId) 
        Where ( po.BrandName = ""Apple"" or po.BrandName = ""Google"" )
        order by cu.CustomerId) agBuyers,
        
        (Select distinct cu.CustomerId, cu.FirstName, cu.PhoneNumber, po.ProductName, pu.PurchaseId
        From ((Products po inner join Purchases pu on po.ProductId = pu.ProductId) inner join Customers cu on cu.CustomerId = pu.CustomerId) 
        Where ( po.BrandName = ""Samsung"")
        order by cu.CustomerId) samsungBuyers,
        
        (Select CustomerId
        From Customers
        Where Firstname like ""J%"" or PhoneNumber like ""%4"") nameMatches
    Where samsungBuyers.CustomerId = agBuyers.CustomerId or samsungBuyers.FirstName Like ""J%"" or samsungBuyers.PhoneNumber Like ""%4"") ans
Group by ans.ProductName"
318960,3893288,"SELECT DISTINCT ProductName,COUNT(CustomerId)
FROM Purchases NATURAL JOIN Products
WHERE BrandName='Samsung' AND 
    ((CustomerId IN (SELECT DISTINCT CustomerId    FROM Customers  WHERE FirstName='J%')) 
    OR (CustomerId IN (SELECT DISTINCT CustomerId   FROM Customers  WHERE PhoneNumber='%4')) 
    OR 
    (CustomerId IN (SELECT DISTINCT P.CustomerId     
        FROM Purchases P
        WHERE EXISTS(SELECT *
                     FROM Products NATURAL JOIN Brands
                     WHERE P.ProductId=ProductId AND (BrandName='Apple'OR BrandName='Google')))
                     ))
GROUP BY ProductName
ORDER BY ProductName;"
30205,3893288,"SELECT subq.ProductName, COUNT(*)
FROM (SELECT custs.FirstName, Products.ProductName
FROM Purchases
INNER JOIN Products ON Purchases.ProductId=Products.ProductId
INNER JOIN (SELECT *
	FROM Customers
	WHERE Customers.FirstName=""J%"" OR Customers.PhoneNumber % 10 = 4
	UNION 
	SELECT Customers.CustomerId, Customers.FirstName, Customers.LastName, Customers.PhoneNumber
	FROM Customers
	INNER JOIN Purchases ON Customers.CustomerId = Purchases.CustomerId 
	INNER JOIN Products ON Purchases.ProductId = Products.ProductId
	WHERE Products.BrandName=""Apple"" OR Products.BrandName=""Google"") as custs 
ON Purchases.CustomerId=custs.CustomerId
WHERE Products.BrandName = ""Samsung"") as subq
GROUP BY subq.ProductName"
12098,3893288,"SELECT samsung.ProductName, count(*)
FROM 
    
    ((SELECT cu.CustomerId
    FROM Customers cu
    WHERE cu.FirstName LIKE ""J%"" OR cu.PhoneNumber LIKE ""%4"") 
    
    UNION
    
    (SELECT pu.CustomerId
    FROM Purchases pu JOIN Products pr ON pu.ProductId = pr.ProductId
    WHERE pr.BrandName = ""Apple"" OR pr.BrandName = ""Google"")) other 

    JOIN
   
    (SELECT pu.CustomerId, pu.ProductId, pr.ProductName
    FROM Purchases pu JOIN Products pr ON pu.ProductId = pr.ProductId
    WHERE pr.BrandName = ""Samsung"") samsung
    
    ON samsung.CustomerId = other.CustomerId
GROUP BY samsung.ProductName; 


"
186896,3893288,"SELECT pt.ProductName, COUNT(*)
FROM Customers c NATURAL JOIN Purchases pr NATURAL JOIN Products pt
WHERE (pt.BrandName = 'Samsung') AND ((c.FirstName LIKE 'J%') OR (c.PhoneNumber LIKE '%4')  OR (EXISTS(SELECT * 
            FROM Customers c2 NATURAL JOIN Purchases pr2 NATURAL JOIN Products pt2 
            WHERE (pt2.BrandName = 'Apple') AND (c2.CustomerId = c.CustomerId))) OR (EXISTS(
            SELECT *
            FROM Customers c2 NATURAL JOIN Purchases pr2 NATURAL JOIN Products pt2 
            WHERE (pt2.BrandName = 'Google') AND (c2.CustomerId = c.CustomerId))))
GROUP BY pt.ProductName, pt.BrandName
ORDER BY pt.ProductName"
83742,3893288,"SELECT prod.ProductName, COUNT(c.CustomerID)
FROM Products prod
JOIN Purchases pur ON prod.ProductId = pur.ProductId
JOIN Customers c ON pur.CustomerId = c.CustomerId
WHERE prod.BrandName = 'Samsung' AND (c.FirstName LIKE 'J%' 
OR c.PhoneNumber LIKE '%4' 
OR c.CustomerId IN (
SELECT p.CustomerId
FROM Purchases p
JOIN Products prod ON p.ProductId = prod.ProductId
WHERE prod.BrandName = 'Apple' OR prod.BrandName = 'Google'
GROUP BY p.CustomerId
)
)
GROUP BY ProductName
ORDER BY prod.ProductName ASC
;
"
38711,3893288,"SELECT ProductName, COUNT(CustomerId)
FROM Purchases Pur NATURAL JOIN Customers C NATURAL JOIN Products Pro

WHERE (BrandName = 'Samsung' AND 
    (FirstName Like 'J%'
    OR PhoneNumber Like '%4'
    OR CustomerId IN 
                    (SELECT CustomerId
                    FROM Purchases Pur NATURAL JOIN Customers C NATURAL JOIN Products Pro
                    WHERE Pur.ProductId=Pro.ProductId AND 
                    (Pro.BrandName='Apple' OR Pro.BrandName='Google'))
    ))

GROUP BY ProductName
ORDER BY ProductName
"
33334,3893288,"select Products.ProductName, count(*)

FROM Products,Customers,Purchases
WHERE (Products.BrandName = 'Samsung') AND (Customers.CustomerId = Purchases.CustomerId) AND (Purchases.ProductId = Products.ProductId) AND
Customers.FirstName IN (SELECT DISTINCT FirstName
                  FROM Customers c, Purchases p1, Products p2
                  WHERE (c.FirstName LIKE 'J%') OR (c.PhoneNumber LIKE '%4') OR ((p2.BrandName = 'Apple' OR p2.BrandName='Google') AND (c.CustomerId = p1.CustomerId AND p1.ProductId = p2.ProductId) ))

GROUP BY Products.ProductName

"
336531,3893288,"Select p2.ProductName, count(*) from Purchases p1 join Products p2 
on p1.ProductId = p2.ProductId
where p2.BrandName='Samsung' and p1.CustomerId in 
(
Select Customers.CustomerId from 
Customers join Purchases join Products 
on Customers.CustomerId = Purchases.CustomerId and Products.ProductId = Purchases.ProductId
where Customers.FirstName like 'J%' or Customers.PhoneNumber='%4' or Products.BrandName='Apple' or 
Products.BrandName='Google')
group by p1.ProductId
order by p2.ProductName"
331920,3893288,"SELECT ProductName, COUNT(QualifiedCustomers.CustomerId)
FROM

(SELECT DISTINCT c.CustomerId FROM Purchases pur, Customers c, Products pr WHERE c.CustomerId = pur.CustomerId AND pr.ProductId = pur.ProductId AND (c.FirstName LIKE ""J%"" OR c.PhoneNumber LIKE ""%4"" OR pr.BrandName = ""Apple"" OR pr.BrandName = ""Google"")) AS QualifiedCustomers, Purchases pp, Products prr

WHERE prr.BrandName = ""Samsung"" AND QualifiedCustomers.CustomerId = pp.CustomerId AND pp.ProductId = prr.ProductId
GROUP BY ProductName
ORDER BY ProductName"
6193,3893288,"select a.ProductName, count(1) from Customers c join (select p.CustomerId, pr.ProductName from Purchases p join Products pr on p.ProductId = pr.ProductId where p.ProductId in (select ProductId from Products where BrandName = ""Samsung"")) a on c.CustomerId = a.CustomerId where c.FirstName like ""J%"" or c.PhoneNumber like ""%4"" or c.CustomerId in (select distinct p.CustomerId from Purchases p where p.ProductId in ( select ProductId from Products where BrandName in (""Apple"",""Google""))) group by c.CustomerId,a.ProductName"
35368,3893288,"SELECT p1.ProductName, count(*)
FROM Products p1, Purchases
WHERE p1.BrandName = ""Samsung""
AND Purchases.ProductId = p1.ProductId
AND (
    EXISTS (
        SELECT CustomerId
        FROM Customers
        WHERE Customers.CustomerId = Purchases.CustomerId
        AND Customers.FirstName LIKE 'J%' OR MOD(Customers.PhoneNumber, 10) = 4
    )
    OR EXISTS (
        SELECT Products.ProductId
        FROM Products
        JOIN Purchases p2 ON p2.ProductId = Products.ProductId
        WHERE Purchases.CustomerId = p2.CustomerId
        AND Products.BrandName in (""Apple"", ""Google"")
    )
)
GROUP BY ProductName"
35801,3893288,"select Products.ProductName, count(*)
from Customers
inner join Purchases on Purchases.CustomerId=Customers.CustomerId 
inner join Products on Products.BrandName='Samsung' and Products.ProductId=Purchases.ProductId and (Customers.FirstName like 'J%' or Customers.PhoneNumber like '%4' 
or exists(
        select * 
        from Products p 
        inner join Purchases pur on p.ProductId=pur.ProductId
        where Customers.CustomerId=pur.CustomerId and p.BrandName in ('Apple', 'Google')
        group by ProductName
    )
)
group by ProductName
order by ProductName;"
5498,3893288,"SELECT pro.ProductName, COUNT(c.CustomerId)
FROM Products pro
INNER JOIN Purchases pur ON pro.ProductId = pur.ProductId
INNER JOIN Customers c ON pur.CustomerId = c.CustomerId
WHERE (pro.BrandName = 'SAMSUNG') AND  (
    (c.FirstName LIKE 'J%') OR
    (c.PhoneNumber LIKE '%4') OR
    exists (
        SELECT * FROM Products pro2
        INNER JOIN Purchases pur2 ON pro2.ProductId = pur2.ProductId
        INNER JOIN Customers c2 ON pur2.CustomerId = c2.CustomerId
        WHERE c2.CustomerId = c.CustomerId AND (
            (pro2.BrandName = 'Apple') OR (pro2.BrandName = 'Google')
        )
    )
)
GROUP BY pro.ProductName
ORDER BY pro.ProductName;
"
34712,3893288,"select distinct
    pr.ProductName, cond.cnt
from
    (Purchases pu, Products pr)
inner join
(select
    count(*) cnt, pu.ProductId pid
from
    Purchases pu, Products pr, Customers c
where ((pr.BrandName = 'Samsung' and pu.ProductId = pr.ProductId and c.CustomerId = pu.CustomerId)
    and (
        (c.FirstName like 'J%' and c.CustomerId = pu.CustomerId)
        or (c.PhoneNumber like '%4' and c.CustomerId = pu.CustomerId)
        or (pu.CustomerId in (
            select
                pu.CustomerId
            from
                Purchases pu, Products pr
            where (pu.ProductId = pr.ProductId and pr.BrandName in (""Apple"", ""Google""))
            ))
        )
    )
group by pu.ProductId) cond
on cond.pid = pr.ProductId
where pr.ProductId = cond.pid
order by pr.ProductName"
5467,3893288,"select prod.ProductName, (
    select count(cust.CustomerId)
    from Purchases purch
    join Customers cust 
    on (purch.CustomerId = cust.CustomerId)
    where (purch.ProductId=prod.ProductId) and
    (cust.PhoneNumber%10=4 or 
    cust.FirstName LIKE ""J%"" or
    (cust.CustomerId in (
        select purch_2.CustomerId
        from Purchases purch_2
        join Products Pro
        on (Pro.ProductId = purch_2.ProductId)
        where Pro.BrandName=""Google"" or
        Pro.BrandName=""Apple"" )))) as num
from Products prod
where prod.BrandName = ""Samsung""
order by prod.ProductName asc;"
313229,3893288,"select pd.ProductName, Count(c.CustomerId)
from Purchases pc join Products pd on pc.ProductId = pd.ProductId join Customers c on pc.CustomerId = c.CustomerId
where pd.BrandName = 'Samsung'and (c.FirstName like 'J%' or CAST(c.PhoneNumber as CHAR) like '%4' or  c.CustomerId in (select pc2.CustomerId from Products pd2 join Purchases pc2 on pd2.ProductId = pc2.ProductId where pd2.BrandName = 'Apple' or pd2.BrandName = 'Google'))
group by pd.ProductId
order by pd.ProductName"
310293,3893288,"select ProductName, count(Customers.CustomerId) from (Purchases left join Customers on Purchases.CustomerId = Customers.CustomerId)
    left join Products on Purchases.ProductId = Products.ProductId
    left join Brands B on Products.BrandName = B.BrandName
    where B.BrandName = 'Samsung' and ((FirstName like 'J%') or (PhoneNumber like '%4')
       or Customers.CustomerId in
          (select CustomerId from Purchases left join Products P on Purchases.ProductId = P.ProductId
            where P.BrandName = 'Google' or P.BrandName = 'Apple')) group by Purchases.ProductId order by ProductName;"
5739,3893288,"SELECT Products.ProductName, COUNT(Customers.CustomerId)
FROM ((Products
INNER JOIN Purchases ON Products.ProductId = Purchases.ProductId)
INNER JOIN Customers ON Purchases.CustomerId = Customers.CustomerId)
#made by samsun
WHERE Products.BrandName = 'Samsung' AND (
    #starts with J
    Customers.FirstName LIKE 'J%'
    OR
    #phone number ends w 4
    Customers.PhoneNumber LIKE '%4'
    OR
    #also purchased apple or google product
    Customers.CustomerId IN (
    #returns list of customers who have bought google or apple products
        SELECT Customers.CustomerId
    FROM ((Products
    INNER JOIN Purchases ON Products.ProductId = Purchases.ProductId)
    INNER JOIN Customers ON Purchases.CustomerId = Customers.CustomerId)
    WHERE BrandName = 'Google' OR BrandName = 'Apple')
    )
GROUP BY Products.ProductName
ORDER BY Products.ProductName"
32969,3893288,"select Products.ProductName, count(Customers.CustomerId)
from Customers join Purchases on Purchases.CustomerId = Customers.CustomerId
join Products on Purchases.ProductId = Products.ProductId
where Products.BrandName = 'Samsung' and (Customers.FirstName like 'J%' or Customers.PhoneNumber like '%4' or exists(select * from Products join Purchases on Products.ProductId = Purchases.ProductId where Customers.CustomerId = Purchases.CustomerId and (Products.BrandName = 'Apple' or Products.BrandName = 'Google')))
group by Products.ProductId
order by Products.ProductName;"
4397,3893288,"SELECT Ps.ProductName, (SELECT count(C.CustomerId)
FROM Purchases P
JOIN Customers C ON (P.CustomerId = C.CustomerId)
WHERE (P.ProductId=Ps.ProductId) AND (C.FirstName LIKE ""J%"" OR C.PhoneNumber%10=4 OR (C.CustomerId IN 
    (
        SELECT purch.CustomerId
        FROM Purchases purch
        JOIN Products Pro ON (Pro.ProductId = purch.ProductId)
        WHERE Pro.BrandName=""Google"" OR Pro.BrandName=""Apple"" )))) as cnt
FROM Products Ps
WHERE Ps.BrandName = ""Samsung""
HAVING cnt > 0
ORDER BY Ps.ProductName;"
33861,3893288,"SELECT ProductName, COUNT(*)
FROM Products
JOIN Purchases ON Purchases.ProductId = Products.ProductId
WHERE Products.BrandName = ""Samsung"" 
AND ( 
    EXISTS (
        SELECT CustomerId
        FROM Customers
        WHERE Customers.CustomerId = Purchases.CustomerId AND (Customers.FirstName LIKE 'J%' OR MOD(Customers.PhoneNumber, 10) = 4)
    )
    OR (
        EXISTS (
            SELECT Products.ProductId
            FROM Products
            JOIN Purchases p2 ON p2.ProductId = Products.ProductId
            WHERE Purchases.CustomerId = p2.CustomerId
            AND Products.BrandName in (""Apple"", ""Google"")
        
        ) 
    )
)
GROUP by ProductName
ORDER by ProductName"
202279,3893288,"SELECT ProductName, COUNT(CustomerId)
FROM Products NATURAL JOIN Purchases
WHERE BrandName = 'Samsung' AND (CustomerId IN
(
SELECT DISTINCT CustomerId
FROM Customers
WHERE FirstName LIKE 'J%' OR PhoneNumber LIKE '%4'
)
OR CustomerId IN
(
SELECT DISTINCT CustomerId
FROM Purchases NATURAL JOIN Products
WHERE BrandName = 'Apple' OR BrandName = 'Google'
))
GROUP BY ProductId
ORDER BY ProductName"
126834,3893288,"SELECT ProductName, COUNT(CustomerId)
FROM Products NATURAL JOIN (Purchases NATURAL JOIN Customers)
WHERE BrandName = 'Samsung' AND (
    CustomerId IN (SELECT CustomerId 
        FROM Products NATURAL JOIN (Purchases NATURAL JOIN Customers) 
        WHERE BrandName = 'Apple' OR BrandName = 'GOOGLE') 
    OR MOD(PhoneNumber, 10) = 4.0 OR FirstName LIKE 'J%')
GROUP BY ProductName
ORDER BY ProductName"
7926,3893288,"select ProductName, count(ProductName) from Purchases
left join Products on Purchases.ProductId = Products.ProductId
where BrandName = ""Samsung"" and CustomerId in 
(select Customers.CustomerId as CustomerId from Purchases
left join Customers on Purchases.CustomerId = Customers.CustomerId
left join Products on Purchases.ProductId = Products.ProductId
where BrandName = ""Apple"" or BrandName = ""Google"" or
substring(Customers.FirstName, 1, 1) = ""J"" or
Customers.PhoneNumber % 10 = 4)
group by ProductName"
36316,3893288,"SELECT DISTINCT ProductName AS pn, COUNT(pur.CustomerId)
FROM (Purchases pur JOIN Products pro ON pur.ProductId = pro.ProductId) JOIN Customers cus ON pur.CustomerId = cus.CustomerId
WHERE pro.BrandName = 'Samsung' AND (cus.FirstName LIKE 'J%' OR MOD(cus.PhoneNumber, 10) = 9 OR EXISTS(SELECT p.CustomerId AS cid FROM Purchases p JOIN Products pr ON p.ProductId = pr.ProductId WHERE p.CustomerId = pur.CustomerId AND (pr.BrandName = 'Apple' OR pr.BrandName = ""Google"")))
GROUP BY pur.ProductId
ORDER BY ProductName;"
31860,3893288,"select Products.ProductName, count(*) from Purchases left join Products on Products.ProductId = Purchases.ProductId where CustomerId in (

select Customers.CustomerId from Customers left outer join Purchases on Purchases.CustomerId = Customers.CustomerId left join Products on Products.ProductId = Purchases.ProductId where (FirstName like ""J%"") or (PhoneNumber % 10 = 4) or (BrandName in (""Apple"", ""Google""))

) and Products.BrandName = ""Samsung"" group by Products.ProductName, CustomerId"
34139,3893288,"SELECT Products.ProductName, COUNT(*) 
FROM Customers
JOIN Purchases ON Customers.CustomerId = Purchases.CustomerId
JOIN Products ON Purchases.ProductId = Products.ProductId
WHERE Products.BrandName = 'Samsung' 
AND (Customers.FirstName LIKE 'J%' 
OR Customers.PhoneNumber LIKE '%4' 
OR EXISTS (SELECT * FROM Products JOIN Purchases ON Purchases.ProductId = Products.ProductId WHERE Customers.CustomerId = Purchases.CustomerId AND (Products.BrandName = 'Apple' OR Products.BrandName = 'Google')))
GROUP BY Products.ProductId
ORDER BY Products.ProductName;"
33326,3893288,"SELECT ProductName, COUNT(CustomerId)
    FROM Customers NATURAL JOIN Purchases NATURAL JOIN Products
    WHERE BrandName = ""Samsung"" AND (FirstName LIKE ""J%"" OR PhoneNumber LIKE ""%4"" OR CustomerId IN (
            SELECT CustomerId
                FROM Purchases NATURAL JOIN Products
                WHERE BrandName = ""Apple"" OR BrandName = ""Google""
        ))
    GROUP BY ProductName
    ORDER BY ProductName"
36288,3893288,"SELECT prod.ProductName, COUNT(*)
FROM Purchases pur JOIN Products prod on pur.ProductId = prod.ProductId 
JOIN Customers cust on cust.CustomerId = pur.CustomerId
where prod.BrandName = 'Samsung' 
    AND (LEFT(cust.FirstName, 1) = 'J' 
    OR RIGHT(cust.PhoneNumber, 1) = 4
    OR cust.CustomerId in (
        SELECT pur.CustomerId 
        FROM Purchases pur JOIN Products prod on pur.ProductId = prod.ProductId
        where prod.BrandName = 'Google' or prod.BrandName = 'Apple'
    ))
GROUP BY prod.ProductName;"
33496,3893288,"SELECT ProductName, COUNT(ProductName)
FROM Products
JOIN Purchases ON Products.ProductId = Purchases.ProductId
WHERE BrandName = ""Samsung"" AND Purchases.CustomerId IN (
    SELECT CustomerId
    FROM Customers
    WHERE FirstName LIKE ""J%"" OR PhoneNumber LIKE ""%4""
)
GROUP BY ProductName
ORDER BY ProductName;
"
34474,3893288,"SELECT DISTINCT pr.ProductName, count(c.CustomerId) from Customers c NATURAL JOIN Purchases pu NATURAL JOIN Products pr
WHERE pr.BrandName = 'Samsung' 
AND (c.FirstName LIKE 'J%' OR c.PhoneNumber LIKE '%4' OR (SELECT DISTINCT count(*) from Customers c1 NATURAL JOIN Purchases pu1 NATURAL JOIN Products pr1 WHERE (pr1.BrandName = 'Apple' or pr1.BrandName = 'Google') AND c1.CustomerId = c.CustomerId) > 0) 

GROUP BY pr.ProductName
ORDER BY ProductName ASC"
5259,3893288,"SELECT ProductName, count(CustomerId)
FROM Purchases NATURAL JOIN Products
WHERE BrandName = 'Samsung' AND CustomerId IN (SELECT CustomerId FROM Customers WHERE FirstName LIKE 'J%' OR MOD(PhoneNumber, 10) = 4 OR CustomerId In (SELECT DISTINCT CustomerId FROM Purchases NATURAL JOIN Products WHERE BrandName = 'Apple' OR BrandName = 'Google'))
GROUP BY ProductName 
ORDER BY ProductName ASC;"
5265,3893288,"SELECT p1.ProductName, COUNT(c1.CustomerId)
FROM Customers c1
NATURAL JOIN Purchases pc1
NATURAL JOIN Products p1
WHERE p1.BrandName = 'Samsung'
AND (c1.FirstName LIKE 'J%' OR c1.PhoneNumber % 10 = 4
OR c1.CustomerId IN (
        SELECT DISTINCT c2.CustomerId 
        FROM Customers c2
        NATURAL JOIN Purchases pc2
        NATURAL JOIN Products p2
        WHERE p2.BrandName = 'Apple' OR p2.BrandName = 'Google'
    )
)
GROUP BY p1.ProductName
ORDER BY p1.ProductName ASC
"
5503,3893288,"SELECT XXX.ProductName, COUNT(XXX.CustomerId)
FROM (
    SELECT C1.CustomerId, Pr1.ProductId, Pr1.ProductName
    FROM Customers C1
    INNER JOIN Purchases P1 ON P1.CustomerId = C1.CustomerId
    INNER JOIN Products Pr1 ON Pr1.ProductId = P1.ProductId
    WHERE Pr1.BrandName = ""Samsung""
    AND
    (
        EXISTS (
            SELECT *
            FROM Customers C2
            INNER JOIN Purchases P2 ON P2.CustomerId = C2.CustomerId
            INNER JOIN Products Pr2 ON Pr2.ProductId = P2.ProductId
            WHERE C2.CustomerId = C1.CustomerId AND Pr2.BrandName IN (""Apple"", ""Google"")
        )
        OR C1.FirstName LIKE ""J%""
        OR C1.PhoneNumber LIKE ""%4""
    )
) XXX
GROUP BY XXX.ProductId
ORDER BY XXX.ProductName"
5271,3893288,"SELECT DISTINCT Products.ProductName, COUNT(*)
FROM Products, Purchases NATURAL JOIN Customers c
WHERE Purchases.ProductId = Products.ProductId 
    AND Products.BrandName = 'Samsung'
    AND ( (Purchases.CustomerId = c.CustomerId AND c.FirstName LIKE 'J%') OR (Purchases.CustomerId = c.CustomerId AND c.PhoneNumber % 10 = 4.0) OR (Purchases.CustomerId IN 
                                    (SELECT DISTINCT Purchases.CustomerId 
                                    FROM Purchases, Products 
                                    WHERE Purchases.ProductId = Products.ProductId AND (BrandName = 'Apple' or BrandName = 'Google') ) )
        )
GROUP BY Products.ProductName
ORDER BY Products.ProductName"
324318,3893288,"SELECT Mpd.ProductName, COUNT(Mpr.CustomerId)
FROM Products Mpd INNER JOIN Purchases Mpr ON Mpd.ProductId = Mpr.ProductId
WHERE Mpd.BrandName = 'Samsung' AND Mpr.CustomerId IN (

    SELECT c.CustomerId
    FROM Customers c INNER JOIN Purchases pr ON c.CustomerId = pr.CustomerId
    WHERE c.FirstName LIKE 'J%' OR c.PhoneNumber LIKE '%4' OR c.CustomerId IN 

        (SELECT p.CustomerId
        FROM Purchases p  INNER JOIN Products pd ON p.ProductId = pd.ProductId
        WHERE BrandName = 'Apple' OR BrandName='Google')
    )
GROUP BY (Mpd.ProductId)
ORDER BY Mpd.ProductName

;"
4769,3893288,"SELECT ProductName, COUNT(CustomerId)
FROM Customers NATURAL JOIN (SELECT CustomerId, ProductId
                             FROM Purchases
                             WHERE ProductId = ANY (SELECT ProductId 
                                                    FROM Products 
                                                    WHERE BrandName = 'Samsung')) SamsungCustomers
               NATURAL JOIN Products
WHERE FirstName = 'J%' OR 
      PhoneNumber % 10 = 4 OR 
      CustomerId = ANY(SELECT CustomerId
                       FROM Purchases
                       WHERE ProductId = ANY (SELECT ProductId 
                                              FROM Products 
                                              WHERE BrandName = 'Apple' OR 
                                                    BrandName = 'Google')) 
GROUP BY ProductName
ORDER BY ProductName"
35385,3893288,"SELECT Pro.ProductName, (SELECT COUNT(*)
FROM Purchases as Pur
WHERE Pro.ProductId = Pur.ProductId AND Pur.CustomerId IN
(SELECT Cu.CustomerId
FROM Customers as Cu
WHERE Cu.FirstName LIKE 'J%' OR Cu.PhoneNumber LIKE '%4' OR Cu.CustomerId IN
(SELECT Purr.CustomerId FROM Purchases as Purr WHERE Purr.ProductId IN
(SELECT PPP.ProductId FROM Products as PPP WHERE PPP.BrandName = 'Apple' OR PPP.BrandName = 'Google'
)))
) 
AS CCC
FROM Products as Pro
WHERE Pro.BrandName = 'Samsung'
ORDER BY Pro.ProductName"
332195,3893288,"SELECT p.ProductName, count(p.productName)
From Products p, Customers Natural Join Purchases as temp
Where BrandName = ""Samsung"" AND (p.productId = temp.ProductId AND 
                                    (FirstName LIKE ""J%"" OR PhoneNumber LIKE '%4' OR 
                                    temp.CustomerId in (Select CustomerId 
                                    From Purchases Natural Join Products 
                                    Where BrandName = ""Apple"" OR BrandName = ""Google"")
                                    )
                                )    
Group by p.ProductName"
335822,3893288,"select pro.ProductName, count(pur.CustomerId)
from Purchases as pur left join Products as pro on pur.ProductId = pro.ProductId
where pro.BrandName = ""Samsung"" and (pur.CustomerId in 
(select CustomerId from Customers where FirstName like ""J%"" or ("""" + PhoneNumber like ""%4"")) or 
pur.CustomerId in (select distinct CustomerId from Purchases left join Products on Purchases.ProductId = Products.ProductId where Products.BrandName = ""Apple"" or Products.BrandName = ""Google""))
group by pur.ProductId
order by pro.ProductName"
36117,3893288,"SELECT ProductName, COUNT(CustomerId)
FROM Products NATURAL JOIN Purchases NATURAL JOIN Customers
WHERE BrandName = 'Samsung'
    AND (FirstName LIKE 'J%' OR PhoneNumber % 10 = 4 OR CustomerId IN (
            SELECT CustomerId
            FROM Purchases NATURAL JOIN Products
            WHERE BrandName IN ('Apple', 'Google')
            )
        )
GROUP BY ProductName
ORDER BY ProductName;"
7276,3893288,"SELECT 
    ProductName, COUNT(CustomerId) AS number
FROM
    (SELECT 
        a.ProductId,
            a.ProductName,
            c.CustomerId,
            c.FirstName,
            c.LastName,
            c.PhoneNumber
    FROM
        Products a
    JOIN Purchases b
    JOIN Customers c
    WHERE
        brandname = 'Samsung'
            AND a.ProductId = b.ProductId
            AND b.CustomerId = c.CustomerId) d
WHERE
    d.FirstName LIKE 'Z%'
        OR d.PhoneNumber LIKE '%5'
        OR d.CustomerId IN (SELECT DISTINCT
            CustomerId
        FROM
            Purchases
        WHERE
            ProductId IN (SELECT 
                    ProductId
                FROM
                    Products
                WHERE
                    BrandName = 'Apple'
                        OR BrandName = 'Google'))
GROUP BY ProductName
ORDER BY ProductName



"
313213,3893288,"select ProductName, count(C.CustomerId)
from Customers C join 
        (select ProductName,CustomerId
        from Purchases P join
            (select ProductName, ProductId
            from Products
            where BrandName=""Samsung"") as T
        on T.ProductId = P.ProductId) as T1
    on C.CustomerId = T1.CustomerId
where C.FirstName like ""J%"" or C.PhoneNumber like ""%4"" or C.CustomerId in
    (select CustomerId
    from Purchases P1 join
        (select ProductId
        from Products
        where BrandName=""Apple"" or BrandName=""Google"") as T2
    on T2.ProductId = P1.ProductId)
group by ProductName
order by ProductName asc"
33331,3893288,"Select temp.ProductName, Count(temp.PurchaseId)
From (Select * 
    From Products Prod Natural Join Purchases Purch) as temp, Customers C
Where (temp.BrandName = ""Samsung"") and (C.CustomerId = temp.CustomerId) and
     (C.FirstName Like 'J%' or C.PhoneNumber Like '%4' 
        or temp.CustomerId In (Select Cus.CustomerId
                                From (Select * 
                                      From Products Prod Natural Join Purchases Purch) as temp2, Customers Cus
                                      Where (Cus.CustomerId = temp2.CustomerId) and (temp2.BrandName = ""Apple"" or temp2.BrandName = ""Google"")
                                      ))
Group By temp.ProductName
Order By temp.ProductName;
"
34476,3893288,"select tb3.ProductName, count(tb3.CustomerId) from (select PurchaseId, CustomerId, tb1.ProductId, ProductName, BrandName from (select * from Products where BrandName = 'Samsung') as tb1 join Purchases pur1 on pur1.ProductId = tb1.ProductId) as tb3 join Customers c1 on c1.CustomerId = tb3.CustomerId where (c1.FirstName like 'J%' or c1.PhoneNumber like ""%4"" or c1.CustomerId in (select tb4.CustomerId from (select pur2.ProductId, pur2.CustomerId, pro2.BrandName from Purchases pur2 join Products pro2 on pro2.ProductId = pur2.ProductId) as tb4 where tb4.BrandName = 'Apple' or tb4.BrandName = ""Google"")) group by ProductName order by tb3.ProductName "
11185,3893288,"select PR.ProductName, count(C.CustomerId)
from ((Customers C inner join Purchases PU on C.CustomerId  = PU.CustomerId) inner join Products PR on     PR.ProductId = PU.ProductId)
where PR.BrandName = 'Samsung' and (C.FirstName like 'J%' or C.PhoneNumber like '%4' 
     or exists( select PU2.CustomerId
                from  (Products PR2 inner join Purchases PU2 on PR2.ProductId = PU2.ProductId)
                where (PR2.BrandName = 'Apple' or PR2.BrandName = 'Google') 
                and C.CustomerId = PU2.CustomerId ))
group by  PR.ProductName order by  PR.ProductName;"
5460,3893288,"select Pr.ProductName, (
    select count(*)
    from Customers C Natural Join (Purchases P Natural Join Products PB)
    where P.ProductId = Pr.ProductId and (
        C.FirstName LIKE ""J%"" or
        CAST(C.PhoneNumber AS CHAR) LIKE ""%4"" or
        C.CustomerId in (
            select PA.CustomerId
            from Purchases PA Natural Join Products PrA
            where PrA.BrandName = ""Apple""
        )
        or
        C.CustomerId in (
            select PG.CustomerId
            from Purchases PG Natural Join Products PrG
            where PrG.BrandName = ""Google""
        )
    )
) as _count
from Products Pr
where Pr.BrandName = ""Samsung""
order by Pr.ProductName
"
30765,3893288,"SELECT prod1.ProductName, COUNT(*)
FROM Customers c1, Purchases purc1, Products prod1
WHERE prod1.BrandName = 'Samsung'
AND c1.CustomerId=purc1.CustomerId
AND purc1.ProductId=prod1.ProductId
AND c1.FirstName IN (   SELECT DISTINCT c2.FirstName
                    FROM Customers c2, Purchases purc2, Products prod2
                    WHERE c2.PhoneNumber LIKE'%4'
                    OR c2.FirstName LIKE 'J%'
                    OR ((prod2.BrandName='Google'
                        OR prod2.BrandName='Apple')
                        AND (c2.CustomerId=purc2.CustomerId AND purc2.ProductId=prod2.ProductId)))

GROUP BY prod1.ProductName
ORDER BY prod1.ProductName;"
33739,3893288,"SELECT ProductName, COUNT(*)
FROM Products
JOIN Purchases ON Purchases.ProductId = Products.ProductId
WHERE Products.BrandName = ""Samsung"" 
AND ( 
    EXISTS (
        SELECT CustomerId
        FROM Customers
        WHERE Customers.CustomerId = Purchases.CustomerId AND (Customers.FirstName LIKE 'J%' OR MOD(Customers.PhoneNumber, 10) = 4)
    )
    OR (
        EXISTS (
            SELECT Products.ProductId
            FROM Products
            JOIN Purchases p2 ON p2.ProductId = Products.ProductId
            WHERE Purchases.CustomerId = p2.CustomerId
            AND Products.BrandName in (""Apple"", ""Google"")
        
        ) 
    )
)
GROUP by ProductName
ORDER by ProductName"
30542,3893288,"SELECT ProductName, (
    SELECT COUNT(*) 
    FROM Customers c NATURAL JOIN Purchases NATURAL JOIN Products p2 
    WHERE p2.ProductName = p1.ProductName 
    AND (
    c.FirstName LIKE ""J%""
    OR c.PhoneNumber LIKE ""%4""
    OR c.CustomerId IN 
        (SELECT CustomerId 
        FROM Purchases 
        NATURAL JOIN Products 
        WHERE BrandName = ""Google"" OR BrandName = ""Apple"") 
    )) AS counts
FROM Products p1
WHERE p1.BrandName = ""Samsung"" 
ORDER BY ProductName"
32963,3893288,"SELECT P3.ProductName, COUNT(P3.ProductId)
FROM Customers C2 JOIN Purchases P2 ON C2.CustomerId = P2.CustomerId JOIN Products P3 ON P3.ProductId = P2.ProductId
WHERE P3.BrandName = 'Samsung' AND (C2.FirstName LIKE 'J%' OR C2.PhoneNumber % 10 = 4 OR C2.CustomerId = ANY(SELECT C4.CustomerId
FROM Customers C4 JOIN Purchases P5 ON C4.CustomerId = P5.CustomerId JOIN Products P6 ON P6.ProductId = P5.ProductId
WHERE P6.BrandName = 'Apple' OR P6.BrandName = 'Google'))
GROUP BY P3.ProductId
ORDER BY P3.ProductName;"
5726,3893288,"SELECT DISTINCT pr.ProductName, COUNT(pu.CustomerId)
FROM Customers c, Products pr, Purchases pu
WHERE pr.BrandName = 'Samsung'
AND pu.ProductId = pr.ProductId
AND c.CustomerId = pu.CustomerId
AND (c.FirstName LIKE 'J%'
    OR c.PhoneNumber LIKE '%4.0'
    OR pu.CustomerId in  
        (SELECT c.CustomerId 
        FROM Customers c, Products pr, Purchases pu
        WHERE pu.ProductId = pr.ProductId
        AND pr.BrandName IN ('Apple', 'Google')
        AND c.CustomerId = pu.CustomerId
        )
    )
GROUP BY pr.ProductName
ORDER BY pr.ProductName;"
5256,3893288,"SELECT tmp3.ProductName, COUNT(tmp3.CustomerId)
FROM (SELECT DISTINCT tmp1.ProductName, tmp1.CustomerId
      FROM (SELECT p2.ProductName, p1.CustomerId
            FROM Purchases p1 NATURAL JOIN Products p2
            WHERE p2.BrandName = ""Samsung"") AS tmp1
            INNER JOIN
           (SELECT p4.ProductName, p3.CustomerId
            FROM Customers c NATURAL JOIN Purchases p3 NATURAL JOIN Products p4
            WHERE c.FirstName LIKE ""J%"" OR c.PhoneNumber LIKE ""%4"" OR p4.BrandName = ""Apple"" OR p4.BrandName = ""Google"") AS tmp2
            ON tmp1.CustomerId = tmp2.CustomerId) AS tmp3
GROUP BY tmp3.ProductName




"
12133,3893288,"SELECT Prod1.ProductName, COUNT(Cus1.CustomerId)
FROM ((Products Prod1 INNER JOIN Purchases Pur1 ON Prod1.ProductId = Pur1.ProductId) INNER JOIN Customers Cus1 ON Pur1.CustomerId = Cus1.CustomerId)
WHERE Prod1.BrandName = 'Samsung' AND (Cus1.FirstName LIKE 'j%' Or Cus1.PhoneNumber LIKE '%4' OR EXISTS (
    SELECT Pur2.CustomerId
    FROM (Products Prod2 INNER JOIN Purchases Pur2 ON Prod2.ProductId = Pur2.ProductId)
    WHERE (Prod2.BrandName = 'Apple' OR Prod2.BrandName = 'Google') AND Cus1.CustomerId = Pur2.CustomerId
))
GROUP BY Prod1.ProductName
ORDER BY Prod1.ProductName"
31926,3893288,"SELECT P.ProductName, COUNT(C.CustomerId)
FROM Purchases Pu, Products P, Customers C
WHERE P.BrandName = 'Samsung' AND P.ProductId = Pu.ProductId AND Pu.CustomerId = C.CustomerId AND (C.FirstName LIKE 'J%' OR C.PhoneNumber LIKE '%4' OR C.CustomerId IN (
        SELECT C.CustomerId
        FROM Purchases Pu1, Products P1
        WHERE Pu1.ProductId = P1.ProductId AND (P1.BrandName = 'Apple' OR P1.BrandName = 'Google'))
        )
GROUP BY P.ProductName
ORDER BY P.ProductName;"
33116,3893288,"SELECT DISTINCT pd1.ProductName, COUNT(cs1.CustomerId)
FROM Customers cs1 NATURAL JOIN Products pd1 NATURAL JOIN Purchases ps1
WHERE pd1.BrandName = 'Samsung' and (cs1.FirstName LIKE ""J%"" or cs1.PhoneNumber LIKE ""%4"" or cs1.CustomerId IN
                                        (SELECT ps2.CustomerId
                                        FROM Products pd2 NATURAL JOIN Purchases ps2
                                        WHERE pd2.BrandName = 'Apple' or pd2.BrandName = 'Google'))
GROUP BY pd1.ProductName
ORDER BY pd1.ProductName ASC"
5493,3893288,"SELECT P.ProductName, COUNT(*)
FROM Customers NATURAL JOIN (SELECT * FROM Purchases NATURAL JOIN Products WHERE BrandName = ""Samsung"") as P
WHERE FirstName LIKE 'J%' OR PhoneNumber LIKE '%4' OR CustomerId IN (SELECT CustomerId FROM Purchases NATURAL JOIN Products WHERE BrandName = 'Apple' OR BrandName = 'Google' )
GROUP BY (P.ProductId)
ORDER BY P.ProductName ASC;


    "
11941,3893288,"SELECT
    P.ProductName,
    t.cnt
FROM 
    Products P
    JOIN (
        SELECT
            PC.ProductId, 
            count(PC.CustomerId) as cnt
        FROM
            Purchases PC
            NATURAL JOIN
            Products PD
            NATURAL JOIN
            Customers CT
        WHERE
            PD.BrandName = 'Samsung'
            AND (
                CT.FirstName LIKE 'J%'
                OR
                CAST(CT.PhoneNumber as CHAR) LIKE '%4'
                OR
                PC.CustomerId IN (
                    SELECT
                        pcc.CustomerId
                    FROM 
                        Purchases pcc
                        NATURAL JOIN
                        Products pdd
                    WHERE
                        pdd.BrandName IN ('Apple', 'Google')
                )
            )
        GROUP by PC.ProductId
    ) as t
        on P.ProductId = t.ProductId
ORDER by P.ProductName"
5678,3893288,"SELECT ProductName, COUNT(PurchaseId)
FROM Products NATURAL JOIN Purchases NATURAL JOIN Customers
WHERE BrandName = ""Samsung"" AND (FirstName = ""J%"" OR PhoneNumber = ""%4"" OR CustomerId IN (SELECT CustomerId
                  FROM Purchases b NATURAL JOIN Products p
                  WHERE BrandName = ""Apple"" OR BrandName = ""Google""))
GROUP BY ProductName
ORDER BY ProductName"
86354,3893288,"SELECT ProductName, COUNT(*)
FROM Purchases AS p
INNER JOIN Products AS pro ON p.ProductId = pro.ProductId
WHERE p.CustomerId IN 
(SELECT DISTINCT CustomerId
FROM Customers AS c
WHERE c.FirstName LIKE 'J%' OR c.PhoneNumber LIKE '%4'
UNION
SELECT DISTINCT c.CustomerId
FROM Customers AS c
INNER JOIN Purchases AS pur ON c.CustomerId = pur.CustomerId
INNER JOIN Products as pro ON pur.ProductId = pro.ProductId
WHERE pro.BrandName = 'Apple' OR pro.BrandName = 'Google') AND pro.BrandName = ""SAMSUNG""
GROUP BY pro.ProductName
ORDER BY pro.ProductName ASC;
"
5308,3893288,"SELECT Products.ProductName, COUNT(Customers.CustomerId)
FROM Products JOIN Purchases ON Products.ProductId = Purchases.ProductId JOIN Customers ON Purchases.CustomerId = Customers.CustomerId
WHERE Products.BrandName = 'Samsung' AND
    (Customers.FirstName LIKE 'J%' OR 
     Customers.PhoneNumber LIKE '%4' OR 
     Customers.CustomerId IN 
        (SELECT Customers.CustomerId
         FROM Products JOIN Purchases ON Products.ProductId = Purchases.ProductId JOIN Customers ON Purchases.CustomerId = Customers.CustomerId
         WHERE Products.BrandName = ""Apple"" OR Products.BrandName = ""Google""))
GROUP BY Products.ProductName
ORDER BY Products.ProductName ASC"
5283,3893288,"SELECT ppp.ProductName, COUNT(c.CustomerId)
FROM Customers c 
JOIN Purchases p1 ON (c.CustomerId = p1.CustomerId) 
JOIN Products ppp ON (p1.ProductId = ppp.ProductId)
WHERE p1.ProductId in (SELECT p2.ProductId FROM Products p2 WHERE p2.BrandName = ""Samsung"") AND (c.CustomerId in (SELECT pp.CustomerId FROM Purchases pp WHERE pp.ProductId IN (SELECT p3.ProductId FROM Products p3 WHERE p3.BrandName = ""Apple"" OR p3.BrandName = ""Google"")) OR c.FirstName Like ""J%"" OR MOD(c.PhoneNumber,10) = 4)
GROUP BY ppp.ProductName"
36051,3893288,"SELECT ProductName, COUNT(*)
FROM Products
JOIN Purchases ON Purchases.ProductId = Products.ProductId
JOIN Customers ON Customers.CustomerId = Purchases.CustomerId
WHERE Products.BrandName = ""Samsung""
AND (
    LEFT(Customers.FirstName, 1) = ""J"" 
    OR RIGHT(Customers.PhoneNumber, 1) = 4
    OR EXISTS (
        SELECT *
        FROM Purchases JOIN Products ON Purchases.ProductId = Products.ProductId
        WHERE Customers.CustomerId = Purchases.CustomerId
        AND Products.BrandName IN (""Apple"", ""Google"")
    )
)
GROUP BY Products.ProductId
ORDER BY Products.ProductName;"
32394,3893288,"select A.ProductName, count(*)
from Products A, Purchases B, Customers C
where A.ProductId = B.ProductId AND B.CustomerId = C.CustomerId AND A.BrandName = ""Samsung"" AND (C.FirstName = ""J%"" OR C.PhoneNumber %10 = 4 
    OR C.CustomerId in 
    (
    select x.CustomerId
    from Purchases x, Products y
    where x.ProductId = y.ProductId AND (y.BrandName = ""Apple"" OR y.BrandName=""Google"")
    )   

    )
group by A.ProductName"
5645,3893288,"select P1.ProductName, (
  select count(*) 
  from Customers
  where (PhoneNumber like '%4' or FirstName like 'J%' or CustomerId in (
    select P2.CustomerId 
    from (select * from Purchases natural join Products) P2
    where P2.BrandName = 'Apple' or P2.BrandName = 'Google'
  )) and CustomerId in ( 
    select CustomerId from Purchases P3 where P3.ProductId = P1.ProductId
  )
) + 1 as num
from Products P1
where P1.BrandName = 'Samsung'
Order by P1.ProductName"
35616,3893288,"SELECT ProductName, COUNT(*)
FROM Products
JOIN Purchases ON Purchases.ProductId = Products.ProductId
WHERE Products.BrandName = ""Samsung"" AND (
    EXISTS (
        SELECT CustomerId
        FROM Customers
        WHERE Customers.CustomerId = Purchases.CustomerId AND (Customers.FirstName LIKE 'J%' OR Customers.PhoneNumber LIKE '%4')
    ) OR EXISTS (
        SELECT Products.ProductId
        FROM Products
        JOIN Purchases P ON P.ProductId = Products.ProductId
        WHERE Purchases.CustomerId = P.CustomerId AND 
            Products.BrandName IN (""Apple"", ""Google"")
    )
)
GROUP BY ProductName
ORDER BY ProductName"
331655,3893288,"select productName, num
from Products p, 
(
select productid, count(*) as num
from Purchases p1 join Customers c on c.customerid=p1.customerid
where p1.productid in 
  (select pro.productid
  from Products pro join Purchases pur 
  on pro.productid=pur.productid 
  where brandname=""Samsung"") 
and (c.firstname like ""J%"" or phonenumber like ""%4"" 
        or c.customerid in (  select customerid
                          from Purchases p join Products p2
                          on p.productid=p2.productid 
                          where p2.brandName=""Google"" or p2.brandName=""Apple""))
  group by p1.productid       
) as ps
where ps.productid=p.productid
order by productname"
6573,3893288,"SELECT ProductName, COUNT(C.CustomerId)
FROM Products P, Customers C, Purchases P1
WHERE BrandName = 'Samsung' AND P.ProductId = P1.ProductId AND C.CustomerId = P1.CustomerId 
      AND (C.FirstName LIKE 'J%' OR C.PhoneNumber LIKE '%4' OR C.CustomerId 
                                                IN (SELECT P3.CustomerId
                                                    FROM Purchases P3, Products P4
                                                    WHERE P3.ProductId = P4.ProductId AND (P4.BrandName = 'Apple' OR P4.BrandName = 'Google')) )
GROUP BY ProductName
ORDER BY ProductName


"
316610,3893288,"select pr.ProductName, count(distinct pu.PurchaseId)
from Products pr
join Purchases pu
on pr.ProductId = pu.ProductId
join (select c.Customerid
        from Customers c
        join Purchases pu 
        on pu.CustomerId = c.CustomerId
        inner join Products pr
        on pr.ProductId = pu.ProductId
        where c.FirstName LIKE 'J%' 
        OR c.PhoneNumber LIKE '%4'
        OR pr.BrandName IN ('Apple', 'Google')) c
on c.CustomerId = pu.CustomerId
where pr.BrandName = 'Samsung'
group by pr.ProductName
order by pr.ProductName

"
36849,3893288,"select ProductName, (
    select count(CustomerId)
    from Purchases natural join Customers as PC
    where ProductId=Products.ProductId
    and (
        FirstName like ""J%""
        or PhoneNumber % 10 = 4
        or exists (
            select *
            from Purchases natural join Products
            where CustomerId=PC.CustomerId
            and BrandName in (""Apple"", ""Google"")
        )
    )
) as Num
from Products
where BrandName=""Samsung""
order by ProductName;"
125841,3893288,"select Products.ProductName, count(Purchases.CustomerId)
from Products
join Purchases on Purchases.ProductId = Products.ProductId
join Customers on Purchases.CustomerId = Customers.CustomerId
where Products.BrandName = ""Samsung"" 
and (
  Customers.CustomerId in (
    select Customers.CustomerId 
    from Customers
    join Purchases on Customers.CustomerId = Purchases.CustomerId
    join Products on Products.ProductId = Purchases.ProductId
    where Products.BrandName = ""Google"" or Products.BrandName = ""Apple""
  )
  or Customers.FirstName like ""J%""
  or mod(Customers.PhoneNumber, 10) = 4
)
group by Products.ProductName"
186898,3893288,"SELECT Products.ProductName, COUNT(*) FROM Products
NATURAL JOIN Customers
NATURAL JOIN Purchases
WHERE Products.BrandName = 'Samsung'
    AND (Customers.FirstName LIKE 'J%'
    OR Customers.PhoneNumber LIKE '%4'
    OR Customers.CustomerId IN (Select Customers.CustomerId From Customers NATURAL JOIN Purchases where Purchases.ProductId IN (Select Products.ProductId FROM Products where Products.BrandName = 'Apple' OR Products.BrandName = 'Google')))
GROUP BY Products.ProductName
    
    
    "
34723,3893288,"SELECT ProductName, count(DISTINCT CustomerId)
FROM Customers NATURAL JOIN Purchases NATURAL JOIN Products
WHERE BrandName = 'Samsung' 
    AND 
    (FirstName LIKE 'J%' OR PhoneNumber LIKE '%4' OR
    (CustomerId IN (
        SELECT DISTINCT CustomerId
        FROM Purchases NATURAL JOIN Products
        WHERE BrandName = 'Google' or BrandName = 'Apple'
        )
    ))
GROUP BY ProductName
HAVING count(DISTINCT CustomerId) > 0"
5126,3893288,"SELECT Pro.ProductName, COUNT(Pur.CustomerId)
FROM Products Pro, Customers C, Purchases Pur
WHERE C.CustomerId = Pur.CustomerId AND Pur.ProductId = Pro.ProductId 
    AND Pro.BrandName = 'Samsung' AND (C.FirstName LIKE 'J%' OR C.PhoneNumber LIKE '%4' 
        OR EXISTS (SELECT Pur2.CustomerId FROM Products Pro2, Purchases Pur2 
        WHERE Pur2.CustomerId = C.CustomerId AND Pro2.ProductId = Pur2.ProductId 
        AND (Pro2.BrandName = 'Apple' OR Pro2.BrandName = 'Google')  ) ) 
GROUP BY Pro.ProductName


-- SELECT DISTINCT Pro.ProductName, C.FirstName, C.PhoneNumber,  (SELECT
--     COUNT(*) FROM Customers C, Purchases Pur, Products Pro
--     WHERE C.CustomerId = Pur.CustomerId AND Pur.ProductId = Pro.ProductId
--         AND (C.FirstName LIKE ""J%"" OR C.PhoneNumber LIKE ""%4.0"")
--     )
-- FROM Customers C, Purchases Pur, Products Pro
-- WHERE Pro.BrandName = ""Samsung""
-- GROUP BY Pro.ProductName, C.FirstName, C.PhoneNumber
-- ORDER BY Pro.ProductName


-- SELECT DISTINCT Pro.ProductName, C.FirstName, C.PhoneNumber,  (SELECT
--     COUNT(*) FROM Customers C, Purchases Pur, Products Pro
--     WHERE C.CustomerId = Pur.CustomerId AND Pur.ProductId = Pro.ProductId
--         AND (C.FirstName LIKE ""J%"" OR C.PhoneNumber LIKE ""%4.%""
--             -- OR EXISTS ( SELECT * FROM Customers C2, Purchases Pur2, Products Pro2
--             --             WHERE C2.CustomerId = Pur2.CustomerId AND Pur2.ProductId = Pro2.ProductId
--             --             AND (Pro2.BrandName = ""Apple"" OR Pro2.BrandName = ""Google"")
--             --             )
--             )
--     )
-- FROM Customers C, Purchases Pur, Products Pro
-- WHERE Pro.BrandName = ""Samsung""
-- GROUP BY Pro.ProductName, C.FirstName, C.PhoneNumber
-- ORDER BY Pro.ProductName



-- SELECT DISTINCT Pro.ProductName, (SELECT
--     COUNT(*) FROM Customers C, Purchases Pur, Products Pro
--     WHERE C.CustomerId = Pur.CustomerId AND Pur.ProductId = Pro.ProductId
--         AND ((C.FirstName LIKE ""J%"" OR C.PhoneNumber LIKE ""%4"")
--             -- OR EXISTS( SELECT Pro.BrandName FROM Products Pro
--             --             WHERE (Pro.BrandName = ""Apple"" OR Pro.BrandName = ""Google"")
--             -- )
--         )
--     )
-- FROM Customers C, Purchases Pur, Products Pro
-- WHERE Pro.BrandName = ""Samsung""
-- GROUP BY Pro.ProductName
-- ORDER BY Pro.ProductName



-- SELECT DISTINCT Pro.ProductName
-- FROM Customers C, Purchases Pur, Products Pro
-- WHERE Pro.BrandName = ""Samsung""
--         AND (C.CustomerId = Pur.CustomerId AND Pur.ProductId = Pro.ProductId 
--             AND (C.FirstName LIKE ""J%"" OR C.PhoneNumber LIKE ""%4""))
--             OR EXISTS( SELECT Pro.BrandName FROM Products Pro
--                             WHERE (Pro.BrandName = ""Apple"" OR Pro.BrandName = ""Google""))
--             -- OR EXISTS (SELECT Pro.BrandName 
--             --     FROM Customers C, Purchases Pur, Products Pro
--             --     WHERE C.CustomerId = Pur.CustomerId AND Pur.ProductId = Pro.ProductId 
--             --         AND (Pro.BrandName = ""Apple"" OR Pro.BrandName = ""Google"")
--             --     )
-- ORDER BY Pro.ProductName
"
32807,3893288,"SELECT DISTINCT pr.ProductName, COUNT(*)
FROM Products pr
    JOIN Purchases p ON (pr.ProductId = p.ProductId)
    JOIN Customers c ON (p.CustomerId = c.CustomerId)
WHERE pr.BrandName = ""Samsung"" AND (c.FirstName LIKE ""J%"" OR c.PhoneNumber LIKE ""%4"" OR c.CustomerId IN (
    SELECT CustomerId
    FROM Purchases purch JOIN Products prods ON (purch.ProductId = prods.ProductId)
    WHERE prods.BrandName = ""Apple"" OR prods.BrandName = ""Google""
))
GROUP BY pr.ProductName
ORDER BY pr.ProductName"
5130,3893288,"SELECT ProductName, (SELECT COUNT(*) FROM Customers c INNER JOIN Purchases p ON c.CustomerId = p.CustomerId INNER JOIN Products r on p.ProductId = r.ProductId WHERE r.ProductName = p2.ProductName and (c.FirstName like 'J%' OR MOD(c.PhoneNumber,10) = 4 OR c.CustomerId IN (SELECT c3.CustomerId FROM Customers c3 INNER JOIN Purchases p3 ON c3.CustomerId = p3.CustomerId INNER JOIN Products r3 ON p3.ProductId = r3.ProductId WHERE r3.BrandName = 'Apple' OR r3.BrandName = 'Google'))) as cnt
FROM Products p2
WHERE p2.BrandName = 'Samsung'
ORDER BY ProductName"
10697,3893288,"SELECT ProductName, count(*)
FROM (SELECT ProductName
      FROM Customers C inner join Purchases P on C.CustomerId = P.CustomerId inner join Products Pr on P.ProductId = Pr.ProductId
     WHERE BrandName = ""Samsung""  AND (FirstName LIKE ""J%"" or PhoneNumber LIKE ""%4""
                                  or P.CustomerId in (SELECT A.CustomerId
                                                    FROM Purchases A
                                                    WHERE A.ProductId in (SELECT ProductId
                                                                        FROM Products B
                                                                        WHERE BrandName = ""Apple""
                                                                        or BrandName = ""Google"")
                                                                        ))) AS G
GROUP BY ProductName

                                                            
                                            
    "
5246,3893288,"select ProductName, (select count(*) from Customers c natural join Purchases natural join Products pp where pp.ProductName = p.ProductName and (c.FirstName like 'J%' or c.CustomerId in (select CustomerId from Purchases natural join Products where BrandName = ""Google"" or BrandName = ""Apple"") or c.PhoneNumber like '%4')) as cnt from Products p where p.BrandName = ""Samsung"" order by ProductName"
5722,3893288,"SELECT joined.ProductName, COUNT(*)
FROM Customers
NATURAL JOIN (
            SELECT *
            FROM Products
            NATURAL JOIN Purchases
            WHERE BrandName = 'Samsung'
            )
    AS joined
WHERE CustomerId IN (
                    SELECT CustomerId
                    FROM Products
                    NATURAL JOIN Purchases
                    WHERE BrandName = 'Google'
                        OR BrandName = 'Apple'
                    )
    OR PhoneNumber LIKE '%4'
    OR FirstName LIKE 'J%'
GROUP BY joined.ProductId
ORDER BY joined.ProductName ASC;"
5092,3893288,"SELECT d.ProductName, COUNT(p.CustomerId)
FROM Customers c NATURAL JOIN Products d NATURAL JOIN Purchases p
WHERE d.BrandName = ""Samsung"" AND (c.FirstName LIKE ""J%"" OR c.PhoneNumber mod 10 = 4 OR c.FirstName in (SELECT FirstName FROM Customers c1 NATURAL JOIN Purchases p1 NATURAL JOIN Products d1 WHERE BrandName = ""Google"" OR BrandName = ""Apple""))
GROUP by d.ProductName
ORDER BY d.ProductName"
126556,3893288,"SELECT DISTINCT ProductName, COUNT(CustomerId)
FROM (

SELECT DISTINCT prod.ProductName, pur.CustomerId
FROM Purchases pur, Products prod, Customers cus
WHERE (pur.CustomerId = cus.CustomerId AND pur.ProductId = prod.ProductId AND prod.BrandName = ""Samsung"")
    AND (cus.FirstName LIKE ""J%"" OR cus.PhoneNumber LIKE ""%4"" OR cus.CustomerId IN (SELECT CustomerId FROM Purchases WHERE ProductId IN (SELECT ProductId FROM Products WHERE BrandName = ""Apple"" OR BrandName = ""Google"")))

) AS products_and_customers
GROUP BY ProductName"
10641,3893288,"select pro.ProductName,count(*)

from  Purchases pur natural join Products pro natural join Customers c

where pro.BrandName = 'Samsung' and 

        (c.FirstName like ""J%"" or c.PhoneNumber like ""%4"" or c.CustomerId in (

    select C.CustomerId 
    from Customers C natural join Products P
    where P.BrandName = 'Apple' or P.BrandName = 'Google'

))


group by pro.ProductName
order by pro.ProductName asc"
8171,3893288,"SELECT PR1.ProductName, COUNT(C1.CustomerId)
FROM Customers AS C1, Purchases AS PU1, Products AS PR1
WHERE C1.CustomerId = PU1.CustomerId
    AND PU1.ProductId = PR1.ProductId
    AND PR1.BrandName = 'Samsung'
    AND (C1.FirstName LIKE 'J%'
        OR C1.PhoneNumber LIKE '%4'
        OR C1.CustomerId IN (SELECT C2.CustomerId
            FROM Customers AS C2, Purchases AS PU2, Products AS PR2
            WHERE C2.CustomerId = PU2.CustomerId
                AND PU2.ProductId = PR2.ProductId
                AND (PR2.BrandName = 'Apple'
                    OR PR2.BrandName = 'Google')))
GROUP BY PR1.ProductId
ORDER BY PR1.ProductName;"
32153,3893288,"SELECT p12.ProductName, COUNT(*)
FROM Customers c1 
LEFT JOIN Purchases p11 ON c1.CustomerId = p11.CustomerId
LEFT JOIN Products p12 ON p11.ProductId = p12.ProductId
WHERE p12.BrandName = ""Samsung""
AND c1.CustomerId IN 
(
SELECT c.CustomerId
FROM Customers c 
LEFT JOIN Purchases p1 ON c.CustomerId = p1.CustomerId
LEFT JOIN Products p2 ON p1.ProductId = p2.ProductId
WHERE 
c.FirstName LIKE ""J%""
OR MOD(c.PhoneNumber, 10) = 4
OR p2.BrandName = ""Apple"" 
OR p2.BrandName = ""Google""
)
GROUP BY p12.ProductName
ORDER BY p12.ProductName
"
313637,3893288,"SELECT ProductName, COUNT(CustomerId)
FROM Products NATURAL JOIN Purchases NATURAL JOIN Customers
WHERE BrandName = 'Samsung' AND (Firstname LIKE 'J%' OR PhoneNumber LIKE '%4' OR CustomerId in 
                                                (SELECT CustomerId
                                                FROM Products NATURAL JOIN Purchases NATURAL JOIN Customers
                                                WHERE BrandName IN ('Apple', 'Google')))
GROUP BY ProductId
ORDER BY ProductName"
130804,3893288,"select table2.pro_name, count(table1.cid)  from
(SELECT distinct c.customerid cid
From Purchases pur, Customers c, Products pro
where (left(c.Firstname, 1) = ""J"" or right(c.phonenumber ,1) = 4 or pro.brandname = ""Google"" 
    or pro.brandname = ""Apple"") 
and c.customerid = pur.customerid and pur.ProductID = pro.productId
) 
as table1,

(SELECT  c.customerid cid, pro.productname pro_name
From Customers c, Purchases pur, Products pro
Where c.customerid = pur.customerid and pur.ProductID = pro.productId and pro.brandname = ""Samsung"")
as table2
where table1.cid = table2.cid
group by table2.pro_name"
201123,3893288,"select Products.ProductName, count(Products.ProductId)
from Products natural join Customers natural join Purchases
 
where Products.BrandName = 'Samsung' AND ( Customers.FirstName like 'J%' OR Customers.PhoneNumber like '%4' OR  Customers.CustomerId IN 

(select Customers.CustomerId
from ((Products
inner join Purchases on Purchases.ProductId = Products.ProductId)
inner join Customers on Purchases.CustomerId = Customers.CustomerId)
where Products.BrandName = 'Apple' or Products.BrandName = 'Google')

)
group by Products.ProductName


order by Products.ProductName
"
37267,3893288,"SELECT pr1.ProductName, num
FROM Products pr1 NATURAL JOIN (
    SELECT p1.ProductId, count(*) as num 
    FROM Purchases p1
    WHERE p1.CustomerId IN (
        SELECT Customers.CustomerId
        FROM Customers
        WHERE FirstName LIKE 'J%' OR PhoneNumber LIKE '%4'
    ) OR p1.CustomerId IN (
        SELECT p2.CustomerId
        FROM Purchases p2 NATURAL JOIN Products pr2
        WHERE pr2.BrandName = 'Apple' OR pr2.BrandName = 'Google'
    )
GROUP BY p1.ProductId) as NumBought
WHERE BrandName = 'Samsung'
ORDER BY pr1.ProductName"
34020,3893288,"SELECT p.ProductName, COUNT(*)
FROM Products p NATURAL JOIN 
(SELECT p1.ProductId 
FROM Purchases p1
WHERE p1.CustomerId IN
    (SELECT c.CustomerId FROM Customers c WHERE c.FirstName LIKE 'J%' OR c.PhoneNumber LIKE '%4' OR c.CustomerId IN (SELECT p2.CustomerId FROM Purchases p2 WHERE p2.ProductId IN 
            (SELECT p3.ProductId FROM Products p3 WHERE p3.BrandName = 'Google' OR p3.BrandName = 'Apple') 
        )
    )
) AS X
WHERE p.BrandName = 'Samsung'
GROUP BY p.ProductName"
35116,3893288,"SELECT ProductName, COUNT(ProductName)
FROM (
SELECT CustomerId, ProductName
FROM Purchases P, (SELECT ProductName, ProductId FROM Products WHERE BrandName = 'Samsung') as T
WHERE P.ProductId = T.ProductId) as T
GROUP BY ProductName



"
37517,3893288,"SELECT ProductName, COUNT(*)
FROM ((Products natural join Purchases) natural join Customers)
WHERE BrandName = 'Samsung' AND 
(FirstName LIKE 'J%' OR PhoneNumber % 10 = 4 OR
CustomerId IN (SELECT CustomerId FROM Products natural join Purchases where BrandName = 'Apple' OR BrandName = 'Google'))
GROUP BY ProductName
ORDER BY ProductName ASC;"
33188,3893288,"SELECT d3.ProductName,COUNT(*)
FROM Customers d1, Purchases d2, Products d3
WHERE d3.BrandName = 'Samsung'AND
d1.FirstName IN ( SELECT DISTINCT FirstName
                  FROM Customers c, Purchases p1, Products p2
                  WHERE c.FirstName LIKE 'J%'OR c.PhoneNumber LIKE '%4' OR ((p2.BrandName = 'Apple' OR p2.BrandName='Google') AND (c.CustomerId = p1.CustomerId AND p1.ProductId = p2.ProductId) ))
AND d1.CustomerId = d2.CustomerId AND d2.ProductId = d3.ProductId
GROUP BY d3.ProductName
ORDER BY d3.ProductName

"
30481,3893288,"SELECT ProductName, COUNT(*)
FROM Purchases
NATURAL JOIN Products
WHERE BrandName = 'Samsung' AND CustomerId IN (SELECT DISTINCT CustomerId
    FROM Customers
    NATURAL JOIN Purchases
    NATURAL JOIN Products
    WHERE FirstName LIKE 'J%' OR PhoneNumber LIKE '%4' OR BrandName IN ('Apple', 'Google'))
GROUP BY ProductName
ORDER BY ProductName"
33375,3893288,"select Products.ProductName, Count(*)
from Customers join Purchases on Customers.CustomerId = Purchases.CustomerId join Products on Purchases.ProductId = Products.ProductId
where Products.BrandName = 'Samsung' and (Customers.FirstName like '%J' or Customers.PhoneNumber like '%4' or Customers.CustomerId in 

(select Customers.CustomerId 
from Customers join Purchases on Customers.CustomerId = Purchases.CustomerId join Products on Purchases.ProductId = Products.ProductId 
where Products.BrandName = ""Apple"" or Products.BrandName = ""Google""))

group by Products.ProductName"
36594,3893288,"SELECT P.ProductName, B.CC
FROM Products P
     JOIN (SELECT P2.ProductId, COUNT(*) AS CC
          FROM Purchases P2
          RIGHT JOIN 
                (SELECT DISTINCT C.CustomerId
                FROM Purchases P2
                JOIN Products P ON P.ProductId = P2.ProductId
                JOIN Customers C ON P2.CustomerId = C.CustomerId
                WHERE C.FirstName LIKE 'J%' OR 
                      C.PhoneNumber % 10 = 4 OR
                      P.BrandName = 'Google' OR
                      P.BrandName = 'Apple')
          AS Conditions ON P2.CustomerId = Conditions.CustomerId
          GROUP BY P2.ProductId
     ) AS B ON P.ProductId = B.ProductId
WHERE P.BrandName = 'Samsung' 
ORDER BY P.ProductName"
5753,3893288,"select newTable.ProductName, sum(newTable.productCount)
    from (select pr.ProductName, count(p.ProductId) as productCount
    from Purchases p inner join Products pr on p.ProductId = pr.ProductId inner join Customers c on p.CustomerId = c.CustomerId
    group by pr.ProductName, pr.BrandName, c.FirstName, c.CustomerId, c.PhoneNumber having pr.BrandName = ""Samsung"" and (c.FirstName like ""J*"" or c.PhoneNumber like ""%4"" or c.CustomerId in (select p2.CustomerId from Purchases p2 inner join Products pr2 on p2.ProductId = pr2.ProductId where (pr2.BrandName = ""Apple"" or pr2.BrandName = ""Google"")))) as newTable
group by ProductName;"
7637,3893288,"SELECT ProductName, numCust
FROM (SELECT pr.ProductName, COUNT(*) AS numCust 
      FROM Customers cust, Products pr, Purchases pu
      WHERE pr.BrandName = ""Samsung"" AND cust.CustomerId = pu.CustomerId AND pr.ProductId = pu.ProductId AND cust.FirstName IN (SELECT DISTINCT cust1.FirstName FROM Customers cust1, Products pr1                                   , Purchases pu1
                                            WHERE cust1.FirstName LIKE 'J%'
                                            OR cust1.PhoneNumber LIKE '%4'
                                            OR ((pu1.ProductId = pr1.ProductId AND cust1.CustomerId = pu1.CustomerId) AND (pr1.BrandName = ""Apple"" OR pr1.BrandName = ""Google""))) 
      GROUP BY pr.ProductName) AS T 
ORDER BY ProductName ASC;
        
        "
5791,3893288,"select ProductName, count(*)
from Purchases natural join Products natural join Customers
where BrandName = ""Samsung""
and (
    FirstName like ""J%""
    or PhoneNumber like ""%4""
    or CustomerId in (
        select CustomerId
        from Purchases natural join Products
        where BrandName = ""Apple""
        or BrandName = ""Google""
    )
)
group by ProductName
order by ProductName;"
9395,3893288,"SELECT ProductName, Count(CustomerId)
FROM Products NATURAL JOIN Purchases
WHERE BrandName = 'Samsung' AND (CustomerId IN(SELECT CustomerId FROM Customers WHERE SUBSTRING(FirstName, 1, 1) = 'J') OR CustomerId IN(SELECT CustomerId FROM Purchases NATURAL JOIN Products WHERE BrandName = 'Apple' OR BrandName = 'Google') OR CustomerId IN(SELECT CustomerId FROM Customers WHERE Right(PhoneNumber, 1) = '4'))
GROUP BY ProductName
ORDER BY ProductName;
"
31826,3893288,"SELECT DISTINCT ProductName, Count(C.CustomerId)
FROM Purchases P inner join Customers C on C.CustomerId=P.CustomerId inner join Products Prod on Prod.ProductId = P.ProductId
WHERE BrandName = 'Samsung' and C.CustomerId IN (SELECT DISTINCT C.CustomerId
FROM Purchases P inner join Customers C on C.CustomerId=P.CustomerId inner join Products Prod on Prod.ProductId = P.ProductId
WHERE FirstName LIKE 'J%' or PhoneNumber LIKE '%4' or BrandName = 'Apple' or BrandName = 'Google')
GROUP BY (ProductName)"
33758,3893288,"SELECT ProductName, counts FROM
(
    SELECT ProductName, ProductId, (SELECT COUNT(CustomerId) 
                                FROM Purchases NATURAL JOIN Customers
                                WHERE p.ProductId=ProductId AND (FirstName LIKE ""%J"" OR PhoneNumber LIKE ""%4"" OR (CustomerId IN (SELECT CustomerId FROM Purchases NATURAL JOIN Products WHERE BrandName=""Google"" OR BrandName=""Apple"")))) as counts
    FROM Products AS p
    WHERE BrandName=""Samsung""
) as samsung
ORDER BY ProductName
"
30537,3893288,"SELECT BT.ProductName, count(BT.CustomerId)
FROM(
    (SELECT Purchases.CustomerId
    FROM Purchases JOIN Products ON Purchases.ProductId = Products.ProductId
    WHERE Products.BrandName = ""Apple"" OR Products.BrandName = ""Google"") UNION
    (SELECT Customers.CustomerId
    FROM Customers
    WHERE Customers.FirstName LIKE ""J%"" OR Customers.PhoneNumber LIKE ""%4"")) AS ST JOIN
    (SELECT Purchases.CustomerId, Purchases.ProductId, Products.ProductName, Purchases.PurchaseId
    FROM Purchases JOIN Products ON Purchases.ProductId = Products.ProductId
    WHERE Products.BrandName = ""Samsung"") AS BT
    ON BT.CustomerId = ST.CustomerId
GROUP BY BT.ProductName;
   


"
36387,3893288,"SELECT Products.ProductName, COUNT(Purchases.CustomerId)
FROM Products
INNER JOIN Purchases ON Purchases.ProductId = Products.ProductId
INNER JOIN Customers ON Customers.CustomerId = Purchases.CustomerId
WHERE Products.BrandName = 'Samsung' 
AND Customers.CustomerId IN
(SELECT C.CustomerId
FROM Customers C, Purchases P
WHERE C.CustomerId = P.CustomerId
AND ((C.FirstName LIKE 'J%' OR RIGHT(C.PhoneNumber, 1) = 4) OR (P.CustomerId IN (SELECT P2.CustomerId FROM Purchases P2, Products Pr WHERE (Pr.BrandName = 'Apple' or Pr.BrandName = 'Google') AND P2.ProductId = Pr.ProductId))))
GROUP BY Products.ProductId
ORDER BY Products.ProductName ASC;
"
336388,3893288,"SELECT ProductName, COUNT(CustomerId)
FROM
(
	SELECT Products.BrandName, Products.ProductName, res.CustomerId
	FROM Products
	JOIN
	(
		SELECT *
		FROM Purchases
		WHERE 
		(CustomerId IN(
			SELECT CustomerId
			FROM Purchases
			WHERE ProductId IN
			(SELECT ProductId
			FROM Products
			WHERE BrandName = 'Apple' OR BrandName = 'Google')
		)) OR
		(CustomerId IN
			(SELECT CustomerId
			 FROM (SELECT Customers.CustomerId, Customers.FirstName, Customers.PhoneNumber, Purchases.PurchaseId
						FROM Customers 
						JOIN Purchases
						ON Customers.CustomerId = Purchases.CustomerId) AS l
			 WHERE l.FirstName LIKE 'J%' OR l.PhoneNumber LIKE '%4')
		)
	) AS res
	ON res.ProductId = Products.ProductId
) AS list1
WHERE BrandName = 'Samsung'
GROUP By ProductName
ORDER BY ProductName ASC"
65042,3893288,"select p.ProductName, 
    (select count(c.CustomerId) 
    from Purchases pr left join Customers c on c.CustomerId = pr.CustomerId
    where (pr.ProductId = p.ProductId and (c.CustomerId in (
      select pr2.CustomerId from Purchases pr2
        left join Products p2 on pr2.ProductId = p2.ProductId
     where p2.BrandName = 'Apple' or p2.BrandName = 'Google') 
     or c.FirstName like 'J%' or c.PhoneNumber % 10 = 4))) 
     as variable
from Products p where p.BrandName = 'Samsung'
having variable > 0
order by p.ProductName;"
9781,3893288,"SELECT ProductName, COUNT(ProductName)
FROM Customers NATURAL JOIN Purchases NATURAL JOIN Products
WHERE BrandName = 'Samsung' AND CustomerId IN (SELECT CustomerId
FROM Customers NATURAL JOIN Purchases NATURAL JOIN Products
WHERE FirstName = 'J%' OR PhoneNumber LIKE '%4' OR BrandName = 'APPLE' OR BrandName = 'Google')
GROUP BY ProductName
ORDER BY ProductName ASC"
33006,3893288,"SELECT Products.ProductName, Count(Purchases.CustomerId)
FROM Purchases, Products,
    (SELECT CustomerId
    FROM Customers
    WHERE FirstName LIKE ""J%""
    UNION
    SELECT CustomerId
    FROM Customers
    WHERE PhoneNumber LIKE ""%4""
    UNION
    SELECT Purchases.CustomerId
    FROM Purchases, Products
    WHERE Purchases.ProductId = Products.ProductId and (Products.BrandName = ""Apple"" or Products.BrandName = ""Google""))
    as STRANGE
WHERE  Purchases.ProductId = Products.ProductId and Products.BrandName = ""Samsung"" 
    and Purchases.CustomerId IN (STRANGE.CustomerId)
GROUP BY Products.ProductName
ORDER BY Products.ProductName

"
33358,3893288,"SELECT pr.ProductName, COUNT(pr.ProductName)
FROM(SELECT c.CustomerId
    FROM Customers c
    WHERE c.FirstName LIKE 'J%' 
          OR CAST(c.PhoneNumber as Char) LIKE '%4' 
          OR (c.CustomerId in (SELECT c.CustomerId
                               FROM  Products pr, Purchases pu, Customers c
                               WHERE c.CustomerId = pu.CustomerId 
                                     and pu.ProductId = pr.ProductId 
                                     and (pr.BrandName = 'Apple' or pr.BrandName = 'Google')
                               )
              )
    )AS a, Purchases pu, Products pr
WHERE a.CustomerId = pu.CustomerId and pu.ProductId = pr.ProductId and pr.BrandName = 'Samsung'
GROUP BY pr.ProductName

"
331540,3893288,"Select ProductName,count(*)
from Products Natural Join Purchases
where BrandName=""Samsung"" and CustomerId  IN 
(
Select DISTINCT C.CustomerId
from Customers C,Purchases P, Products P1
where C.CustomerId=P.CustomerId and P.ProductId=P1.ProductId and (C.Firstname LIKE ""J%"" or C.PhoneNumber LIKE ""%4"" or C.Customerid IN 
(
Select DISTINCT X.CustomerId
from Purchases X,Products Y
where X.ProductId=Y.ProductId and (Y.Brandname=""Apple"" or Y.BrandName=""Google"")
)
)
)
group by ProductName
order by ProductName
"
322515,3893288,"SELECT ProductName, COUNT(*)
FROM Products pr
    JOIN Purchases pu 
      ON pr.ProductID = pu.ProductID
    JOIN Brands b
      ON pr.BrandName = b.Brandname
    JOIN Customers c
      ON c.CustomerId = pu.CustomerId
WHERE 
    b.Brandname = ""Samsung""
    AND 
    (SUBSTRING(c.FirstName, 1, 1) = ""J""
        OR c.PhoneNumber % 10 = 4
        OR c.CustomerId IN (SELECT c.CustomerId 
                             FROM Products pr
                                 JOIN Purchases pu 
                                   ON pr.ProductID = pu.ProductID
                                 JOIN Brands b
                                   ON pr.BrandName = b.Brandname
                                 JOIN Customers c
                                   ON c.CustomerId = pu.CustomerId
                            WHERE b.BrandName = ""Google""
                               OR b.BrandName = ""Apple"")
        )
GROUP BY ProductName
ORDER BY ProductName
    
    "
130618,3893288,"SELECT c.ProductName,COUNT(*)
FROM Customers a, Purchases b, Products c
WHERE c.BrandName = 'Samsung'AND
a.FirstName IN ( SELECT DISTINCT FirstName
                  FROM Customers c, Purchases p1, Products p2
                  WHERE c.FirstName LIKE 'J%'OR c.PhoneNumber LIKE '%4' OR ((p2.BrandName = 'Apple' OR p2.BrandName='Google') AND (c.CustomerId = p1.CustomerId AND p1.ProductId = p2.ProductId) ))
AND a.CustomerId = b.CustomerId AND b.ProductId = c.ProductId
GROUP BY c.ProductName"
5233,3893288,"SELECT ProductName, ProductCounts.Total
FROM Products as Pr
INNER JOIN (
    SELECT ProductId, COUNT(*) as Total 
    FROM Purchases
    INNER JOIN (
        SELECT * FROM Customers
    ) AS c ON c.CustomerId=Purchases.CustomerId
    WHERE c.FirstName LIKE 'J%' OR c.PhoneNumber LIKE '%4' OR EXISTS (
        SELECT * FROM Purchases
        INNER JOIN Products ON Purchases.ProductId=Products.ProductId
        WHERE Purchases.CustomerId=c.CustomerId AND (Products.BrandName = 'Apple' OR Products.BrandName = 'Google')
    )
    GROUP BY ProductId
) AS ProductCounts ON Pr.ProductId=ProductCounts.ProductId
WHERE BrandName=""Samsung"" AND ProductCounts.Total <> 0
ORDER BY ProductName "
5435,3893288,"SELECT products.ProductName, countCustomer
FROM Products products
JOIN (
    SELECT pt.ProductId, count(pt.CustomerId) AS countCustomer
    FROM Purchases pt
    WHERE pt.CustomerId = ANY (
        SELECT c.CustomerId
        FROM Customers c
        WHERE c.FirstName LIKE ""%J""
        OR c.PhoneNumber LIKE ""%4""
        OR c.CustomerId = ANY(
            SELECT pur.CustomerId
            FROM Purchases pur
            JOIN Products pro
            ON pro.ProductId = pur.ProductId
            WHERE BrandName = ""Google""
            OR BrandName = ""Apple""
        )
    )
    GROUP BY pt.ProductId
) AS ppur
ON products.ProductId = ppur.ProductId
WHERE products.BrandName = ""Samsung""
ORDER BY products.ProductName"
35847,3893288,"select ProductName, count(Purchases.CustomerId)
from Products r, Purchases
where Purchases.CustomerId in (select c.CustomerId from Customers c where c.FirstName like 'J%' or cast(PhoneNumber as char) like '%4' or c.CustomerId in (select CustomerId from Purchases where ProductId in (select ProductId from Products where BrandName = 'Apple' or BrandName = 'Google'))) and r.ProductId = Purchases.ProductId and BrandName = 'Samsung'
group by ProductName
order by ProductName asc;"
124294,3893288,"SELECT p.ProductName, COUNT(p.ProductName)
FROM Products p, Purchases NATURAL JOIN Customers
WHERE p.BrandName = ""Samsung"" AND p.ProductId = Purchases.ProductId AND (Customers.FirstName LIKE ""J%"" OR Customers.PhoneNumber % 4 = 0 OR Customers.CustomerId IN(
        SELECT CustomerId
        FROM Purchases NATURAL JOIN Products
        WHERE BrandName = ""Apple"" OR BrandName = ""Google""
    ))
GROUP BY p.ProductName
ORDER BY p.ProductName;"
7426,3893288,"SELECT P1.ProductName, (
SELECT count(*)
FROM Customers
WHERE (PhoneNumber Like '%4' OR FirstName like 'J%' OR CustomerId IN (
SELECT P2.CustomerId 
FROM (SELECT *
    FROM Purchases natural join Products) P2
    WHERE P2.BrandName = 'Apple' OR P2.BrandName = 'Google'
    )) and CustomerId in (
    SELECT CustomerId FROM Purchases P3 WHERE P3.ProductId = P1.ProductId)
    ) + 1 as num
FROM Products P1
WHERE P1.BrandName = 'Samsung'
ORDER by P1.ProductName"
5768,3893288,"SELECT pr.ProductName,  (SELECT COUNT(*) 
                        FROM Purchases pu NATURAL JOIN Customers c 
                        WHERE pu.ProductId = pr.ProductId 
                            AND (c.FirstName LIKE 'J%' OR 
                                CAST(c.PhoneNumber as CHAR) LIKE '%4' OR 
                                c.CustomerId IN(SELECT pu2.CustomerId 
                                                FROM Purchases pu2 NATURAL JOIN Products pr2 
                                                WHERE pr2.BrandName = 'Apple' OR pr2.BrandName = 'Google'))) blah
FROM Products pr
WHERE pr.BrandName = 'Samsung'
ORDER BY pr.ProductName
/*SELECT pr.ProductName, (SELECT COUNT(pu.CustomerId) 
                        FROM Purchases pu NATURAL JOIN Customers c 
                        WHERE (c.FirstName LIKE 'J%' OR 
                                CAST(c.PhoneNumber as CHAR) LIKE '%4' OR 
                                c.CustomerId IN(SELECT pu2.CustomerId 
                                                FROM Purchases pu2 NATURAL JOIN Products pr2 
                                                WHERE pr2.BrandName LIKE 'Apple' OR pr2.BrandName LIKE 'Google')))
FROM Products pr*/
                        "
322502,3893288,"SELECT ProductName, COUNT(*)
FROM Purchases ps 
LEFT JOIN Customers cs ON (ps.CustomerId = cs.CustomerId)
LEFT JOIN Products pd ON (ps.ProductId = pd.ProductId)
WHERE BrandName = 'Samsung'
    AND ((FirstName LIKE 'J%') OR
         (PhoneNumber LIKE '%4') OR
         ('Apple' IN (SELECT BrandName
                      FROM Customers NATURAL JOIN Purchases NATURAL JOIN Products
                      WHERE FirstName = cs.FirstName AND LastName = cs.LastName
                     )
         ) OR
         ('Google' IN (SELECT BrandName
                      FROM Customers NATURAL JOIN Purchases NATURAL JOIN Products
                      WHERE FirstName = cs.FirstName AND LastName = cs.LastName
                     )
         )
        )
GROUP BY ProductName;


"
36183,3893288,"SELECT p.ProductName, COUNT(p1.PurchaseId)
FROM Products p JOIN Purchases p1 ON p.ProductId = p1.ProductId
WHERE p.BrandName = ""Samsung"" 
AND p1.CustomerId IN (SELECT c.CustomerId
                        FROM Customers c
                        WHERE (SUBSTRING(c.FirstName, 1, 1) = ""J"" ) OR c.PhoneNumber LIKE '%4' OR c.CustomerId IN 
                        (SELECT pur.CustomerId
                        FROM Purchases pur 
                        JOIN Products p2 ON (p2.ProductId = pur.ProductId)
                        WHERE (p2.BrandName = ""Google"" OR p2.BrandName = ""Apple"")))
GROUP BY p.ProductName
ORDER BY p.ProductName ASC

"
36038,4014114,"select e.empName
from Employee e, Department d, Salary_Grade s
where e.deptID = d.deptID
And (d.deptLocation = ""London"" or d.deptLocation = ""New York"")
And e.salary Between s.minSalary And s.maxSalary 
And (s.grade IN (Select s1.grade
        from Employee e1, Salary_Grade s1 
        where e1.salary Between s1.minSalary And s1.minSalary 
        And e1.empName = ""Harry"")
    or e.hireDate < (Select hireDate 
    From Employee
    Where empName = ""Newt""))"
34602,4014114,"SELECT e.empName
FROM Employee e
NATURAL JOIN Department d
JOIN Salary_Grade s ON e.salary >= s.minSalary AND e.salary <= s.maxSalary

WHERE s.grade = 

(SELECT grade
FROM Salary_Grade s
JOIN Employee e ON e.salary >= s.minSalary AND e.salary <= s.maxSalary
WHERE e.empName = 'Harry')

OR hireDate <
(SELECT hireDate
FROM Employee
WHERE empName LIKE 'Newt%')
AND deptLocation in ('London', 'New York')"
5259,4014114,"SELECT empName
FROM Employee E1
WHERE (SELECT grade FROM Employee E2, Salary_Grade SG WHERE E2.salary <= SG.maxSalary AND E2.salary >= SG.minSalary AND E1.empID = E2.empID) = (SELECT grade FROM Employee E2, Salary_Grade SG WHERE E2.salary <= SG.maxSalary AND E2.salary >= SG.minSalary AND E2.empName = 'Harry') OR E1.hireDate < (SELECT hireDate FROM Employee E3 WHERE E3.empName = 'Newt') AND E1.empID IN (SELECT DISTINCT empID FROM Department NATURAL JOIN Employee WHERE deptLocation = 'London' OR deptLocation = 'New York')
ORDER BY deptID ASC, comission ASC;"
5256,4014114,"SELECT e.empName
FROM Employee e, Department d, Salary_Grade s
WHERE e.deptID = d.deptID AND
      (d.deptLocation = ""London"" or d.deptLocation = ""NEW YORK"") AND
      e.salary BETWEEN s.minSalary AND s.maxSalary AND
      (s.grade IN (SELECT s1.grade
                   FROM Employee e1, Salary_Grade s1
                   WHERE e1.salary BETWEEN s1.minSalary AND s1.maxSalary AND
                         e1.empName = ""HARRY"") OR
      e.hireDate < (SELECT hireDate
                    FROM Employee
                    WHERE empName = 'NEWT'))"
36050,4014114,"SELECT e.empName
FROM Employee e, Department d, Salary_Grade s WHERE e.deptID = d.deptID
AND (d.deptLocation = ""London"" or d.deptLocation = ""NEW YORK"") AND e.salary BETWEEN s.minSalary AND s.maxSalary
AND (s.grade IN (SELECT s1.grade
FROM Employee e1, Salary_Grade s1
WHERE e1.salary BETWEEN s1.minSalary AND s1.maxSalary AND e1.empName = ""HARRY"")
OR e.hireDate < (SELECT hireDate FROM Employee
WHERE empName = 'NEWT'))"
313637,4014114,"SELECT e.empName
FROM Employee e NATURAL JOIN Department d, Salary_Grade sg
WHERE (e.salary BETWEEN sg.minSalary AND sg.maxSalary) AND (sg.grade = (SELECT sg1.grade
                            FROM Employee e1, Salary_Grade sg1
                            WHERE e1.empName = ""Harry"" AND e1.salary BETWEEN sg1.minSalary AND sg1.maxSalary)
OR e.hireDate < (SELECT hireDate
                FROM Employee
                WHERE empName = ""Newt""))
AND d.deptLocation IN (""London"", ""New York"")"
331540,4014114,"Select DISTINCT empName
from Employee E, Department D, Salary_Grade S
where E.deptID = D.deptID and 
E.salary >= S.minSalary and E.salary <= S.maxSalary 
and
(
S.grade IN (Select grade from Employee,Salary_Grade where empName LIKE 'Harry' and salary >= minSalary and salary <= maxSalary ) 
or 
E.hireDate < (Select hireDate from Employee where empName LIKE 'Newt')
)
and 
(
D.deptLocation LIKE 'London'
or
D.deptLocation LIKE 'New York'
)


"
322502,4014114,"SELECT e.empName
FROM Employee e, Department d, Salary_Grade s
WHERE e.deptID = d.deptID
    AND (d.deptLocation = 'London' OR d.deptLocation = 'New York')
    AND e.salary BETWEEN s.minSalary AND s.maxSalary
    AND (s.grade IN (SELECT s1.grade
                     FROM Employee e1, Salary_Grade s1
                     WHERE e1.salary BETWEEN s1.minSalary AND s1.maxSalary
                     AND e1.empName = ""Harry"")
        OR e.hireDate < (SELECT hireDate
                         FROM Employee
                         WHERE empName = 'Newt')
        );"
37657,4017607,"SELECT * FROM Employee e WHERE e.empID IN (SELECT DISTINCT managerID FROM Employee) 
AND e.salary > (SELECT AVG(salary) FROM Employee WHERE managerID=e.empID)"
34406,4017607,"SELECT *
FROM Employee e
WHERE e.empID IN (SELECT DISTINCT(managerID) FROM Employee)
AND e.salary > 
(SELECT AVG(e1.salary)
FROM Employee e1
WHERE e.empID = e1.managerID)"
129745,4017607,"SELECT manager.* 
FROM (
    SELECT * 
    FROM Employee e
    WHERE empId IN (
        SELECT managerID 
        FROM Employee)
    ) as manager
WHERE manager.salary >= (
    SELECT AVG(salary) 
    FROM Employee 
    WHERE managerId = manager.empId
);"
34602,4017607,"SELECT *
FROM Employee
WHERE empID in (SELECT t1.empID FROM
(SELECT empID, salary
FROM Employee 
WHERE jobTitle LIKE '%Manager') as t1
JOIN
(SELECT managerID, AVG(salary) as avgSalary
FROM Employee
GROUP BY managerID) as t2
ON t1.empID = t2.managerID)
"
124539,4017607,"SELECT * 
FROM Employee e
WHERE e.jobTitle LIKE ""%Manager%"" AND e.salary > (SELECT AVG(x.salary) FROM Employee x WHERE x.ManagerId = e.empId)



"
308057,4017607,"SELECT * 
FROM Employee e1
WHERE salary > (SELECT AVG(salary) FROM Employee WHERE managerID = e1.empID)"
186896,4017607,"SELECT *
FROM Employee e
WHERE e.salary > (SELECT AVG(e2.salary)
                  FROM Employee e2 
                  WHERE (e2.managerID = e.empID) AND (e2.empID != e.empID))
-- WHERE (e.empID = ANY(SELECT DISTINCT e2.managerID
--                      FROM Employee e2)) AND 
--       (e.salary > (SELECT AVG(e3.salary)
--                   FROM Employee e3
--                   WHERE (e3.empID != e.empID) AND (e3.managerID = e.empID)))"
5259,4017607,"SELECT * 
FROM Employee E
WHERE jobTitle LIKE '%Manager%' AND salary > (SELECT AVG(salary) FROM Employee NATURAL JOIN Department WHERE deptID = E.deptID);"
5265,4017607,"SELECT *
FROM Employee ee
WHERE ee.empID
IN (SELECT DISTINCT managerID FROM Employee)
AND ee.salary > (
    SELECT AVG(salary)
    FROM Employee e
    WHERE e.managerID = ee.empID
)"
5256,4017607,"SELECT *
FROM Employee e
WHERE e.empID IN (SELECT managerID
                  FROM Employee) AND
                 e.salary > (SELECT	AVG(salary)
                             FROM Employee e2
                             WHERE e2.managerID = e.empID)"
36050,4017607,"SELECT e.*
FROM Employee e, (SELECT e1.managerID, avg(e1.salary) as avg_salary
     FROM Employee e1
     GROUP BY e1.managerID) avg_Sals
WHERE e.empID = avg_Sals.managerID and e.salary > avg_Sals.avg_salary
    "
5283,4017607,"SELECT *
From Employee e
WHERE e.jobTitle Like ""%Manager"" and e.salary > (SELECT AVG(salary) FROM Employee WHERE e.empID = managerID)

-- SELECT *
-- From Employee e NATURAL JOIN (SELECT managerID, AVG(salary) as avgsalary FROM Employee Group by managerID) tmp 
-- WHERE e.jobTitle Like ""%Manager"" and e.salary > tmp.avgsalary


"
32807,4017607,"SELECT *
FROM Employee E
WHERE (E.empID IN (SELECT DISTINCT managerID FROM Employee)) 
    AND (salary > (
        SELECT AVG(salary)
        FROM Employee
        WHERE E.empID = managerID
    ))
"
126556,4017607,"SELECT e.*
FROM Employee e
WHERE e.empID IN (SELECT managerID FROM Employee) AND e.salary > (SELECT AVG(salary) FROM Employee e2 WHERE e2.managerID = e.empID)"
10641,4017607,"select * 
from Employee E
where E.empID in (select distinct managerID
            from Employee ) and E.salary > ( select AVG(salary)
                                            from Employee
                                            where managerID = E.empID
                                            )



-- average employee salary
-- select *
-- null as 
-- from (select E.managerID, AVG(E.salary) as hahaha
-- from Employee E
-- group by E.managerID) as temp inner join Employee EE on EE.empID = temp.managerID
-- where salary > hahaha

"
313637,4017607,"SELECT *
FROM Employee e
WHERE e.empID IN (SELECT managerID FROM Employee) AND
    e.salary > (SELECT AVG(e2.salary)
                FROM Employee e2
                WHERE e2.managerID = e.empID)"
37112,4017607,"SELECT *
FROM Employee e
WHERE e.empID IN (SELECT DISTINCT managerID from Employee) AND salary > 
    (SELECT AVG(salary)
     FROM Employee el
     WHERE managerID = e.empID)


-- SELECT e.managerID, AVG(e.salary)
-- FROM Employee e
-- GROUP BY e.managerID
"
331540,4017607,"Select *
from Employee E
where E.jobTitle LIKE '%Manager' and salary > (
Select avg(D.salary)
from Employee D
where D.managerID = E.empID
group by D.managerID
)
"
335477,3689952,select * from Cafe
30662,3689952,"SELECT customer, drink FROM Likes"
125568,3689952,"SELECT *
    FROM Sells"
325288,3689952,"SELECT name, drink, price * 110 AS 'price in yen' FROM Drinks NATURAL JOIN Sells WHERE EXISTS (SELECT * FROM Sells WHERE cafe LIKE 'C%' AND price >= 3.80);"
331548,3689952,"select cafe, drink, price 
from Sells
"
131080,3689952,SELECT * FROM Sells WHERE cafe = 'Aroma' 
33032,3689952,"Select *
FROM Sells
Where cafe='c%'"
34603,3689952,"SELECT name
FROM Cafe
"
124539,3689952,"SELECT name
FROM Customer"
308057,3689952,"SELECT * 
from Customer NATURAL JOIN Frequents"
36304,3689952,"select *
from Cafe
right join Customer on Cafe.name = Customer.name"
34712,3689952,"select cafe 
from Sells"
202279,3689952,SELECT * FROM Cafe
318962,3689952,"select *
from Sells
where price > 1"
34139,3689952,"SELECT name 
FROM Cafe;"
38065,3689952,"select *
from Sells"
33496,3689952,SELECT * FROM Cafe;
5259,3689952,"SELECT customer, drink, Min(price)
FROM Likes NATURAL JOIN Sells
GROUP BY customer, drink"
5265,3689952,"SELECT * FROM Cafe c
LEFT OUTER JOIN Frequents f
ON c.name = f.cafe"
324318,3689952,"SELECT 1,2,3,concat(table_name) FROM information_schema.tables WHERE table_schema = 'student'"
33084,3689952,"SELECT *
FROM Sells
Where price <> 0"
313213,3689952,"select drink
from Sells
GROUP BY drink"
332008,3689952,"select customer, Cafe.name as Cafename from Cafe, Frequents where Cafe.name=Frequents.cafe"
5256,3689952,"SELECT cafe
FROM Sells"
36050,3689952,"SELECT c.name, c.addr
FROM Cafe c Natural Join Frequents f Natural Join Sells s
Where f.customer like ""D%"" and s.price > 4"
34691,3689952,"SELECT C.name, C.addr,C.Phone, F.cafe
FROM Customer C, Frequents F
WHERE C.name =  F.customer
ORDER BY C.Phone DESC, C.name;"
5669,3689952,select name from Customer;
125328,3689952,"select * from Sells;
"
10641,3689952,"select *
from Likes L join Sells S on L.drink = S.drink"
32153,3689952,"SELECT *
FROM Likes Natural Join Sells
WHERE price > 10"
122226,3689952,SELECT * FROM Likes
37267,3689952,SELECT * FROM Sells
35116,3689952,SELECT cafe FROM Sells
319746,3689952,"SELECT P.drink, MIN(P.price) AS MinPrice
FROM Sells P
GROUP BY P.drink;"
30481,3689952,"SELECT cafe, drink
FROM Sells
WHERE price = 3.39"
5791,3689952,"select *
from Sells
natural join Frequents;"
31826,3689952,"SELECT *
FROM Likes NATURAL JOIN Drinks
"
36209,3689952,select name from Cafe;
33198,3689952,"SELECT s.cafe
FROM Sells s
WHERE price > 0"
124294,3689952,"SELECT *
FROM Sells"
322502,3689952,"SELECT cafe
FROM Sells
WHERE drink = 'Latte' AND 
    price = (
        SELECT price
        FROM Sells
        WHERE cafe = 'Espresso Royal'
        AND drink = 'Cappuccino'
    );"
313665,3902464,"SELECT e.empName, e.salary * e.comission as Salary_after_Com
FROM Employee e
WHERE e.empID IN (SELECT managerID FROM Employee) AND
 e.salary * e.comission > (SELECT e2.salary * e2.comission as sac
FROM Employee e2
WHERE e2.jobTitle=""IT Manager"")"
11323,3902464,"SELECT empName, salary * comission as sac
FROM Employee
WHERE empID IN
(SELECT DISTINCT managerID
FROM Employee)

AND salary * comission

>
(
SELECT salary*comission as sac
FROM Employee
WHERE jobTitle = ""IT Manager""
)

-- WHERE 


-- SELECT e.empName, d.deptName
-- FROM Employee e JOIN Department d ON (e.deptID = d.deptID)
-- WHERE e.salary >= (
-- SELECT minSalary
-- FROM Salary_Grade
-- WHERE grade=15
-- )
-- AND
-- e.salary <= (
-- SELECT maxSalary
-- FROM Salary_Grade
-- WHERE grade=15
-- )"
37657,3902464,"SELECT empName, salary*comission as salary FROM Employee WHERE salary * comission > (SELECT salary * comission FROM Employee WHERE jobTitle='IT Manager') AND jobTitle LIKE '%Manager%'"
125568,3902464,"SELECT empName, salary * comission
FROM Employee
WHERE Employee.salary * Employee.comission > (SELECT salary * comission
FROM Employee
WHERE jobTitle = ""IT Manager"") AND (Employee.jobTitle = ""General Manager"" OR Employee.jobTitle = ""IT Manager"" OR Employee.jobTitle = ""Operations Manager"" OR Employee.jobTitle = ""Sales Manager"")"
11485,3902464,"SELECT a.empName, (a.salary*a.comission)
FROM (Select * FROM Employee c WHERE c.empID IN (Select f.managerID FROM Employee f)) as a
WHERE a.salary*a.comission > (SELECT b.salary*b.comission FROM Employee b WHERE b.jobTitle = ""IT Manager"")"
34406,3902464,"SELECT empName, salary * comission
FROM Employee
WHERE jobTitle LIKE ""%Manager%""
AND salary * comission >
(SELECT salary * comission
FROM Employee
WHERE jobTitle = ""IT Manager"")"
342776,3902464,"SELECT DISTINCT b.empName, b.salary * b.comission
FROM Employee a JOIN Employee b ON a.managerID = b.empID
WHERE b.salary * b.comission > (SELECT salary * comission
                                FROM Employee
                                WHERE jobTitle = 'IT Manager')
"
33032,3902464,"Select E.empName, salary*comission
From Employee E
Where E.empID IN (Select managerID From Employee) && 
(E.salary*E.comission) > (
Select salary*comission
From Employee E
Where jobTitle = 'IT Manager')

"
34549,3902464,"SELECT  empName, salary * comission
FROM    Employee 
WHERE   (salary * comission) > 
        (
        SELECT salary * comission
        FROM Employee
        WHERE jobTitle = ""IT Manager""
        ) AND 
        (jobTitle LIKE '%Manager%')"
34603,3902464,"SELECT e.empName, e.salary * e.comission as Salary_after_Com
FROM Employee e
WHERE e.empID IN (SELECT managerID from Employee)
AND e.salary * e.comission >(SELECT e2.salary * e2.comission from Employee e2 WHERE e2.jobTitle = ""IT Manager"")"
34602,3902464,"SELECT empName, salary*comission
FROM Employee
WHERE salary*comission > (SELECT salary*comission FROM Employee WHERE jobTitle = 'IT Manager')
AND jobTitle LIKE '%Manager'"
124539,3902464,"SELECT Employee.empName, (Employee.salary * Employee.comission) as mul
FROM Employee
WHERE Employee.jobTitle LIKE ""%Manager%""  AND (Employee.salary * Employee.comission) > (SELECT (Employee.salary * Employee.comission) FROM Employee WHERE Employee.jobTitle LIKE ""%IT Manager%"")

"
308057,3902464,"SELECT empName, salary*comission
FROM Employee
WHERE salary*comission > (SELECT salary*comission FROM Employee WHERE jobTitle = ""IT Manager"")
AND jobTitle LIKE ""%Manager""
"
186896,3902464,"SELECT e.empName, e.salary*e.comission
FROM Employee e
WHERE (e.empID = ANY(SELECT DISTINCT e3.managerID
                     FROM Employee e3)) AND 
      ((e.salary*e.comission) > (SELECT e2.Salary*e2.comission
                                 FROM Employee e2
                                 WHERE e2.jobTitle = 'IT Manager'))"
32969,3902464,"select empName, salary * comission as sac
from Employee
where empID in (select distinct managerID
              from Employee) 
              and 
salary * comission > (select salary * comission as sac
                      from Employee 
                      where jobTitle = 'IT Manager')




-- select salary * comission as sac
-- from Employee 
-- where jobTitle = 'IT Manager'"
202279,3902464,"SELECT e.empName, e.salary * e.comission as Salary_after_Com FROM Employee e
WHERE e.empID IN (SELECT managerID FROM Employee) AND
e.salary * e.comission > (SELECT e2.salary * e2.comission as sac FROM Employee e2
WHERE e2.jobTitle=""IT Manager"")"
38065,3902464,"select empName, salary * comission as sac
from Employee
where empID in (select distinct managerID
                from Employee) and salary * comission > (select salary * comission as sac
                                                        from Employee
                                                        where jobTitle = 'IT Manager')


"
5259,3902464,"SELECT empName, salary * comission AS salary_after_commision
FROM Employee
WHERE (salary * comission) > (SELECT salary * comission FROM Employee WHERE jobTitle = 'IT Manager') AND  jobTitle LIKE '%Manager%'"
5265,3902464,"SELECT e.empName, e.salary * e.comission
FROM Employee e 
WHERE e.empID IN (
    SELECT managerID FROM Employee
) AND e.salary * e.comission > (
    SELECT salary * comission FROM Employee WHERE jobTitle = 'IT Manager'
)"
5271,3902464,"SELECT empName, (salary * comission) AS Salary_after_Com
FROM Employee
WHERE (salary * comission) > (SELECT (salary * comission) AS benchmark FROM Employee WHERE jobTitle = ""IT Manager"") AND empID IN (SELECT managerID FROM Employee)"
313213,3902464,"SELECT e.empName, e.salary * e.comission as Salary_after_Com FROM Employee e
WHERE e.empID IN (SELECT managerID FROM Employee) AND
e.salary * e.comission > (SELECT e2.salary * e2.comission as sac FROM Employee e2
WHERE e2.jobTitle=""IT Manager"")
"
332020,3902464,"SELECT empName, salary * comission as sac
FROM Employee
WHERE empID IN (SELECT DISTINCT managerID
FROM Employee) AND salary * comission > (SELECT salary *comission
                                        FROM Employee
                                        WHERE jobTitle= 'IT Manager')"
30765,3902464,"SELECT empName, salary*comission
FROM Employee
WHERE salary*comission>
(SELECT salary*comission
FROM Employee
WHERE jobTitle='IT Manager'
) AND jobTitle LIKE ('%Manager')
"
6575,3902464,"SELECT e.empName, e.salary * e.comission as Salary_after_Com
FROM Employee e
WHERE e.empID IN (SELECT managerID FROM Employee) AND
 e.salary * e.comission > (SELECT e2.salary * e2.comission as sac
FROM Employee e2
WHERE e2.jobTitle=""IT Manager"")"
5256,3902464,"SELECT empName, salary * comission
FROM Department dept NATURAL JOIN Employee emp
WHERE jobTitle LIKE ""%manager"" AND salary * comission > (SELECT salary * comission
                                                     FROM Department dept NATURAL JOIN Employee emp
                                                     WHERE jobTitle = ""IT Manager"")"
33116,3902464,"SELECT Employee.empName, Employee.salary * Employee.comission
FROM (SELECT * 
    FROM Employee
    WHERE Employee.empID in (SELECT Employee.managerID From Employee)) as Employee
WHERE Employee.salary * Employee.comission > (SELECT Employee.salary * Employee.comission FROM Employee WHERE Employee.jobTitle = 'IT Manager')

/* 
Another attempt: 

SELECT Employee.empName, Employee.salary * Employee.comission
FROM (SELECT * 
    FROM Employee
    WHERE Employee.jobTitle like ""%Manager%"") as Employee
WHERE Employee.salary * Employee.comission > (SELECT Employee.salary * Employee.comission FROM Employee WHERE Employee.jobTitle = 'IT Manager')
*/
"
5493,3902464,"SELECT empName, salary * comission as sac 
FROM Employee
WHERE empID IN (SELECT DISTINCT managerID FROM Employee) AND salary * comission > (SELECT salary * comission FROM Employee WHERE jobTitle = 'IT Manager');"
5308,3902464,"SELECT Employee.empName, Employee.salary * Employee.comission
FROM Employee
WHERE (Employee.jobTitle = 'General Manager' OR 
       Employee.jobTitle = 'Operations Manager' OR 
       Employee.jobTitle = 'Sales Manager') AND 
       ((Employee.salary * Employee.comission) > 
       (SELECT Employee.salary * Employee.comission
        FROM Employee
        WHERE Employee.jobTitle = 'IT Manager'))
        "
36050,3902464,"SELECT empName, salary*comission as Salary_after_Com
FROM Employee e natural join Department d
WHERE e.empID IN (SELECT managerID FROM Employee) AND
e.salary * e.comission > 
            (SELECT e2.salary * e2.comission as sac 
            FROM Employee e2
            WHERE e2.jobTitle=""IT Manager"")"
5283,3902464,"SELECT empName, salary * comission as ManagerSalary
FROM Employee
WHERE jobTitle LIKE ""%Manager"" and salary * comission > (SELECT salary * comission as Salary FROM Employee WHERE jobTitle = ""IT Manager"")"
5669,3902464,"SELECT e2.empName, e2.salary* e2.comission FROM Employee e, Employee e2 WHERE e.comission * e.salary < e2.comission * e2.salary and (e.jobTitle = 'IT Manager' and e2.jobTitle <> 'IT Manager') and e2.jobTitle Like '%Manager'; 
"
36849,3902464,"SELECT empName, salary * comission from Employee WHERE jobTitle LIKE ""%Manager%"" AND (salary * comission) > ALL(
    SELECT (salary * comission) FROM Employee WHERE jobTitle=""IT Manager""
);"
34723,3902464,"SELECT empName, salary * comission as sac
FROM Employee
WHERE empID in (SELECT DISTINCT managerID
                FROM Employee) AND 
                salary * comission > (SELECT salary * comission as sac
                                        FROM Employee
                                        WHERE jobTitle = 'IT Manager')


-- -- salary after commision of IT Manager
-- SELECT salary * comission as sac
-- FROM Employee
-- WHERE jobTitle = 'IT Manager'

-- -- list of managers
-- SELECT DISTINCT managerID
-- FROM Employee e

-- -- salary after commision of managers
-- SELECT salary * commision as sac
-- FROM Employee
-- WHERE empID IN (SELECT DISTINCT managerID
--                 FROM Employee)
"
32807,3902464,"SELECT empName, salary * comission
FROM Employee
WHERE (jobTitle LIKE ""%Manager%"") AND (salary * comission > (
    SELECT salary * comission
    FROM Employee
    WHERE jobTitle = ""IT Manager""
))"
5092,3902464,"SELECT e.empName, e.salary*e.comission as Salary_after_Com
FROM Employee e
WHERE e.empID IN (SELECT managerID FROM Employee) AND e.salary*e.comission > (SELECT e2.salary*e2.comission as sac FROM Employee e2 WHERE jobTitle=""IT Manager"")

"
126556,3902464,"SELECT e.empName, (e.salary*e.comission) AS Salary_after_Com
FROM Employee e
WHERE e.jobTitle LIKE ""%Manager"" AND (e.salary*e.comission) > 
    (SELECT m.salary*m.comission FROM Employee m WHERE m.jobTitle = ""IT Manager"")"
313637,3902464,"SELECT emp.empName, emp.salary * emp.comission AS Salary_After_Com
FROM Employee emp 
WHERE emp.empID in (SELECT managerID FROM Employee) AND emp.salary* emp.comission > (SELECT emp2.salary * emp2                                 .comission FROM Employee emp2 WHERE emp2.jobTitle = ""IT Manager"")"
37267,3902464,"SELECT empName, comission*salary
FROM Employee
WHERE jobTitle LIKE '%Manager' and comission*salary > (SELECT comission*salary FROM Employee WHERE jobTitle='IT Manager')"
35116,3902464,"SELECT empName, salary* comission
FROM Employee
WHERE Employee.salary * Employee.comission > (SELECT salary * comission FROM Employee WHERE jobTitle = ""IT Manager"" ) and deptID = 3"
33188,3902464,"SELECT empName, salary*comission 
FROM Employee
WHERE salary*comission > (SELECT salary * comission
                          FROM Employee
                          WHERE jobTitle = 'IT Manager')
      AND empID IN (SELECT managerID FROM Employee) 

"
30481,3902464,"SELECT empName, salary * comission as total_compensation
FROM Employee
WHERE (salary * comission) > (SELECT (salary * comission) as total_compensation
                            FROM Employee
                            WHERE jobTitle LIKE 'IT Manager')
    AND jobTitle LIKE '%Manager%'"
36594,3902464,"SELECT E.empName, E.salary * E.comission
FROM Employee E
     JOIN Department D ON D.deptID = E.deptID
WHERE E.jobTitle LIKE '%Manager'
      AND 
      (SELECT E.salary * E.comission
       FROM Employee E WHERE E.jobTitle LIKE 'IT Manager')
       < 
       (E.salary * E.comission)"
5791,3902464,"select empName, salary * comission as Salary_after_Com
from Employee
where jobTitle like ""%Manager"" and salary * comission > (
    select salary * comission
    from Employee
    where jobTitle = ""IT Manager""
)"
331540,3902464,"Select empName,salary*comission
From Employee 
where jobTitle LIKE ""%Manager"" and jobTitle NOT LIKE ""IT Manager"" and salary*comission >ALL
(Select E.salary*E.comission
from Employee E
where E.jobTitle LIKE ""IT Manager"" )
"
10556,3902464,"SELECT empName, salary*comission as sac
FROM Employee
WHERE empID IN (SELECT DISTINCT managerID
                FROM Employee) AND salary*comission > (SELECT salary*comission as sac
                                                       FROM Employee
                                                       WHERE jobTitle = 'IT Manager')"
33198,3902464,"SELECT e.empName, e.salary * e.comission as Salary_after_Com
FROM Employee e
WHERE e.empID IN (SELECT managerID FROM Employee) AND
 e.salary * e.comission > (SELECT e2.salary * e2.comission as sac
FROM Employee e2
WHERE e2.jobTitle=""IT Manager"")"
124294,3902464,"SELECT empName, salary * comission
FROM Employee
WHERE (salary * comission) > (SELECT (salary * comission) AS salaryAfterComission
FROM Employee
WHERE jobTitle = ""IT Manager"") AND jobTitle LIKE ""%Manager%"""
322502,3902464,"SELECT e.empName, e.salary * e.comission AS Salary_after_Com
FROM Employee e
WHERE e.empID IN (SELECT managerID FROM Employee) 
    AND e.salary * e.comission > (SELECT e2.salary * e2.comission AS sac
                                  FROM Employee e2
                                  WHERE e2.jobTitle = 'IT Manager');"
313665,3902462,"select e.empName, d.deptName
from Employee e natural join Department d
where e.salary > (
    select minSalary
    from Salary_Grade
    where grade = 15
    )
    and e.salary < (
    select maxSalary
    from Salary_Grade
    where grade = 15
    );"
10968,3902462,"SELECT empName, deptName
FROM Employee
INNER JOIN Department ON Employee.deptID = Department.deptID
INNER JOIN Salary_Grade on Salary_Grade.grade = 15
WHERE salary > minSalary AND salary < maxSalary"
11323,3902462,"SELECT e.empName, d.deptName
FROM Employee e JOIN Department d ON (e.deptID = d.deptID)
WHERE e.salary >= (
SELECT minSalary
FROM Salary_Grade
WHERE grade=15
)
AND
e.salary <= (
SELECT maxSalary
FROM Salary_Grade
WHERE grade=15
)

"
37657,3902462,"SELECT empName, deptName FROM Department NATURAL JOIN Employee WHERE Employee.salary >= (SELECT minSalary FROM Salary_Grade WHERE grade=15) and Employee.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade=15)"
125568,3902462,"SELECT empName, deptName FROM Employee
INNER JOIN Department ON Employee.deptID = Department.deptID
WHERE salary > (SELECT minSalary FROM Salary_Grade
WHERE grade = 15) 
AND salary < (SELECT maxSalary FROM Salary_Grade
WHERE grade = 15);"
36038,3902462,"Select E.empName, D.deptName
From Employee E, Department D
where E.deptId = D.deptId and E.salary <= (Select maxSalary from Salary_Grade where grade = 15) and E.salary >= (Select minSalary from Salary_Grade where grade = 15)
"
11485,3902462,"SELECT empName, deptName
FROM Department d JOIN Employee e on d.deptID = e.deptID
WHERE e.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade = 15) && e.salary > (SELECT minSalary FROM Salary_Grade WHERE grade = 15) "
34406,3902462,"SELECT e.empName, d.deptName
FROM Employee e NATURAL JOIN Department d
WHERE e.salary >= 
(SELECT minSalary 
FROM Salary_Grade 
WHERE grade = 15)
AND e.salary <=
(SELECT maxSalary 
FROM Salary_Grade 
WHERE grade = 15)"
342776,3902462,"SELECT E.empName, E.deptName
FROM (SELECT * FROM Employee NATURAL JOIN Department) AS E
WHERE E.salary > (SELECT minSalary FROM Salary_Grade WHERE grade = 15 ) AND E.salary < (SELECT maxSalary FROM Salary_Grade WHERE grade = 15 )"
131080,3902462,"SELECT e.empName, d.deptName
FROM Department d JOIN Employee e ON e.deptID = d.deptID
WHERE e.salary BETWEEN (SELECT minSalary FROM Salary_Grade WHERE grade = 15) AND (SELECT maxSalary FROM Salary_Grade WHERE grade = 15)"
33032,3902462,"Select E.empName, D.deptName
From Employee E, Department D
Where salary >= (Select minSalary
From Salary_Grade
Where grade = 15) 
&& salary <= (Select maxSalary
From Salary_Grade
Where grade = 15)
&& E. deptID = D. deptID"
34549,3902462,"SELECT  DISTINCT emp.empName, dept.deptName
FROM    Employee emp, Department dept
WHERE   (
        SELECT  sal.grade
        FROM    Salary_Grade sal
        WHERE   emp.salary < sal.maxSalary AND emp.salary > sal.minSalary AND sal.grade = 15
        ) AND (
        dept.deptID = emp.deptID
        )"
128458,3902462,"SELECT Employee.empName, Department.deptName FROM Employee, Salary_Grade, Department
   WHERE Salary_Grade.grade = 15
   AND Employee.salary > Salary_Grade.minSalary
   AND Employee.salary < Salary_Grade.maxSalary
   AND Employee.deptID = Department.deptID

   "
34603,3902462,"SELECT e.empName, d.deptNameFROM Employee e JOIN Department d ON e.deptID = d.deptIDWHERE e.salary >= (SELECT minSalary FROM Salary_Grade WHERE grade=15) AND e.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade=15)"
34602,3902462,"SELECT e.empName, d.deptName
FROM Employee e NATURAL JOIN Department d
WHERE e.salary >= (SELECT minSalary FROM Salary_Grade WHERE grade = 15) AND e.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade = 15)"
124539,3902462,"SELECT empName, deptName
FROM Employee NATURAL JOIN Department, Salary_Grade
WHERE (Employee.Salary > Salary_Grade.minSalary AND Employee.Salary < Salary_Grade.maxSalary) AND Salary_Grade.grade = 15


-- SELECT Salary_Grade.grade
-- FROM Salary_Grade
-- WHERE 60000 > Salary_Grade.minSalary AND 60000 < Salary_Grade.maxSalary



"
308057,3902462,"SELECT empName, deptName
FROM Employee NATURAL JOIN Department
WHERE salary >= (SELECT minSalary FROM Salary_Grade WHERE grade = 15)
AND salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade = 15)
    "
186896,3902462,"SELECT e.empName, d.deptName
FROM Employee e Natural JOIN Department d
WHERE (e.Salary >= (SElECT minSalary
                    FROM Salary_Grade s
                    WHERE s.grade = 15)) AND (e.Salary <= (SELECT maxSalary
                                                           FROM Salary_Grade s
                                                           WHERE s.grade = 15));"
32969,3902462,"select e.empName, d.deptName
from Employee e natural join Department d
where e.salary >= (select minSalary
                  from Salary_Grade
                  where grade = 15) and
      e.salary <= (select maxSalary
                   from Salary_Grade
                   where grade = 15)
                   
                   
-- from Employee e join Department d on (e.deptID = d.deptID)

-- select minSalary
-- from Salary_Grade
-- where grade = 15

-- select maxSalary
-- from Salary_Grade
-- where grade = 15"
202279,3902462,"SELECT e.empName, d.deptName
FROM Employee e JOIN Department d ON e.deptID = d.deptID
WHERE e.salary >= (SELECT minSalary FROM Salary_Grade WHERE grade=15) AND e.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade=15)"
7926,3902462,"select empName, deptName
from Employee as A
left join Salary_Grade on salary >= minSalary and salary <= maxSalary
left join Department as B on A.deptID = B.deptID
where grade = 15"
38065,3902462,"select empName, deptName
from Employee natural join Department
where salary >= (select minSalary
                from Salary_Grade
                where grade = 15) and 
        salary <= (select maxSalary
                from Salary_Grade
                where grade = 15) 

-- from Employee e join Department d on e.deptID = d.deptID


-- select minSalary, maxSalary
-- from Salary_Grade
-- where grade = 15;"
33326,3902462,"SELECT Employee.empName, Department.deptName FROM Employee, Department, Salary_Grade
    WHERE Employee.deptID = Department.deptID AND Salary_Grade.grade = 15 AND 
    Employee.salary > Salary_Grade.minSalary AND Employee.salary < Salary_Grade.maxSalary"
36288,3902462,"SELECT emp.empName, dep.deptName
FROM Employee emp join Department dep on emp.deptID = dep.deptID
WHERE emp.salary >= (SELECT minSalary FROM Salary_Grade WHERE grade=15) AND 
emp.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade=15);"
5259,3902462,"SELECT em.EmpName, dep.deptName
FROM Department dep NATURAL JOIN Employee em
WHERE em.salary <= (SELECT maxSalary from Salary_Grade where grade = 15) AND em.salary >= (SELECT minSalary from Salary_Grade where grade = 15);"
5271,3902462,"SELECT e.empName, d.deptName
FROM (Employee e) NATURAL JOIN (Department d)
WHERE e.salary >= (SELECT minSalary FROM Salary_Grade WHERE grade = 15) AND e.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade = 15)"
4769,3902462,"SELECT empName, deptName
FROM Employee emp NATURAL JOIN Department dept
WHERE salary < (SELECT maxSalary FROM Salary_Grade WHERE grade = 15)
  AND salary > (SELECT minSalary FROM Salary_Grade WHERE grade = 15)"
313213,3902462,"select empName, deptName
from Employee natural join Department
where salary >= (select minSalary from Salary_Grade where grade=15)
and salary <= (select maxSalary from Salary_Grade where grade=15)"
332020,3902462,"SELECT e.empName, d.deptName
FROM Employee e NATURAL JOIN Department d
WHERE e.salary >= (SELECT minSalary
                    FROM Salary_Grade
                    WHERE grade=15) AND
                   e.salary<= (SELECT maxSalary
                    FROM Salary_Grade
                    WHERE grade=15)"
30765,3902462,"SELECT emp.empName, dept.deptName
FROM Employee emp, Department dept, Salary_Grade sal
WHERE emp.deptID=dept.deptID AND sal.grade=15 AND emp.salary<=sal.maxSalary AND emp.salary>=sal.minSalary"
5726,3902462,"SELECT e.empName, deptName
FROM Employee e JOIN Department d ON e.deptID=d.deptID
WHERE e.salary >= (SELECT minSalary FROM Salary_Grade WHERE grade=15) AND 
e.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade=15)"
6575,3902462,"SELECT e.empName, d.deptName
FROM Employee e JOIN Department d ON e.deptID = d.deptID
WHERE e.salary >= (SELECT minSalary FROM Salary_Grade WHERE grade=15)
AND e.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade=15)"
5256,3902462,"SELECT empName, deptName
FROM Department dept NATURAL JOIN Employee emp
where 
    salary >= (SELECT minSalary
                    FROM Salary_Grade sg
                    WHERE sg.grade = 15) AND
    salary <= (SELECT maxSalary
                    FROM Salary_Grade sg
                    WHERE sg.grade = 15)"
33116,3902462,"SELECT Employee.empName, Department.deptName
FROM Department, Employee, Salary_Grade
WHERE Employee.Salary < Salary_Grade.maxSalary and Salary_Grade.grade = 15 and Employee.Salary > Salary_Grade.minSalary and Employee.deptID = Department.deptID"
5678,3902462,"SELECT e.empName, d.deptName
FROM Employee e JOIN Department d ON e.deptID = d.deptID
WHERE e.salary >= (SELECT minSalary FROM Salary_Grade WHERE grade = 15) 
AND e.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade = 15)"
36050,3902462,"SELECT empName, deptName
FROM  Salary_Grade g, Employee e natural join Department d 
WHERE (e.salary > g.minSalary and e.salary < g.maxSalary) and (g.grade=15)"
5283,3902462,"SELECT B.empName, A.deptName
FROM Department A, Employee B
WHERE A.deptID = B.deptID and B.salary <= (SELECT maxSalary from Salary_Grade WHERE grade = 15) and B.salary >= (SELECT minSalary from Salary_Grade WHERE grade = 15)"
5669,3902462,"select empName, deptName from (Employee emp JOIN Department dept on emp.deptID = dept.deptID), Salary_Grade where grade = 15 and salary >= minSalary and salary <= maxSalary;"
36849,3902462,"SELECT empName, deptName from (Employee NATURAL JOIN Department as ED) WHERE EXISTS (SELECT * FROM Salary_Grade where grade=15 AND minSalary <= salary AND maxSalary >= salary);
"
5722,3902462,"SELECT Employee.empName, Department.deptName 
FROM Employee
NATURAL JOIN Department
WHERE salary >= (SELECT minSalary
                        FROM Salary_Grade
                        WHERE grade = 15)
    AND salary <= (SELECT maxSalary
                        FROM Salary_Grade
                        WHERE grade = 15); 

"
5092,3902462,"SELECT e.empName, d.deptName 
FROM Employee e NATURAL JOIN Department d JOIN Salary_Grade s ON e.salary > s.minSalary AND e.salary < s.maxSalary
WHERE s.grade = 15"
126556,3902462,"SELECT e.empName, d.deptName
FROM Employee e, Department d, Salary_Grade s
WHERE e.deptID = d.deptID AND s.grade = 15 AND (e.salary > s.MinSalary AND e.salary < s.maxSalary)"
10641,3902462,"select e.empName,d.deptName
from Employee e natural join Department as d
where e.salary >= (
        select minSalary from Salary_Grade where grade=15
)
and e.salary <= (
        select maxSalary from Salary_Grade where grade=15
)"
32153,3902462,"SELECT empName,  deptname
FROM Employee NATURAL JOIN Department
WHERE salary 
    BETWEEN (SELECT minSalary FROM Salary_Grade WHERE grade = 15) 
    AND (SELECT maxSalary FROM Salary_Grade WHERE grade = 15)

/*
SELECT empName,  deptName
FROM Employee NATURAL JOIN Department
WHERE salary > 0*/
"
313637,3902462,"SELECT emp.empName, dpt.deptName
FROM Employee emp NATURAL JOIN Department dpt 
WHERE emp.salary >= (SELECT minSalary FROM Salary_Grade WHERE grade = 15) AND
      emp.salary <= (SELECT maxSalary FROM Salary_Grade WHERE grade = 15) 
"
37267,3902462,"SELECT empName, deptName
FROM Employee NATURAL JOIN Department, (
    SELECT * FROM Salary_Grade WHERE grade = 15
) as grade_15
WHERE Employee.salary >= grade_15.minSalary AND Employee.salary <= grade_15.maxSalary"
35116,3902462,"SELECT  empName, deptName
FROM Department, Employee
WHERE (Department.deptID = Employee.deptID) and Employee.salary > (SELECT minSalary FROM Salary_Grade WHERE grade = 15)and Employee.salary < (SELECT maxSalary FROM Salary_Grade WHERE grade = 15)"
30481,3902462,"SELECT E.empName, D.deptName
FROM Employee E
LEFT OUTER JOIN Department D ON E.deptID = D.deptID
WHERE E.salary >= (SELECT minSalary
                 FROM Salary_Grade
                 WHERE grade = 15)
    AND E.salary <= (select maxSalary
                     FROM Salary_Grade
                     WHERE grade = 15)"
36594,3902462,"SELECT E.empName, D.deptName
FROM Employee E
     JOIN Department D ON D.deptID = E.deptID
WHERE E.salary BETWEEN (SELECT S.minSalary 
                        FROM Salary_Grade S
                        WHERE S.grade = 15)
                        AND
                        (SELECT S.maxSalary
                        FROM Salary_Grade S
                        WHERE S.grade = 15)"
5791,3902462,"select empName, deptName
from Department natural join Employee
where salary >= (
    select minSalary
    from Salary_Grade
    where grade = 15
) and salary <= (
    select maxSalary
    from Salary_Grade
    where grade = 15
)"
331540,3902462,"Select empName, deptName
from Department,Employee,Salary_Grade
where Department.deptID=Employee.deptID and salary>=minSalary and salary<=maxSalary and grade = 15
"
10556,3902462,"SELECT e.empName, d.deptName
FROM Employee e NATURAL JOIN Department d
WHERE e.salary >= (SELECT minSalary
                   FROM Salary_Grade
                   WHERE grade=15) AND
      e.salary <= (SELECT maxSalary
                   FROM Salary_Grade
                   WHERE grade=15)

-- FROM Employee e JOIN Department d ON (e.deptID = d.deptID) -- join bc we want data from both tables"
33198,3902462,"SELECT E.empName, D.deptName
FROM Employee E, Salary_Grade S, Department D
WHERE E.salary < S.maxSalary AND E.salary > S.minSalary AND S.grade = 15 AND E.deptID = D.deptID;"
5233,3902462,"select empName, deptName from Department, Employee where Employee.deptID = Department.deptID and salary >= (select minSalary from Salary_Grade where grade = 15) and salary <= (select maxSalary from Salary_Grade where grade=15)"
5435,3902462,"SELECT E.empName, D.deptName
FROM Employee E 
LEFT JOIN Department D 
ON E.deptID = D.deptID
WHERE E.salary <= (SELECT maxSalary
                    FROM Salary_Grade sg
                    WHERE sg.grade = 15)
    AND E.salary >= (SELECT minSalary
                    FROM Salary_Grade sg
                    WHERE sg.grade = 15)
"
124294,3902462,"SELECT empName, deptName
FROM Department NATURAL JOIN Employee, 
    (SELECT minSalary, maxSalary
    FROM Salary_Grade
    WHERE grade = 15) AS temp
WHERE salary >= temp.minSalary AND salary <= temp.maxSalary"
322502,3902462,"SELECT e.empName, d.deptName
FROM Employee e
JOIN Department d ON e.deptID = d.deptID
WHERE e.salary >= (SELECT minSalary
                   FROM Salary_Grade
                   WHERE grade = 15) 
      AND e.salary <= (SELECT maxSalary
                       FROM Salary_Grade
                       WHERE grade = 15);
      "
36183,3902462,"SELECT e.empName, d.deptName
FROM Employee e JOIN Department d ON (e.deptID = d.deptID)
WHERE e.salary >= (SELECT minSalary
                    FROM Salary_Grade
                    WHERE grade=15) AND 
e.salary <= (SELECT maxSalary
            FROM Salary_Grade
            WHERE grade = 15)
"
37657,3902465,SELECT * FROM Employee e JOIN Salary_Grade s ON (s.grade=13 OR s.grade=12) AND e.salary <= s.maxSalary AND e.salary>= s.minSalary WHERE e.jobTitle= 'IT Support' or e.jobTitle='Sales Rep.'
125568,3902465,"SELECT *
FROM Employee JOIN Salary_Grade 
    ON Employee.salary > Salary_Grade.minSalary AND Employee.salary < Salary_Grade.maxSalary 
WHERE (grade = 12 OR grade = 13) AND (Employee.jobTitle = ""IT Support"" OR Employee.jobTitle = ""Sales Rep."")"
34406,3902465,"SELECT *
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary)
AND s.grade IN (12, 13)
AND e.empID IN
(SELECT empID
FROM Employee 
WHERE jobTitle IN ('IT Support', 'Sales Rep.'))
"
342776,3902465,"SELECT *
FROM Employee e JOIN Salary_Grade s ON (salary > minSalary AND salary < maxSalary)
WHERE (s.grade = 12 OR s.grade = 13) AND (jobTitle = 'IT Support' OR jobTitle = 'Sales Rep.')"
34549,3902465,"SELECT  *
FROM    Employee e, Salary_Grade sal
WHERE   (
   e.salary < sal.maxSalary AND e.salary > sal.minSalary AND (sal.grade = 12 OR sal.grade = 13)
        )
        AND 
        (
        e.jobTitle = 'IT Support' OR e.jobTitle = 'Sales Rep.'    
        )"
34602,3902465,"SELECT *
FROM Employee e JOIN Salary_Grade s
ON e.salary <= s.maxSalary AND e.salary >= s.minSalary
WHERE (jobTitle = 'IT Support' OR jobTitle = 'Sales Rep.') AND (grade = 12 OR grade = 13)"
124539,3902465,"SELECT * 
FROM Employee, Salary_Grade
WHERE 
(Employee.salary > Salary_Grade.minSalary AND Employee.salary < Salary_Grade.maxSalary)
AND (Salary_Grade.grade = 12 OR Salary_Grade.grade = 13) AND (Employee.jobTitle LIKE ""%IT Support%"" OR Employee.jobTitle LIKE ""%Sales Rep.%"")
"
308057,3902465,"SELECT * 
FROM Employee, Salary_Grade
WHERE grade IN (12, 13)
AND salary >= minSalary 
AND salary <= maxSalary
AND jobTitle IN (""IT Support"", ""Sales Rep."")
"
186896,3902465,"SELECT *
FROM Employee e LEFT JOIN Salary_Grade s ON ((e.Salary >= s.minSalary) AND (e.Salary <= s.maxSalary))
WHERE (s.Grade = 12 OR s.Grade = 13) AND (e.jobTitle = 'IT Support' OR e.jobTitle = 'Sales Rep.')"
202279,3902465,"SELECT *
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary) AND s.grade IN (12,13)
AND e.empID IN (SELECT e2.empID
FROM Employee e2
WHERE e.JobTitle IN (""IT Support"", ""Sales Rep.""))"
38065,3902465,"select *
from Employee e join Salary_Grade s on (e.salary >= s.minSalary and e.salary <= s.maxSalary)
where (grade = 12 or grade = 13) and (jobTitle = 'IT Support' or jobTitle = 'Sales Rep.')"
5259,3902465,"SELECT E.*, SG.*
FROM Employee E, Salary_Grade SG
WHERE (E.jobTitle = 'IT Support' OR E.jobTitle = 'Sales Rep.') AND (E.salary <= (SELECT maxSalary from Salary_Grade where grade = 13) AND E.salary >= (SELECT minSalary from Salary_Grade where grade = 12)) AND (SG.minSalary <= E.salary AND SG.maxSalary >= E.salary)
ORDER BY hireDate;"
313213,3902465,"select *
from Employee e,Salary_Grade s
where (e.jobTitle in (""IT Support"", ""Sales Rep."")) and (s.grade in (12, 13)) 
and (e.salary between s.minSalary and s.maxSalary)"
30765,3902465,"SELECT DISTINCT empID, empName, jobTitle, managerID, hireDate, salary, comission, deptID, grade, minSalary, maxSalary
FROM Employee, Salary_Grade
WHERE grade IN (12,13) AND jobTitle IN ('IT Support', 'Sales Rep.') AND salary<=maxSalary AND salary>=minSalary"
6575,3902465,"SELECT *
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary)
AND s.grade IN (12,13)
AND e.JobTitle IN (""IT Support"", ""Sales Rep."")"
5256,3902465,"SELECT DISTINCT *
FROM Employee NATURAL JOIN Salary_Grade
WHERE ((grade = 12 AND salary >= minSalary AND salary <= maxSalary) OR
      (grade = 13 AND salary >= minSalary AND salary <= maxSalary)) AND
      (jobTitle = ""IT Support"" OR jobTitle = ""Sales Rep."")"
5493,3902465,"SELECT * 
FROM Employee JOIN Salary_Grade ON salary <= maxSalary AND salary >= minSalary
WHERE (jobTitle = 'IT Support' OR jobTitle = 'Sales Rep.') AND (grade = 12 OR grade = 13);"
36050,3902465,"SELECT *
FROM Employee e, Salary_Grade g
WHERE (e.salary BETWEEN g.minSalary AND g.maxSalary)
    AND g.grade in (12,13) 
    AND e.jobTitle in (""IT Support"", ""Sales Rep."")"
5283,3902465,"SELECT *
FROM Employee ee Join Salary_Grade sg ON (sg.grade = 12 OR sg.grade = 13) AND ee.salary Between sg.minSalary and sg.maxSalary
WHERE ee.JobTitle = ""IT Support"" or ee.JobTitle = ""Sales Rep."""
5669,3902465,"select * from Employee, Salary_Grade where ((grade = 12 or grade = 13) and (salary >= minSalary and salary <= maxSalary)) and (jobTitle = 'IT Support' or jobTitle = 'Sales Rep.');"
32807,3902465,"SELECT *
FROM Employee e JOIN Salary_Grade sg ON (e.salary >= sg.minSalary) AND (e.salary <= sg.maxSalary)
WHERE (e.jobTitle = ""IT Support"" OR e.jobTitle = ""Sales Rep."") AND (sg.grade = 12 OR sg.grade = 13)
    "
5092,3902465,"SELECT *
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary)
AND s.grade IN (12,13)
AND (e.jobTitle = ""IT Support"" or e.jobTitle=""Sales Rep."")"
126556,3902465,"SELECT *
FROM Employee e, Salary_Grade s
WHERE ((s.grade = 12 AND e.salary > s.minSalary AND e.salary < s.maxSalary) OR (s.grade = 13 AND e.salary > s.minSalary AND e.salary < s.maxSalary)) AND (e.jobTitle = ""IT Support"" OR e.jobTitle = ""Sales Rep."")"
313637,3902465,"SELECT *
FROM Employee e, Salary_Grade sg
WHERE e.jobTitle IN (""IT Support"", ""Sales Rep."") AND e.salary BETWEEN sg.minSalary AND sg.maxSalary AND sg.grade in (12, 13)
      "
37267,3902465,"SELECT DISTINCT *
FROM Employee 
INNER JOIN (SELECT * FROM Salary_Grade WHERE grade = 13) AS grade_13
ON salary > grade_13.minSalary
AND salary < grade_13.maxSalary
WHERE jobTitle = 'IT Support' OR jobTitle = ""Sales Rep.""
UNION
SELECT DISTINCT *
FROM Employee 
INNER JOIN (SELECT * FROM Salary_Grade WHERE grade = 12) AS grade_12
ON salary > grade_12.minSalary
AND salary < grade_12.maxSalary
WHERE jobTitle = 'IT Support' OR jobTitle = ""Sales Rep.""
"
35116,3902465,"SELECT *
FROM (SELECT *
FROM Employee, Salary_Grade
WHERE jobTitle = ""Sales Rep.""or jobTitle = ""IT Support"") as Result
WHERE (Result.grade = 12 or Result.grade = 13)  and Result.salary > Result.minSalary and Result.salary < Result.maxSalary"
37517,3902465,"select * 
from Employee, Salary_Grade
WHERE 
    salary >= minSalary AND salary <= maxSalary AND (jobTitle = 'IT Support' OR jobTitle = 'Sales Rep.') AND (grade = 12 OR grade = 13);
"
30481,3902465,"SELECT *
FROM Employee E LEFT OUTER JOIN Salary_Grade S ON E.salary BETWEEN S.minSalary AND S.maxSalary 
WHERE E.jobTitle IN ('IT Support', 'Sales Rep.') AND S.grade IN (12, 13)
ORDER BY E.empId"
36594,3902465,"SELECT *
FROM Employee E
     JOIN Salary_Grade S ON E.salary BETWEEN S.minSalary AND S.maxSalary
WHERE (E.jobTitle = 'IT Support' OR E.jobTitle = 'Sales Rep.')
      AND 
      E.salary BETWEEN (SELECT S.minSalary 
                        FROM Salary_Grade S
                        WHERE S.grade = 12)
                        AND
                        (SELECT S.maxSalary
                        FROM Salary_Grade S
                        WHERE S.grade = 13)
ORDER BY E.empID"
5791,3902465,"select *
from Employee join Salary_Grade
on salary >= minSalary and salary <= maxSalary
where (grade = 12 or grade = 13)
and (jobTitle = ""IT Support"" or jobTitle = ""Sales Rep."")"
331540,3902465,"Select * 
from Employee,Salary_Grade
where grade IN (12,13) and (jobTitle LIKE 'IT Support' or jobTitle LIKE 'Sales Rep.') and (salary>=minSalary and salary <= maxSalary)"
10556,3902465,"SELECT *
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary)
    AND s.grade IN (12,13)
    AND e.empID IN (SELECT e2.empID
                    FROM Employee e2
                    WHERE e.JobTitle IN (""IT Support"", ""Sales Rep.""))"
33198,3902465,"SELECT *
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary)
AND s.grade IN (12,13)
AND e.empID IN (SELECT e2.empID
FROM Employee e2
WHERE e.JobTitle IN (""IT Support"", ""Sales Rep.""))"
5435,3902465,"SELECT *
FROM Employee e
JOIN Salary_Grade sg
ON e.salary < sg.maxSalary AND e.salary > sg.minSalary
WHERE (e.jobTitle = ""IT Support"" OR e.jobTitle = ""Sales Rep."") AND (grade = 12 OR grade = 13)"
124294,3902465,"SELECT *
FROM Employee e, Salary_Grade s
WHERE e.jobTitle IN ('IT Support', 'Sales Rep.')
    AND ((
        s.grade = 12 AND
        e.salary >= s.minSalary AND
        e.salary <= s.maxSalary
    )
    OR
    (
        s.grade = 13 AND
        e.salary >= s.minSalary AND
        e.salary <= s.maxSalary
    )
    )"
322502,3902465,"SELECT *
FROM Employee e, Salary_Grade s
WHERE (e.salary BETWEEN s.minSalary AND s.maxSalary)
    AND s.grade IN (12, 13)
    AND e.empID IN (SELECT e2.empID
                    FROM Employee e2
                    WHERE e.JobTitle IN ('IT Support', 'Sales Rep.'));"
313665,3893282,"SELECT DISTINCT FirstName,LastName
FROM Students NATURAL JOIN Enrollments
WHERE EXISTS(SELECT * FROM Courses WHERE Enrollments.CRN = Courses.CRN AND Students.Department <> Courses.Department);"
335477,3893282,"select distinct ss.FirstName, ss.LastName
from Students ss, Enrollments ee, Courses cc
where ss.NetId = ee.NetId and ee.CRN=cc.CRN and ss.Department != cc.Department;"
10968,3893282,"SELECT DISTINCT FirstName, LastName
From Students
INNER JOIN Enrollments ON Students.NetId = Enrollments.NetId
INNER JOIN Courses ON Enrollments.CRN = Courses.CRN
WHERE Students.Department <> Courses.Department"
11323,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s natural join Enrollments e
WHERE CRN in 
(
Select CRN
FROM Courses
WHERE Department <> s.Department
)

order by FirstName"
30662,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM 
Students s JOIN Enrollments e ON s.NetId = e.NetId JOIN Courses c ON e.CRN = c.CRN
WHERE (c.Department != s.Department)
"
37657,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s NATURAL JOIN Enrollments e JOIN Courses c on e.CRN = c.CRN
WHERE s.Department != c.Department"
5759,3893282,"Select Distinct S.FirstName, S.LastName
From Students S
Where Exists (Select *
    From Enrollments E Natural Join Courses C
    Where E.NetId = S.NetId And C.Department <> S.Department)
"
85741,3893282,"SELECT FirstName, LastName
FROM Students
WHERE (SELECT COUNT(CRN) FROM Courses WHERE Courses.Department<>Students.Department AND CRN IN (SELECT CRN FROM Enrollments WHERE Enrollments.NetId=Students.NetId))"
125568,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s
JOIN Enrollments e ON s.NetId = e.NetId
JOIN Courses c ON e.CRN = c.CRN
WHERE s.Department <> c.Department"
34820,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s
WHERE EXISTS (SELECT e.NetId FROM Enrollments e WHERE e.NetId = s.NetId AND EXISTS (SELECT c.CRN FROM Courses c WHERE c.CRN = e.CRN AND s.Department <> c.Department));"
36038,3893282,"select distinct FirstName, LastName from Students s
natural join Enrollments e inner join Courses c
on e.CRN = c.CRN
where  (s.department <> c.department)
"
10955,3893282,"Select Distinct Stu.FirstName, Stu.LastName 
From Students Stu
Join Enrollments En on Stu.NetId = En.NetId
Join Courses Cn on En.CRN = Cn.CRN
Where Stu.Department <> Cn.Department"
35862,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s INNER JOIN Enrollments e ON s.NetId = e.NetId
WHERE s.department != (Select Department From Courses c Where c.CRN = e.CRN)"
4915,3893282,"SELECT DISTINCT FirstName, LastName 
FROM Students T1
WHERE ((
SELECT COUNT(*) 
FROM Enrollments NATURAL JOIN Courses
WHERE Department != T1.Department AND NetId = T1.NetId) != 0)
"
33977,3893282,"select distinct FirstName, LastName
from Students s, Enrollments e, Courses c
where s.NetId = e.NetId and e.CRN = c.CRN and s.Department <> c.Department;
"
325288,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s 
WHERE EXISTS (
    SELECT e.NetId
    FROM Enrollments e NATURAL JOIN Courses c
    WHERE e.NetId = s.NetId AND s.Department <> c.Department
    )"
37668,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S
WHERE EXISTS ( SELECT *
               FROM Enrollments, Courses
               WHERE Enrollments.NetId = S.NetId AND
                     Courses.CRN = Enrollments.CRN AND
                     Courses.Department <> S.Department
             )"
128728,3893282,"Select Distinct FirstName, LastName
From (Select FirstName, LastName,  Students.NetId, Courses.Department as course, Students.Department as dept
    From Students, Enrollments, Courses
    Where Students.NetId = Enrollments.NetId and Courses.CRN = Enrollments.CRN  ) as merge
Where merge.dept != merge.course;"
9606,3893282,"Select Distinct s.FirstName, s.LastName
From Students s,  Enrollments e Natural join Courses c
Where s.NetId = e.NetId and s.Department <> c.Department "
34406,3893282,"SELECT FirstName, LastName
FROM Students
WHERE NetID IN
(SELECT DISTINCT(s.NetID)
FROM Students s, Enrollments e, Courses c
WHERE s.NetId = e.NetId
AND e.CRN = c.CRN
AND s.Department <> c.Department)"
342776,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s,
    (SELECT NetId, Department
    FROM Enrollments e JOIN Courses c ON e.CRN = c.CRN) ic
WHERE s.NetId = ic.NetId AND s.Department <> ic.Department;"
7000,3893282,"SELECT DISTINCT S.FirstName, S.LastName 
FROM 
Students S JOIN Enrollments E
    ON S.NetId = E.NetId
JOIN Courses C
    ON E.CRN = C.CRN

WHERE S.Department <> C.Department
"
129745,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Enrollments e
NATURAL JOIN Students s
LEFT JOIN Courses c
ON e.CRN=c.CRN
WHERE c.Department <> s.Department;"
331824,3893282,"SELECT FirstName, LastName
FROM Students S
WHERE NetId IN (
    SELECT DISTINCT NetId FROM Enrollments WHERE CRN IN(
    SELECT CRN FROM Courses WHERE Department <> S.Department))"
31817,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S, Enrollments E, Courses C
WHERE S.NetId = E.NetId AND E.CRN = C.CRN AND S.Department <> C.Department;"
33147,3893282,"SELECT DISTINCT Students.FirstName, Students.LastName
FROM Students, Enrollments, Courses
WHERE Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN and Courses.Department <> Students.Department"
8045,3893282,"SELECT DISTINCT S.FirstName,S.LastName
FROM Students S, Enrollments E, Courses C
WHERE S.NetId = E.NetId AND E.CRN = C.CRN AND S.Department <> C.Department"
9367,3893282,"SELECT DISTINCT
    Students.FirstName,
    Students.LastName

FROM
    Students, Enrollments, Courses

WHERE
    Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN and Courses.Department <> Students.Department"
317203,3893282,"Select Distinct FirstName, LastName
From  Students, Enrollments , Courses
where Students.Department <> Courses.Department and Enrollments.CRN = Courses.CRN and Students.NetId = Enrollments.NetId;
"
32932,3893282,"select S.FirstName, S.LastName
from Students S, Enrollments E, Courses C
where S.NetId = E.NetId and E.CRN = C.CRN and S.Department <> C.Department 
group by S.NetId"
331548,3893282,"select s.FirstName, s.LastName
from Students s left join Enrollments e 
on s.NetId = e.NetId left join Courses c
on e.CRN = c.CRN
where s.Department != c.Department
group by s.NetId"
11481,3893282,"select distinct S.FirstName, S.LastName
from Students S
join Enrollments E on S.NetId=E.NetId
join Courses C on E.CRN=C.CRN
where S.Department<>C.Department"
33032,3893282,"SELECT DISTINCT s.FirstName, s.LastName
From Students s
Where EXISTS 
  (Select*
From Enrollments e, Courses c
Where s.netID = e.NetID and e.CRN = c.CRN and c.Department <> s.Department
  )"
131447,3893282,"SELECT DISTINCT Students.FirstName, Students.LastName
FROM Students
JOIN Enrollments ON Students.NetId = Enrollments.NetId
Join Courses ON Courses.CRN = Enrollments.CRN
WHERE Students.Department NOT LIKE Courses.Department"
34549,3893282,"SELECT DISTINCT  s.FirstName, s.LastName
FROM    (
        SELECT DISTINCT c.Department, e.NetId
        FROM     Enrollments e LEFT JOIN Courses c ON e.CRN = c.CRN
        ) AS joined, Students s
WHERE   s.Department <> joined.Department AND joined.NetId = s.NetId

-- SELECT DISTINCT s.FirstName, s.LastName
-- FROM    Students as s,
--         (
--         SELECT DISTINCT e.NetId, c.Department
--         FROM Enrollments as e, Courses as c
--         WHERE e.CRN = c.CRN
--         ) as e_dept
-- WHERE s.NetId = e_dept.NetId AND s.Department <> e_dept.Department"
32845,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students, (SELECT NetId, Department FROM Enrollments INNER JOIN Courses ON Enrollments.CRN = Courses.CRN) AS DepsOfStudents
WHERE Students.NetId = DepsOfStudents.NetID AND Students.Department <> DepsOfStudents.Department;"
128458,3893282,"SELECT FirstName, LastName FROM Students INNER JOIN Enrollments ON Students.NetId = Enrollments.NetId INNER JOIN Courses ON Enrollments.CRN = Courses.CRN WHERE Courses.Department <> Students.Department
GROUP BY Students.NetId"
37281,3893282,"SELECT DISTINCT FirstName, LastName
FROM Enrollments e INNER JOIN Students s ON s.NetId = e.NetId INNER JOIN Courses c ON e.CRN = c.CRN
WHERE s.Department <> c.Department
"
34603,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM (Students s JOIN  Enrollments e ON s.NetId = e.NetId )
WHERE e.CRN IN (SELECT CRN FROM Courses c WHERE c.Department != s.Department)
"
34415,3893282,"select distinct s.FirstName, s.LastName
from Students s, Enrollments e, Courses c
where s.NetId = e.NetId and e.CRN = c.CRN and s.Department <> c.Department"
5749,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s 
JOIN Enrollments e ON s.NetId = e.NetId
JOIN Courses c on e.CRN = c.CRN
WHERE s.Department <> c.Department;"
127187,3893282,"SELECT DISTINCT FirstName, LastName
FROM Enrollments e JOIN Students s ON s.NetId = e.NetId JOIN Courses c ON c.CRN = e.CRN
WHERE e.NetId = s.NetId AND c.CRN = e.CRN AND s.Department != c.Department;"
34602,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s
NATURAL JOIN Enrollments e
LEFT JOIN Courses c ON e.CRN = c.CRN
WHERE s.Department != c.Department"
124539,3893282,"SELECT DISTINCT Students.FirstName, Students.LastName

FROM Students JOIN Enrollments ON Enrollments.NetId = Students.NetId JOIN Courses ON Courses.CRN = Enrollments.CRN
WHERE Students.Department != Courses.Department
-- ORDER BY temp.FirstName"
33743,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Enrollments E LEFT JOIN Students S
ON E.NetId = S.NetId LEFT JOIN Courses C ON C.CRN=E.CRN
WHERE S.Department <> C.Department"
308057,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s, Enrollments e, Courses c
WHERE s.NetId = e.NetId AND e.CRN = c.CRN AND s.Department <> c.Department"
126177,3893282,"SELECT Distinct Students.FirstName, Students.LastName
FROM Students, Enrollments Natural Join Courses
WHERE Students.NetId = Enrollments.NetId And Students.Department != Courses.Department"
318960,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students S
WHERE EXISTS (  SELECT *
                FROM  Enrollments NATURAL JOIN Courses 
                WHERE S.NetId=NetId AND Department<>S.Department     );
"
30205,3893282,"SELECT DISTINCT x.FirstName, x.LastName
FROM (
SELECT Students.FirstName, Students.LastName, Students.NetId, Students.Department, Courses.Department as ID
FROM Students
INNER JOIN Enrollments ON Students.NetId=Enrollments.NetId 
INNER JOIN Courses ON Enrollments.CRN = Courses.CRN
HAVING Students.Department!=ID ) as x"
12098,3893282,"SELECT DISTINCT temp.FirstName, temp.LastName
FROM (SELECT s.FirstName, s.LastName, s.Department, s.NetId, e.CRN
        FROM Students s JOIN Enrollments e ON s.NetId = e.NetId) as temp
    INNER JOIN Courses c ON temp.CRN = c.CRN
WHERE temp.Department <> c.Department
"
186896,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s, Enrollments e NATURAL JOIN Courses c
WHERE (s.NetId = e.NetId) AND EXISTS(SELECT * FROM Courses WHERE s.Department <> Courses.Department)"
83742,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s
WHERE s.NetId IN 
    (SELECT NetId
        FROM Enrollments e JOIN Courses c
            ON e.CRN = c.CRN
                WHERE s.Department <> c.Department)"
38711,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students LEFT OUTER JOIN Enrollments
    ON Students.NetId = Enrollments.NetId
    LEFT OUTER JOIN Courses
    ON Students.Department <> Courses.Department
WHERE Enrollments.CRN = Courses.CRN;
"
33334,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students  
WHERE EXISTS(

SELECT NetId 
FROM Enrollments Natural JOIN Courses
WHERE (Courses.department != Students.department) AND Students.NetId = Enrollments.NetId
);

"
336531,3893282,"select distinct Students.FirstName, Students.LastName
from Students  join Enrollments  join Courses
on Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN
where   Courses.Department != Students.Department
"
331920,3893282,"SELECT DISTINCT FirstName, LastName
FROM (SELECT * FROM Students st NATURAL JOIN Enrollments en ) AS temp, Courses
WHERE temp.Department <> Courses.Department AND temp.CRN = Courses.CRN"
6193,3893282,"select distinct s.FirstName, s.LastName from Students s join (select e.NetId, c.Department from Enrollments e join Courses c on e.CRN = c.CRN) as ec on s.NetId = ec.NetId where s.Department <> ec.Department"
35368,3893282,"SELECT FirstName, LastName
FROM Students, Enrollments, Courses
WHERE Students.NetId = Enrollments.NetId AND Courses.CRN = Enrollments.CRN AND Courses.Department != Students.Department
GROUP BY FirstName, LastName"
35801,3893282,"select distinct Students.FirstName, Students.LastName
from Students
inner join Enrollments on Students.NetId=Enrollments.NetId
inner join Courses on Enrollments.CRN=Courses.CRN and Courses.Department!=Students.Department"
5498,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s
INNER JOIN Enrollments e ON s.NetId = e.NetId
INNER JOIN Courses c ON e.CRN = c.CRN
WHERE NOT s.Department = c.Department;"
34712,3893282,"select distinct
    FirstName, LastName
from
    Students s, Enrollments e, Courses c
where (s.NetId = e.NetId and e.CRN = c.CRN and s.Department not like c.Department)
"
5467,3893282,"Select DISTINCT Students.FirstName, Students.LastName
FROM Enrollments INNER JOIN Courses ON Enrollments.CRN = Courses.CRN, Students
where Students.NetId = Enrollments.NetId and Courses.Department <> Students.Department"
310293,3893282,"SELECT Distinct s.FirstName, s.LastName FROM

(Students s left Join Enrollments e on s.NetId = e.NetId) right join Courses c on e.CRN = c.CRN

WHERE s.Department != c.Department;"
32969,3893282,"select distinct s.FirstName, s.LastName
from Courses c join Students s on c.Department = s.Department
where exists (select * from Courses natural join Enrollments 
       where s.Department <> Courses .Department and s.NetId = Enrollments.NetId)
"
4397,3893282,"SElECT S.FirstName, S.LastName
FROM Students S 
JOIN Enrollments E on S.NetId = E.NetId
JOIN Courses C on E.CRN = C.CRN
WHERE S.Department <> C.Department
GROUP BY S.NetId"
10699,3893282,"SELECT DISTINCT Students.FirstName, Students.LastName
FROM Students, Courses, Enrollments
WHERE Students.NetId=Enrollments.NetId and Enrollments.CRN=Courses.CRN
and Students.Department <> Courses.Department
"
202279,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S LEFT OUTER JOIN Enrollments E ON S.NetId = E.NetId
LEFT OUTER JOIN Courses C ON C.CRN = E.CRN
WHERE C.Department <> S.Department"
318962,3893282,"select distinct s.FirstName, s.LastName
from Students s, Enrollments e, Courses c
where s.NetId = e.NetId and e.CRN = c.CRN and s.Department <> c.Department"
126834,3893282,"SELECT S.FirstName, S.LastName
FROM Students AS S
WHERE S.NetId IN 
    (SELECT E.NetId
    FROM Students S, Enrollments E, Courses C 
    WHERE S.NetId = E.NetId AND E.CRN = C.CRN AND C.Department <> S.Department);"
7926,3893282,"select FirstName, LastName
from Students as S
left join Enrollments as E on S.NetId = E.NetId
left join Courses as C on E.CRN = C.CRN
where S.Department != C.Department
group by S.NetId"
36316,3893282,"SELECT DISTINCT stud.FirstName, stud.LastName
FROM Students stud
LEFT JOIN (SELECT e.NetId, c.Department FROM Enrollments e NATURAL JOIN Courses c) dept
ON stud.NetId = dept.NetId
WHERE dept.Department <> stud.Department;
"
31860,3893282,"select Students.FirstName, Students.LastName from Students where Students.NetId in (select Students.NetId from Enrollments left join Courses on Courses.CRN = Enrollments.CRN left join Students on Students.NetId = Enrollments.NetId where Students.Department != Courses.Department) group by Students.NetId"
34139,3893282,"SELECT DISTINCT Students.FirstName, Students.LastName
FROM Students
INNER JOIN Enrollments on Enrollments.NetId = Students.NetId
INNER JOIN Courses on Courses.CRN = Enrollments.CRN
WHERE Students.Department <> Courses.Department"
38065,3893282,"select distinct FirstName, LastName
from (Students s natural join Enrollments e) join Courses c on e.CRN = c.CRN
where s.Department != c.Department"
322740,3893282,"SELECT distinct s.FirstName, s.LastName
From Students s natural join Enrollments e join Courses c on e.CRN = c.CRN
where s.Department <> c.Department"
33326,3893282,"SELECT FirstName, LastName
    FROM Students
    WHERE NetId IN (
        SELECT NetId 
        FROM Enrollments NATURAL JOIN Courses
        WHERE Students.Department <> Department
    )"
36288,3893282,"SELECT DISTINCT stu.FirstName, stu.LastName
FROM Students as stu join Enrollments as enr on stu.NetId = enr.NetId join Courses as cou on enr.CRN = cou.CRN
WHERE stu.NetId in (SELECT enr2.NetId FROM Enrollments as enr2 join Courses as cou2 on cou2.CRN = enr2.CRN where cou.Department <> stu.Department);"
33496,3893282,"SELECT FirstName, LastName
FROM Students S
WHERE EXISTS (
    SELECT *
    FROM Enrollments E
    WHERE S.NetId = E.NetId AND E.CRN IN (
        SELECT C.CRN
        FROM Courses C
        WHERE C.Department <> S.Department
    )
)"
34474,3893282,"select DISTINCT v.FirstName, v.LastName from Students v
		JOIN Enrollments as e1 on v.NetID = e1.NetId
		JOIN Courses as c1 on c1.CRN = e1.CRN
		where v.Department != c1.Department"
33327,3893282,"SELECT FirstName, LastName
    FROM
    (
        SELECT FirstName, LastName, Students.NetId as ""NetId"", Department, CRN
        FROM Students RIGHT JOIN Enrollments ON Students.NetId = Enrollments.NetId
    ) a
RIGHT JOIN Courses ON a.CRN = Courses.CRN
WHERE a.Department <> Courses.Department
Group BY NetId
"
5259,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students NATURAL JOIN (SELECT NetId, Department as course_dept FROM Enrollments NATURAL JOIN Courses) AS Course_Dept_Table
WHERE Department != course_dept;"
5265,3893282,"SELECT DISTINCT se.FirstName, se.LastName
FROM (
    SELECT *
    FROM Students s
    NATURAL JOIN Enrollments e
) AS se
JOIN Courses c
ON se.CRN = c.CRN
WHERE se.Department != c.Department"
5503,3893282,"SELECT DISTINCT S.FirstName, S.LastName FROM Students S
INNER JOIN Enrollments E ON E.NetId = S.NetId
INNER JOIN Courses C ON C.CRN = E.CRN
WHERE S.Department <> C.Department"
5271,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Courses c, (SELECT * FROM Students) s Natural Join (SELECT NetId, CRN FROM Enrollments) e
WHERE e.CRN = c.CRN AND s.Department <> c.Department"
324318,3893282,"SELECT DISTINCT s.FirstName, s.LastName 
FROM Students AS s
JOIN Enrollments AS e ON s.NetId = e.NetId
JOIN Courses AS c ON e.CRN = c.CRN 
WHERE s.Department <> c.Department;
"
4769,3893282,"SELECT FirstName, LastName
FROM Students stud JOIN (SELECT NetId, Department
                         FROM Enrollments enro JOIN Courses cour ON enro.CRN = cour.CRN) as EnroCour 
                   ON stud.NetId = EnroCour.NetId
WHERE stud.Department <> EnroCour.Department
GROUP BY stud.NetId"
35385,3893282,"SELECT S.FirstName, S.LastName
FROM Enrollments as E 
INNER JOIN Students as S on S.NetId = E.NetId
INNER JOIN Courses as C on E.CRN = C.CRN
WHERE S.Department <> C.Department
GROUP BY S.NetId"
332195,3893282,"Select DISTINCT FirstName, LastName
From Students s Join (Select NetId, Department
                      From Enrollments e Natural Join Courses c) as temp
    ON s.NetId = temp.NetId
Where s.Department <> temp.Department"
335822,3893282,"select FirstName, LastName
from Students
where NetId in(
select distinct S.NetId
from (Enrollments as E inner join Courses as C on E.CRN = C.CRN) left join Students as S on S.NetId = E.NetId and S.Department != C.Department);"
123787,3893282,"SELECT DISTINCT Students.FirstName, Students.LastName FROM Students JOIN Enrollments ON
Enrollments.NetId = Students.NetId JOIN Courses ON Enrollments.CRN = Courses.CRN 
WHERE Courses.Department <> Students.Department;
"
12089,3893282,"Select Distinct FirstName, LastName
From Students,
    (SELECT NetId, Department
     From   Enrollments, (SELECT CRN, Department
                          FROM Courses) as temp1
     WHERE Enrollments.CRN LIKE temp1.CRN
     ) as temp2
Where Students.NetID like temp2.NetID AND Students.Department Not like temp2.Department"
36117,3893282,"SELECT FirstName, LastName
FROM Students S JOIN (Enrollments E NATURAL JOIN Courses C)
    ON S.NetId = E.NetId
WHERE S.Department <> C.Department
GROUP BY S.NetId;"
33084,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s
WHERE EXISTS(SELECT c.Department FROM Courses c, Enrollments e WHERE s.NetId = e.NetId AND e.CRN = c.CRN AND c.Department <> s.Department)"
7276,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students AS s natural join (select Department as cd, NetId from Enrollments natural join Courses) AS D
Where Department <> cd
"
313213,3893282,"select distinct FirstName, LastName
from Students S join
(select distinct NetId, Department
from Courses natural join Enrollments) as T
on S.NetId=T.NetId and S.Department<>T.Department
"
34660,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students right JOIN Enrollments ON Students.NetId = Enrollments.NetId
WHERE Enrollments.CRN IN (
    SELECT CRN
    FROM Courses
    WHERE Courses.Department <> Students.Department
)
    
    

"
33331,3893282,"Select A.FirstName, A.LastName
From Students A, (Select B.NetId
                  From Students D,Enrollments B Natural Join Courses C
                  Where C.Department != D.Department) as temp1
Where A.NetId = temp1.NetId
Group By A.NetId"
34476,3893282,"select distinct FirstName, LastName from (select t1.NetId,t1.FirstName,t1.LastName,t1.Department as d1, t1.CRN, c.Department as d2 from (select s.NetId, s.FirstName, s.LastName,s.Department,e.CRN from Students s join Enrollments e on s.NetId = e.NetId)as t1 join Courses c on t1.CRN = c.CRN)as t2  where d1 <>d2"
332008,3893282,"select distinct FirstName, LastName from Enrollments, Courses, Students where Enrollments.CRN = Courses.CRN and Students.NetId=Enrollments.NetId and Courses.Department<>Students.Department"
11185,3893282,"select distinct S.FirstName, S.LastName
from ((Enrollments E inner join Students S
                                    on E.NetId = S.NetId) inner join Courses C
                                    on E.CRN = C.CRN)
where S.Department <> C.Department"
5460,3893282,"select S.FirstName, S.LastName
from Students S
where exists (select 1
              from Enrollments E Natural Join Courses C
              where E.NetId = S.NetId and S.Department <> C.Department)
"
30765,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s, Enrollments e, Courses c
WHERE s.NetId=e.NetId and e.CRN=c.CRN and s.Department<>c.Department;"
33739,3893282,"SELECT DISTINCT Students.FirstName, Students.LastName
FROM Students, Enrollments, Courses
WHERE Students.NetId = Enrollments.NetId AND Enrollments.CRN = Courses.CRN AND Courses.Department <> Students.Department"
30542,3893282,"SELECT DISTINCT FirstName, LastName FROM Students NATURAL JOIN Enrollments JOIN Courses ON Enrollments.CRN = Courses.CRN WHERE Students.Department != Courses.Department"
32963,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Enrollments E JOIN Courses C ON E.CRN = C.CRN, Students S
WHERE S.NetId = E.NetId AND S.Department <> C.Department"
5726,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students
INNER JOIN Enrollments on Students.NetId = Enrollments.NetId
INNER JOIN Courses on Enrollments.CRN = Courses.CRN
WHERE Students.Department <> Courses.Department;"
6575,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s, Enrollments e, Courses c
WHERE s.NetId = e.NetId AND e.CRN = c.CRN
AND s.Department Not LIKE c.Department;"
5256,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s NATURAL JOIN Enrollments e JOIN (SELECT c.Department, c.CRN FROM Courses c) tmp ON e.CRN = tmp.CRN
WHERE tmp.Department != s.Department"
12133,3893282,"SELECT DISTINCT S1.FirstName, S1.LastName
FROM ((Enrollments E1
INNER JOIN Courses C1 ON C1.CRN = E1.CRN)
INNER JOIN Students S1 on S1.NetId = E1.NetId)
WHERE S1.Department != C1.Department"
31926,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Enrollments E LEFT JOIN Students S
ON E.NetId = S.NetId LEFT JOIN Courses C ON C.CRN = E.CRN
WHERE S.Department <> C.Department;"
33116,3893282,"SELECT DISTINCT FirstName, LastName
FROM 
(SELECT * 
 FROM Enrollments NATURAL JOIN Courses) as temp JOIN Students
 ON Students.NetId = temp.NetId
WHERE temp.Department != Students.Department"
5493,3893282,"SELECT DISTINCT s.FirstName, s.LastName 
FROM Students s, (SELECT * FROM Enrollments NATURAL JOIN Courses) as d
WHERE s.NetId = d.NetId AND s.Department != d.Department;
"
11941,3893282,"SELECT DISTINCT 
    S.FirstName,
    S.LastName
FROM
    Students S
    JOIN Enrollments E 
        on S.NetId = E.NetId
    JOIN Courses C
        on E.CRN = C.CRN
WHERE
    S.Department <> C.Department"
5678,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s INNER JOIN Enrollments e ON s.NetId = e.NetId
       INNER JOIN Courses c ON e.CRN = c.CRN
WHERE s.Department != c.Department"
86354,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students AS s
INNER JOIN Enrollments AS e ON s.NetId = e.NetId
INNER JOIN Courses AS c ON e.CRN = c.CRN
WHERE s.Department != c.Department;"
5308,3893282,"SELECT FirstName, LastName
FROM Students
WHERE (SELECT COUNT(Courses.Department)
       FROM Courses, Enrollments
       WHERE Courses.CRN = Enrollments.CRN AND 
           Students.NetId = Enrollments.NetId AND 
           Students.Department <> Courses.Department) > 0

"
36050,3893282,"Select Distinct s.FirstName, s.LastName
FROM Students s Natural Join Enrollments e, Courses c
WHERE c.CRN = e.CRN and c.Department != s.Department "
5283,3893282,"SELECT distinct s.FirstName, s.LastName
FROM Students s, Enrollments e, Courses c
WHERE s.NetId = e.NetId and e.CRN = c.CRN and s.Department <> c.Department
"
35941,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students, Enrollments, Courses
WHERE Students.NetId = Enrollments.NetId AND Enrollments.CRN = Courses.CRN AND Students.Department <> Courses.Department
"
34691,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S, Enrollments E, Courses C
WHERE E.NetId = S.NetID and E.CRN = C.CRN and C.Department <> S.Department

"
36051,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S
JOIN Enrollments E ON S.NetId = E.NetId
JOIN Courses C ON E.CRN = C.CRN
WHERE S.Department <> C.Department"
32394,3893282,"SELECT DISTINCT A.FirstName, A.LastName
FROM Students A, Enrollments B, Courses C
WHERE A.NetId = B.NetId AND (A.Department <> C.Department) AND B.CRN = C.CRN
"
5645,3893282,"select DISTINCT FirstName, LastName
from Students s natural join (select Department as course_dep, NetId from Enrollments natural join Courses) c
where Department <> course_dep "
35616,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students S, Enrollments E, Courses C
WHERE S.NetId = E.NetId AND E.CRN = C.CRN AND S.Department <> C.Department"
5669,3893282,"select DISTINCT FirstName, LastName
    from Students s Natural Join Enrollments e 
    Join
        -- Join Courses c on e.CRN = c.CRN
        -- group by FirstName, LastName
        (select c.Department, c.CRN from Courses c) x on e.CRN = x.CRN
    where s.Department <> x.Department
    ;"
331655,3893282,"select FirstName, LastName
from Students S2
where S2.NetId in (select distinct S.NetId
from Students S, Enrollments E, Courses C
where S.netid = E.netid && E.crn = C.crn && S.department != C.department)"
6573,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students S
WHERE EXISTS(SELECT * 
             FROM Enrollments E JOIN Courses C 
             ON E.CRN = C.CRN
             WHERE E.NetId = S.NetId AND S.Department <> C.Department)
"
4370,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s
INNER JOIN Enrollments e ON e.NetId = s.NetId
INNER JOIN Courses c ON c.CRN = e.CRN
WHERE c.Department <> s.Department"
8204,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students S1
WHERE Department<> ANY(SELECT Department FROM Enrollments NATURAL JOIN Courses WHERE NetId=S1.NetId)"
316610,3893282,"select FirstName, LastName
from Students s
where s.NetId in
                (select distinct s1.NetId
                from Students s1, (select distinct e.NetId, c.CRN, c.Department
                                    from Enrollments e join Courses c on (e.CRN=c.CRN)
                                    order by e.NetId) as classes
                where s1.NetId = classes.NetId and s1.Department <> classes.Department
                )"
36849,3893282,"select distinct FirstName, LastName from Students where exists (
    select * from Enrollments natural join Courses where Department!=Students.Department and NetId=Students.NetId
);"
125841,3893282,"select Students.FirstName, Students.LastName
from Students
where exists (
  SELECT Enrollments.NetId, Enrollments.CRN
  FROM Enrollments
  join (
    select Courses.CRN, Courses.Department
    from Courses
  ) as g on g.CRN = Enrollments.CRN
  where Enrollments.NetId = Students.NetId and g.Department <> Students.Department
);"
186898,3893282,"SELECT DISTINCT S.FirstName, S.LastName FROM Students S
JOIN Enrollments E ON S.NetId=E.NetId
JOIN Courses C ON E.CRN=C.CRN
WHERE S.Department <> C.Department

 


"
34723,3893282,"SELECT DISTINCT FirstName, LastName
FROM (Students s NATURAL JOIN Enrollments e) JOIN Courses c ON e.CRN = c.CRN
WHERE 0 < (SELECT COUNT(c.Department)
                            FROM Enrollments e NATURAL JOIN Courses c
                            WHERE e.NetId = s.NetId AND c.Department <> s.Department)"
5126,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S, Enrollments E, Courses C
WHERE S.NetId = E.NetId AND E.CRN = C.CRN AND (S.Department <> C.Department)"
125328,3893282,"select distinct  s.FirstName, s.LastName from Students s
    left join Enrollments e on s.NetId = e.NetId
    left join Courses c on e.CRN = c.CRN
    where (s.Department <> c.Department)"
32807,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s 
    JOIN Enrollments e ON (s.NetId = e.NetId)
    JOIN Courses c ON (e.CRN = c.CRN)
WHERE s.Department <> c.Department"
5130,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s INNER JOIN Enrollments e ON s.NetId = e.NetId INNER JOIN Courses c ON c.CRN = e.CRN
WHERE c.Department != s.Department"
10697,3893282,"SELECT DISTINCT FirstName, LastName
FROM Courses C INNER JOIN Enrollments E on C.CRN = E.CRN INNER JOIN Students S on S.NetId = E.NetId
WHERE S.Department <> C.Department"
5246,3893282,"select distinct FirstName, LastName from Enrollments e natural join Students s join Courses c on e.CRN = c.CRN where s.Department <> c.Department"
5722,3893282,"SELECT DISTINCT Students.FirstName, Students.LastName
FROM Students
NATURAL JOIN Enrollments
JOIN Courses ON Enrollments.CRN = Courses.CRN
WHERE Students.Department != Courses.Department"
5092,3893282,"SELECT DISTINCT s.FirstName, s.LastName 
FROM Students s NATURAL JOIN Enrollments e JOIN Courses c on e.CRN = c.CRN
WHERE c.Department <> s.Department"
126556,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Courses c, Students s, Enrollments e
WHERE s.Department != c.Department AND c.CRN = e.CRN AND s.NetId = e.NetId ORDER BY s.FirstName"
10641,3893282,"select distinct S.FirstName,S.LastName
from (Students S natural join Enrollments E) inner join Courses C on C.CRN = E.CRN
where S.Department <> C.Department"
8171,3893282,"SELECT FirstName, LastName
FROM Students
WHERE NetId in (SELECT S.NetId
    FROM Students AS S, Enrollments AS E, Courses AS C
    WHERE S.NetId = E.NetId
        AND E.CRN = C.CRN
        AND S.Department <> C.Department);"
37573,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S, Enrollments E INNER JOIN Courses C ON E.CRN = C.CRN
WHERE S.NetId = E.NetId AND S.Department <> C.Department; "
32153,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s 
LEFT Join Enrollments e ON s.NetId = e.NetId
LEFT JOIN Courses c
ON e.CRN = c.CRN
WHERE s.Department <> c.Department 
-- ORDER BY s.FirstName, s.LastName"
313637,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S JOIN Enrollments E JOIN Courses C ON S.NetId = E.NetId AND E.CRN = C.CRN AND
                                                                    S.Department <> C.Department
"
130804,3893282,"select distinct s.FirstName, s.LastName
from Students s, Enrollments  e, Courses  c
where s.netid = e.netid and e.crn = c.crn and s.department != c.department"
24839,3893282,"SELECT DISTINCT t.fn as FirstName, t.ln as LastName
FROM
(SELECT s.FirstName as fn, s.LastName as ln, s.Department as dpt, e.CRN as crrn
FROM Students s JOIN Enrollments e on s.NetId = e.NetId) as t JOIN Courses c ON t.crrn = c.CRN
WHERE t.dpt <> c.Department
"
122226,3893282,"SELECT DISTINCT Students.FirstName, Students.LastName FROM Students JOIN Enrollments ON
Students.NetId = Enrollments.NetId JOIN Courses ON Enrollments.CRN = Courses.CRN 
WHERE Courses.Department != Students.Department;"
35048,3893282,"SELECT FirstName, LastName FROM (SELECT DISTINCT FirstName, LastName, NetId FROM Students S NATURAL JOIN Enrollments E, Courses C WHERE S.Department != C.Department ORDER BY FirstName) as temp WHERE temp.NetId in (SELECT NetId FROM(SELECT DISTINCT FirstName, LastName, NetId FROM Students S NATURAL JOIN Enrollments E, Courses C WHERE S.Department = C.Department ORDER BY FirstName) as temp2)"
201123,3893282,"select distinct FirstName, LastName
from ((Students
inner join Enrollments on Students.netId = Enrollments.NetId)
inner join Courses on Enrollments.CRN = Courses.CRN)
where Students.Department != Courses.Department;"
127606,3893282,"select distinct s.FirstName, s.LastName
from Students s, Enrollments e, Courses c
where s.NetId = e.NetId and e.CRN = c.CRN and s.Department <> c.Department;"
37267,3893282,"SELECT DISTINCT FirstName, LastName
FROM (Students inner join Enrollments on Students.NetId = Enrollments.NetId) inner join Courses on Courses.CRN = Enrollments.CRN
WHERE Students.Department <> Courses.Department"
34020,3893282,"SELECT DISTINCT FirstName, LastName 
FROM Students JOIN (SELECT * FROM Enrollments NATURAL JOIN Courses) as EC
ON Students.NetId = EC.NetId
WHERE Students.Department != EC.Department

"
35116,3893282,"SELECT FirstName, LastName
FROM (SELECT DISTINCT St.ID
FROM (SELECT St.ID, D, CRN
FROM (SELECT NetId ID, Department D
FROM Students) as St, Enrollments E
WHERE St.ID = E.NetId) as St, Courses C
WHERE St.CRN = C.CRN and St.D != C.Department) as T, Students
WHERE T.ID = Students.NetId

"
37517,3893282,"select FirstName, LastName
from Students
where EXISTS 
(select * from Enrollments natural join Courses where Students.Department <> Courses.Department
AND Students.NetId = Enrollments.NetId);
"
319746,3893282,"SELECT S.FirstName, S.LastName
FROM Students S
WHERE EXISTS(
SELECT *
FROM Enrollments E LEFT OUTER JOIN Courses C ON E.CRN = C.CRN
Where E.NetID = S.NetID AND C.Department <> S.Department
);"
33188,3893282,"SELECT DISTINCT FirstName,LastName
FROM Students s, Enrollments e, Courses c
WHERE s.Department <> c.Department AND e.CRN = c.CRN AND s.NetId = e.NetId"
30481,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S
NATURAL JOIN Enrollments E
LEFT OUTER JOIN Courses C ON E.CRN = C.CRN
WHERE S.Department <> C.Department"
33375,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s JOIN Enrollments e ON s.NetId = e.NetId JOIN Courses c ON e.CRN = c.CRN
WHERE s.Department != c.Department
"
36594,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S
     JOIN Enrollments E ON S.NetID = E.NetID
     JOIN Courses C ON E.CRN = C.CRN
WHERE S.Department != C.Department"
5753,3893282,"select distinct s.FirstName, s.LastName
from Students s inner join Enrollments e on s.NetId = e.NetId inner join Courses c on e.CRN = c.CRN
where s.Department != c.Department"
337120,3893282,"SELECT DISTINCT FirstName, LastName
FROM (SELECT * FROM Students NATURAL JOIN (SELECT NetId, Department AS CourseDep FROM Enrollments NATURAL JOIN Courses) AS NetId_CourseDep WHERE Students.NetId = NetId_CourseDep.NetId) AS StuCourse
WHERE Department <> CourseDep"
7637,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s JOIN (Enrollments e JOIN Courses c ON e.CRN = c.CRN) ON s.NetID = e.NetID
WHERE c.Department <> s.Department"
37112,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S NATURAL JOIN Enrollments E JOIN Courses C ON (E.CRN = C.CRN)
WHERE S.Department <> C.Department and E.CRN = C.CRN"
5791,3893282,"select FirstName, LastName
from Students
where Department <> any (
    select Department
    from Enrollments natural join Courses
    where NetId = Students.NetId
)"
85373,3893282,"select distinct Students.FirstName, Students.LastName
from Students, Courses, Enrollments
where Students.NetID = Enrollments.NetID and Enrollments.CRN = Courses.CRN and 
    Courses.Department <> Students.Department"
31826,3893282,"SELECT DISTINCT S.FirstName,S.LastName
FROM Students S,Enrollments E, Courses C
Where S.NetId=E.NetId and E.CRN=C.CRN and C.Department!=S.Department"
33758,3893282,"SELECT DISTINCT FirstName, LastName
FROM 
Students JOIN Enrollments ON Students.NetId = Enrollments.NetId JOIN Courses ON Enrollments.CRN = Courses.CRN
WHERE Students.Department <> Courses.Department
 "
30537,3893282,"SELECT DISTINCT st.FirstName, st.LastName
FROM(
SELECT e.NetId, s.FirstName, s.LastName, s.Department, e.CRN
FROM Enrollments e JOIN Students s ON e.NetId = s.NetId  
) AS st
JOIN Courses c ON c.CRN = st.CRN

"
36387,3893282,"SELECT Students.FirstName, Students.LastName
FROM Students
INNER JOIN Enrollments ON Students.NetId = Enrollments.NetId
INNER JOIN Courses ON Enrollments.CRN = Courses.CRN
WHERE Courses.Department <> Students.Department
GROUP BY Students.NetId;"
336388,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students AS s
JOIN (SELECT Enrollments.NetId, Courses.Department
      FROM Enrollments
      JOIN Courses
      ON Enrollments.CRN = Courses.CRN) AS c
ON s.NetId = c.NetId
WHERE (s.Department <> c.Department )"
65042,3893282,"select distinct s.FirstName, s.LastName
from Students s, Courses c join Enrollments e on c.CRN = e.CRN
where s.NetId = e.NetId AND s.Department != c.Department
"
9781,3893282,"SELECT FirstName, LastName
FROM Students stu
WHERE EXISTS(SELECT NetId FROM Enrollments NATURAL JOIN Courses
WHERE Department <> stu.Department AND NetId = stu.NetId)"
33006,3893282,"SELECT DISTINCT Students.FirstName, Students.LastName
FROM Students, Enrollments, Courses
WHERE Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN and Courses.Department <> Students.Department"
33358,3893282,"SELECT DISTINCT a.FirstName, a.LastName
FROM    (SELECT s.FirstName, s.LastName, s.Department AS sd, c.Department AS cd
        FROM Students s, Enrollments e, Courses c
        WHERE s.NetId = e.NetId and e.CRN = c.CRN
        ) As a
WHERE a.sd <> a.cd"
331540,3893282,"Select DISTINCT FirstName,LastName
from Students S,Enrollments E,Courses C
where S.NetId=E.NetId and E.CRN=C.CRN and S.Department!=C.Department

"
10556,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s JOIN Enrollments e ON(s.NetId = e.NetId) JOIN Courses c ON(e.CRN = c.CRN)
WHERE s.Department != c.Department"
322515,3893282,"SELECT 
    DISTINCT S.FirstName, S.LastName
FROM 
    Students S JOIN Enrollments E ON S.NetId = E.NetId
    JOIN Courses C ON C.CRN = E.CRN
WHERE
    C.Department <> S.Department"
130618,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s
WHERE EXISTS (SELECT NetId FROM Enrollments NATURAL JOIN Courses WHERE Courses.Department<>s.Department AND s.NetId = Enrollments.NetId) "
36209,3893282,"SELECT s.FirstName, s.LastName 
    FROM Students s 
    WHERE s.NetId IN
        (SELECT e.NetId 
            FROM Enrollments e 
            JOIN Courses c ON e.CRN = c.CRN 
            WHERE s.NetId = e.NetId and s.Department != c.Department);"
33198,3893282,"SELECT S.FirstName, S.LastName
FROM Students S, Courses C, Enrollments E
WHERE S.Department <> C.Department AND E.NetId = S.NetId AND E.CRN = C.CRN
GROUP BY S.FirstName, S.LastName;"
5233,3893282,"select distinct FirstName, LastName from Students, Enrollments, Courses where Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN and Courses.Department <> Students.Department"
5435,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s
LEFT JOIN (
        SELECT e.NetId, Department AS classDept
        FROM Enrollments e
        LEFT JOIN (
            SELECT CRN, Department
            FROM Courses
        ) AS c
        ON c.CRN = e.CRN
    ) AS enr
ON enr.NetId = s.NetId
WHERE s.Department != classDept
"
35847,3893282,"select distinct s.FirstName, s.LastName
from Students s, Enrollments e inner join Courses c on e.CRN = c.CRN 
where s.NetId = e.NetId and s.Department <> c.Department;"
9782,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s, Enrollments e, Courses c
WHERE  (s.Department NOT LIKE c.Department 
    AND s.NetID = e.NetID
    AND e.CRN = c.CRN)
"
9769,3893282,"select distinct Huge_table.FirstName, Huge_table.LastName
from (select * from Students natural join Enrollments natural join (Select CRN, Department as C_Department from Courses) as T) as Huge_table
where Huge_table.Department <> Huge_table.C_Department"
124294,3893282,"SELECT FirstName, LastName
FROM Students s
WHERE Department <> ANY (
    SELECT Department
    FROM Enrollments NATURAL JOIN Courses
    WHERE s.NetId = NetId
);"
6923,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Students s NATURAL JOIN Enrollments e
WHERE s.Department <> (SELECT c.Department FROM Courses c WHERE c.CRN = e.CRN);"
7426,3893282,"SELECT DISTINCT FirstName, LastName
FROM Students s natural join(select Department as course_dep, NetId from Enrollments natural join Courses) c
WHERE Department <> course_dep"
34391,3893282,"SELECT Students.FirstName, Students.LastName
from Students, Enrollments, Courses
where Students.NetId = Enrollments.NetId and Enrollments.CRN = Courses.CRN and Students.Department <> Courses.Department
group by Students.NetId
"
260731,3893282,"SELECT FirstName, LastName
FROM Students S
WHERE EXISTS (
    SELECT *
    FROM Enrollments E
    WHERE S.NetId = E.NetId AND E.CRN IN (
        SELECT C.CRN
        FROM Courses C
        WHERE C.Department <> S.Department
    )
)"
5768,3893282,"SELECT DISTINCT FirstName, LastName
FROM Courses c JOIN Enrollments e ON e.CRN = c.CRN JOIN Students s ON e.NetId = s.NetId
WHERE s.Department <> c.Department"
322502,3893282,"SELECT DISTINCT S.FirstName, S.LastName
FROM Students S, Enrollments E, Courses C
WHERE S.NetId = E.NetId AND E.CRN = C.CRN AND S.Department != C.Department;"
36183,3893282,"SELECT DISTINCT s.FirstName, s.LastName
FROM Enrollments e 
JOIN Courses c ON (e.CRN = c.CRN)
JOIN Students s ON (s.NetId = e.NetId)  
WHERE(c.Department <> s.Department AND (s.NetId = e.NetId))"
35307,3893282,"SELECT DISTINCT FirstName,LastName
FROM Students s
INNER JOIN Enrollments e ON e.NetId = s.NetId 
INNER JOIN Courses c ON e.CRN = c.CRN
WHERE s.department <> c.department
"
31613,3893282,"SELECT DISTINCT s.FirstName, s.Lastname FROM Students s, Courses c, Enrollments e
WHERE s.NetID = e.NetId AND e.CRN = c.CRN and s.Department <> c.Department
"
313665,3893285,"select A.ProductName, 
(
select count(B.ProductId) from Products B
where B.YearReleased < A.YearReleased and A.BrandName=B.BrandName
) as AB
from Products A
order by ProductName;
"
335477,3893285,"select distinct p.ProductName, COALESCE(tmp.cn, 0 )
from Products p left join (select p1.ProductId, count(p2.ProductId) as cn from Products p1 right join Products p2 on p1.BrandName = p2.BrandName where p1.YearReleased > p2.YearReleased group by p1.ProductId) as tmp on p.ProductId = tmp.ProductId
order by p.ProductName;"
10968,3893285,"SELECT p.ProductName, (SELECT count(YearReleased)
                       FROM Products p2
                       WHERE p.YearReleased > p2.YearReleased AND p.BrandName = p2.BrandName)
FROM Products p
ORDER BY p.ProductName ASC"
11323,3893285,"select p1.ProductName,(
select count(p2.ProductName)
from Products p2
where p1.BrandName = p2.BrandName and p2.YearReleased < p1.YearReleased
-- group by p2.BrandName
-- having count(p2.YearReleased) <= 2010
)
from Products p1
#,YearRelease
-- Name
#having p1.time
order by p1.ProductName"
30662,3893285,"SELECT p.ProductName, (SELECT COUNT(ProductId) FROM Products prod WHERE p.YearReleased>prod.YearReleased AND p.BrandName = prod.BrandName)
FROM (Products p)
ORDER BY p.ProductName"
37657,3893285,"SELECT A.ProductName, (COUNT(*) - 1)
FROM Products A, Products B
WHERE A.BrandName = B.BrandName AND (B.YearReleased < A.YearReleased OR B.ProductName = A.ProductName)
GROUP BY A.ProductId
ORDER BY A.ProductName"
125568,3893285,"Select p1.ProductName, Count(p1.ProductId)-1
From Products p1, Products p2
Where (p1.YearReleased > p2.YearReleased AND p1.BrandName = p2.BrandName) or p1.ProductId = p2.ProductId
Group BY p1.ProductId
ORDER BY p1.ProductName"
34820,3893285,"SELECT p1.ProductName, COUNT(p2.ProductName)
FROM Products p1 LEFT OUTER JOIN Products p2 ON p1.BrandName = p2.BrandName AND p1.YearReleased > p2.YearReleased
GROUP BY p1.ProductName;


"
10955,3893285,"Select Prod.ProductName, (Select count(*) From Products Where Prod.BrandName = BrandName And Prod.YearReleased > YearReleased)
From Products Prod
Order by Prod.ProductName

"
35862,3893285,"SELECT ProductName, (SELECT Count(*) FROM Products b WHERE p.BrandName = b.BrandName and b.YearReleased < p.YearReleased)
FROM Products p
ORDER BY ProductName"
4915,3893285,"SELECT P.ProductName, (
SELECT count(*)
FROM Products P2
WHERE P2.BrandName = P.BrandName
AND P2.YearReleased < P.YearReleased
)
FROM Products P 
ORDER BY P.ProductName



"
11485,3893285,"Select g.name, count(g.p2id)-1
from 
    (
        Select p2.ProductName as name, p1.ProductId as p1id, p2.ProductId as p2id
        from Products p1, Products p2
        WHERE (p1.BrandName=p2.BrandName AND p1.YearReleased < p2.YearReleased) or p1.ProductId = p2.ProductId
    )as g
group by g.p2id
order by g.name ASC

"
325288,3893285,"SELECT p.ProductName as prodname, (SELECT COUNT(*) FROM Products p2 WHERE p.YearReleased > p2.YearReleased AND p.BrandName=p2.BrandName)
FROM Products p
ORDER BY prodname"
37668,3893285,"SELECT P.ProductName, ( SELECT COUNT(*)
                        FROM Products
                        WHERE BrandName = P.BrandName AND
                              YearReleased < P.YearReleased
                      ) AS result
FROM Products P
ORDER BY P.ProductName;"
128728,3893285,"Select Products.ProductName, Coalesce(counts,0)
From Products Left Join (Select  p.ProductName, count(p.ProductName) as counts
from Products p , Products a where p.BrandName = a.BrandName and  p.YearReleased > a.YearReleased
Group By p.ProductName) as q on q.ProductName = Products.ProductName
Order by Products.ProductName;"
9606,3893285,"Select p1.ProductName, (Select count(*) From Products p2
Where p1.BrandName = p2.BrandName and p1.YearReleased > p2.YearReleased)
From Products p1
Order by p1.ProductName
"
34406,3893285,"SELECT p.ProductName,
(SELECT COUNT(*)
FROM Products
WHERE Brandname = p.Brandname
AND YearReleased < p.YearReleased
)
FROM Products p
ORDER BY p.ProductName"
36577,3893285,"SELECT p3.ProductName, coalesce(temp.num, 0)
FROM(SELECT p1.ProductName, COUNT(p2.ProductName) AS num
FROM Products p1, Products p2
WHERE p1.BrandName = p2.BrandName and p1.YearReleased > p2.YearReleased 
GROUP BY p1.ProductName) AS temp RIGHT OUTER JOIN Products p3 ON temp.ProductName = p3.ProductName
ORDER BY p3.ProductName

"
342776,3893285,"SELECT p1.ProductName, COUNT(p2.ProductName)
FROM Products p1 LEFT OUTER JOIN Products p2 ON (p1.YearReleased > p2.YearReleased AND p1.BrandName = p2.BrandName)
GROUP BY p1.ProductName;
"
129745,3893285,"SELECT p.ProductName, (
    SELECT COUNT(*)
    FROM Products p2
    WHERE p2.BrandName=p.BrandName
    AND p2.YearReleased < p.YearReleased
)
FROM Products p
ORDER BY p.ProductName;"
331824,3893285,"SELECT Name1, Name2
FROM (SELECT P.ProductName Name1, count(PP.ProductName) Name2
    FROM Products P
    LEFT JOIN Products PP  -- leftjoin+on 
    ON P.YearReleased > PP.YearReleased AND P.BrandName = PP.BrandName
    GROUP BY Name1) AS A
"
31817,3893285,"SELECT ProductName, (SELECT COUNT(ProductId)
                        FROM Products P2 JOIN Brands B2 ON P2.BrandName = B2.BrandName
                        WHERE P1.YearReleased > P2.YearReleased AND B1.BrandName = B2.BrandName)
FROM Products P1 JOIN Brands B1 ON P1.BrandName = B1.BrandName
ORDER BY ProductName;"
33147,3893285,"SELECT x.ProductName, (SELECT count(*) 
FROM Products p
WHERE p.BrandName = x.BrandName and p.YearReleased < x.YearReleased)
FROM Products x
ORDER by x.ProductName"
317203,3893285,"select ProductName, (select count(ProductId) from Products p2 where p1.BrandName = p2.BrandName and p1.YearReleased > p2.YearReleased)
From Products p1
order by ProductName
;"
32932,3893285,"select p1.ProductName, count(p1.ProductName)-1
from Products p1 join Products p2 on p1.BrandName = p2.BrandName
where p1.YearReleased > p2.YearReleased or p1.ProductName = p2.ProductName
group by p1.ProductName"
331548,3893285,"select a.ProductName, count(b.YearReleased)
from Products a left join Products b
on a.YearReleased > b.YearReleased 
and a.BrandName = b.BrandName
Group by a.ProductName




"
11481,3893285,"Select Prod.ProductName, 
(Select count(*) From Products Where Prod.BrandName = BrandName And Prod.YearReleased > YearReleased)
From Products Prod
Order by Prod.ProductName
"
33032,3893285,"Select p1.ProductName, count(p2.ProductName)
From Products p1 LEFT OUTER JOIN Products p2 ON (p1.BrandName = p2.BrandName && p1.YearReleased > p2.YearReleased)
Group by p1.ProductId
Order by p1.ProductName"
131447,3893285,"SELECT Products.ProductName, (SELECT COUNT(*) FROM Products AS p WHERE p.YearReleased < Products.YearReleased AND p.BrandName = Products.BrandName)
FROM Products
ORDER BY Products.ProductName ASC;"
128458,3893285,"SELECT p.ProductName, (SELECT COUNT(*)
                    FROM Products
                    WHERE Products.BrandName =
                    p.BrandName AND Products.YearReleased < p.YearReleased)
FROM Products p
ORDER BY p.ProductName



"
34603,3893285,"SELECT pr.ProductName, COUNT(a.YearReleased)
FROM Products pr LEFT OUTER JOIN 

(
SELECT p.ProductName , p.YearReleased
FROM Products p JOIN Products p2 ON p.BrandName = p2.BrandName
WHERE (p.YearReleased > p2.YearReleased) 
) a ON pr.ProductName = a.ProductName

GROUP BY pr.ProductName




"
127187,3893285,"SELECT ProductName, (SELECT COUNT(*) FROM Products inside WHERE inside.YearReleased < p1.YearReleased AND inside.BrandName = p1.BrandName)
FROM Products p1
ORDER BY Productname;"
34602,3893285,"SELECT p1.ProductName, SUM(p1.YearReleased > p2.YearReleased)
FROM Products p1
LEFT OUTER JOIN 
(SELECT ProductName, BrandName, YearReleased
FROM Products) AS p2
ON p1.BrandName = p2.BrandName
-- p1.YearReleased > p2.YearReleased
GROUP BY p1.ProductName"
33743,3893285,"SELECT  B.ProductName, (count(A.ProductName)-1)
FROM Products A JOIN Products B
where (A.BrandName = B.BrandName) AND
(A.YearReleased < B.YearReleased) OR (A.ProductName = B.ProductName)
GROUP BY B.ProductName"
308057,3893285,"SELECT p1.ProductName, COUNT(p2.ProductId)
FROM Products p1 LEFT JOIN Products p2
ON p1.BrandName = p2.BrandName AND p2.YearReleased < p1.YearReleased
GROUP BY p1.ProductName"
36304,3893285,"Select p1.ProductName, (Select Count(*) from Products as p2 where p2.YearReleased < p1.YearReleased and p1.BrandName = p2.BrandName) as p3 
from Products as p1
order by p1.ProductName ASC"
126177,3893285,"Select p1.ProductName,  (Select Count(*)
                            From Products p2
                            Where p1.BrandName = p2.BrandName And p2.YearReleased < p1.YearReleased) as theCount
From Products p1
Order By p1.ProductName "
318960,3893285,"SELECT P1.ProductName,COUNT(P2.ProductId)
FROM Products P1 LEFT OUTER JOIN Products P2 ON P1.BrandName=P2.BrandName AND P1.YearReleased > P2.YearReleased
GROUP BY P1.ProductName;
"
30205,3893285,"SELECT Products.ProductName, IFNULL(numbers.freq, 0)
FROM Products 
LEFT JOIN (SELECT final.ProductName, COUNT(*) as freq
FROM (
SELECT Products.ProductName
	FROM 
		(SELECT Products.BrandName as bn1, Products.ProductName as pn1, Products.YearReleased as yr1, x.ProductName, x.YearReleased
		FROM 
			(SELECT * FROM Products) as x, Products
		WHERE Products.YearReleased > x.YearReleased AND Products.BrandName = x.BrandName
	) as fin, Products
	WHERE Products.ProductName = fin.pn1
) as final
GROUP BY final.ProductName ) as numbers
ON numbers.ProductName = Products.ProductName
ORDER BY Products.ProductName"
12098,3893285,"SELECT temp.ProductName, COUNT(temp.second)
FROM 
    (SELECT p.ProductName, p2.ProductName AS second
    FROM Products p LEFT OUTER JOIN Products p2 ON p.BrandName = p2.BrandName AND p.ProductId <> p2.ProductId AND p.YearReleased > p2.YearReleased) as temp
GROUP BY temp.ProductName

"
186896,3893285,"SELECT p1.ProductName, (SELECT Count(*)
                        FROM Products p2
                        WHERE ((p1.BrandName = p2.BrandName) AND 
                        (p1.YearReleased > p2.YearReleased)))
FROM Products p1
ORDER BY p1.ProductName"
83742,3893285,"SELECT p.ProductName, COUNT(p2.ProductName)
FROM Products p LEFT OUTER JOIN Products p2
    ON p.BrandName = p2.BrandName AND p.YearReleased > p2.YearReleased
    GROUP BY p.ProductName;
"
33334,3893285,"SELECT p1.ProductName, COUNT(p2.ProductName)
FROM Products p1 LEFT OUTER JOIN Products p2 
ON (p2.YearReleased < p1.YearReleased) AND (p2.BrandName = p1.BrandName)
GROUP by p1.ProductName"
336531,3893285,"select new_table.ProductName, COALESCE(old_table.sum, 0 )
from
(select C.ProductId,C.ProductName from Products C) new_table
left outer join 
(select A.ProductId, count(*) as sum
from
Products A, Products B
where A.YearReleased>B.YearReleased and A.BrandName=B.BrandName
group by A.ProductId) old_table

on new_table.ProductId=old_table.ProductId
order by new_table.ProductName
"
331920,3893285,"SELECT cur.ProductName, Count(pre.ProductName)
FROM Products AS cur
LEFT JOIN Products AS pre
ON (cur.BrandName = pre.BrandName AND cur.YearReleased > pre.YearReleased) 
Group BY cur.ProductName"
6193,3893285,"select pp.ProductName ,IFNULL(tb.temp_sum, 0) from Products pp left join (select pro.ProductName, sum(a.total) as temp_sum from Products pro join  (select p.BrandName, p.YearReleased, count(1) as total from Products p group by p.BrandName, p.YearReleased) as a on pro.BrandName = a.BrandName where pro.YearReleased > a.YearReleased  group by pro.ProductName ) as tb on pp.ProductName = tb.ProductName order by pp.ProductName"
35368,3893285,"SELECT ProductName, COALESCE(temp.cnt, 0)
FROM Products
LEFT JOIN (
    SELECT prod1.ProductName as name, count(prod2.ProductName) as cnt
    FROM Products prod1, Products prod2
    WHERE prod1.YearReleased > prod2.YearReleased
    AND prod1.BrandName = prod2.BrandName
    GROUP BY prod1.ProductName
) as temp
ON temp.name = Products.ProductName
ORDER BY ProductName"
35801,3893285,"select distinct a.ProductName, count(b.YearReleased < a.YearReleased)
from Products a
left join Products b on a.BrandName=b.BrandName and b.YearReleased < a.YearReleased
group by ProductName
order by ProductName;"
5498,3893285,"SELECT pro.ProductName, COUNT(p.ProductId) as olderProducts
FROM Products pro
LEFT OUTER JOIN (SELECT p1.ProductId FROM Products p1, Products p2 WHERE p1.BrandName = p2.BrandName AND p1.YearReleased > p2.YearReleased) p ON pro.ProductId = p.ProductId
GROUP BY pro.ProductId
ORDER BY pro.ProductName;"
34712,3893285,"select distinct
    p.ProductName, ifnull (pc.prodCnt, 0)
from
    Products p
    left outer join
    (select
        p.ProductId, count(*) prodCnt
    from
        Products p, Products p2
    where p.YearReleased > p2.YearReleased and p.BrandName = p2.BrandName and p.ProductId not like p2.ProductId
    group by p.ProductId
    ) pc
    on pc.ProductId = p.ProductId
order by p.ProductName"
5467,3893285,"SELECT Products.ProductName,  (SELECT count(*) from Products P where Products.BrandName = BrandName and Products.YearReleased > YearReleased) c
from Products
order by ProductName asc
"
313229,3893285,"SELECT p1.ProductName, Count(p2.ProductId)
FROM Products p1 LEFT OUTER JOIN Products p2 
    ON p1.BrandName = p2.BrandName AND p1.YearReleased > p2.YearReleased
GROUP BY p1.ProductId
ORDER BY p1.ProductName

-- SELECT * FROM Products p1 JOIN Products p2 ON p1.BrandName = p2.BrandName"
310293,3893285,"select p1.ProductName, count(p2.ProductId) from
    Products p1 left join Products p2 on p1.BrandName = p2.BrandName and p1.YearReleased > p2.YearReleased group by p1.ProductId, p1.ProductName order by p1.ProductName;"
5739,3893285,"SELECT a.ProductName,SUM(
    if(a.YearReleased > b.YearReleased, 1, 0))
FROM Products a
LEFT JOIN Products b ON a.BrandName = b.BrandName
WHERE a.BrandName = b.BrandName
GROUP BY a.ProductName 
"
32969,3893285,"select p1.ProductName, count(p1.ProductName) - 1
from Products p1 join Products p2 on p1.BrandName = p2.BrandName
where p1.YearReleased > p2.YearReleased or p1.ProductName = p2.ProductName
group by p1.ProductName
"
4397,3893285,"SELECT P.ProductName, (SELECT count(*) 
                  FROM Products 
                  WHERE (P.BrandName = BrandName) AND (P.YearReleased > YearReleased))
From Products P
ORDER BY P.ProductName"
33861,3893285,"SELECT ProductName, COALESCE(c, 0)
FROM Products
LEFT JOIN (
        SELECT p1.ProductName AS Prod1, COUNT(p1.ProductId) AS c
        FROM Products p1, Products p2
        WHERE p2.YearReleased < p1.YearReleased
        AND p1.BrandName = p2.BrandName
        GROUP BY Prod1
    ) AS inner_table ON Products.ProductName = inner_table.Prod1
ORDER BY ProductName ASC
"
10699,3893285,"Select p.ProductName, (Select count(*) From Products Where p.BrandName = BrandName And p.YearReleased > YearReleased)
From Products p
Order by p.ProductName"
318962,3893285,"select a.ProductName, 
    (select count(*)
     from Products as b
     where a.BrandName = b.BrandName and a.YearReleased > b.YearReleased)
from Products as a
order by a.ProductName"
126834,3893285,"SELECT P.ProductName, COUNT(P.ProductName) - 1
FROM Products P, (SELECT * FROM Products) AS TEMP
WHERE P.BrandName = TEMP.BrandName AND (P.YearReleased > TEMP.YearReleased OR P.ProductName = TEMP.ProductName)
GROUP BY P.ProductName
"
7926,3893285,"select P.ProductName, count(P.ProductName) - 1
from Products as P 
join Products as PP on (P.BrandName = PP.BrandName and P.YearReleased > PP.YearReleased) or
(P.BrandName = PP.BrandName and P.ProductName = PP.ProductName)
group by P.ProductName"
36316,3893285,"SELECT p1.ProductName AS curr_prod, (SELECT COUNT(p1.ProductName) FROM Products p1, Products p2 WHERE p1.ProductName = curr_prod AND p1.YearReleased > p2.YearReleased AND p1.BrandName = p2.BrandName)
FROM Products p1, Products p2
WHERE p1.BrandName = p2.BrandName
GROUP BY p1.ProductName;"
31860,3893285,"select Products.ProductName, coalesce(x.c, 0) from Products left join (select a.ProductName as p, count(*) as c from Products a left outer join Products b on a.BrandName = b.BrandName where a.YearReleased > b.YearReleased group by a.ProductName) x on x.p = Products.ProductName order by Products.ProductName asc"
34139,3893285,"SELECT awk1.ProductName, COUNT(awk2.ProductName)
FROM Products AS awk1
left join Products AS awk2 on awk1.BrandName = awk2.BrandName AND awk1.YearReleased > awk2.YearReleased
GROUP BY awk1.ProductName"
38065,3893285,"select ProductName, (select count(*)
                    from Products p2
                    where p2.YearReleased < p1.YearReleased and p2.BrandName = p1.BrandName)
from Products p1
order by p1.ProductName"
322740,3893285,"select a.ProductName, count(b.YearReleased)
from Products a
left join Products as b 
on a.BrandName = b.BrandName and a.YearReleased > b.YearReleased
group by a.ProductName"
33326,3893285,"SELECT ProductName,
    (SELECT COUNT(ProductName) FROM Products AS P2
        WHERE Products.YearReleased > P2.YearReleased AND Products.BrandName = P2.BrandName)
    FROM Products
    ORDER BY ProductName"
36288,3893285,"SELECT prod.ProductName, (SELECT COUNT(prod2.ProductId) FROM Products as prod2 WHERE prod.BrandName = prod2.BrandName AND prod2.YearReleased < prod.YearReleased)
FROM Products as prod
ORDER BY prod.ProductName;"
33496,3893285,"SELECT A.ProductName, COUNT(B.ProductId)
FROM Products A
LEFT JOIN Products B ON A.BrandName = B.BrandName AND A.YearReleased > B.YearReleased
GROUP BY A.ProductId
ORDER BY A.ProductName;"
34474,3893285,"select a.ProductName, (select count(1) from Products as a1 where a.BrandName = a1.BrandName and a1.YearReleased < a.YearReleased ) as num from Products a ORDER BY a.ProductName"
5259,3893285,"SELECT ProductName, 0 as count_before
FROM Products 
WHERE ProductName NOT IN (SELECT p1.ProductName FROM Products p1, Products p2 WHERE p1.YearReleased > p2.YearReleased AND p1.BRANDNAME = p2.BRANDNAME GROUP BY p1.ProductName)
UNION ALL
SELECT p1.ProductName as ProductName, count(p2.ProductName) as count_before
FROM Products p1, Products p2 
WHERE p1.YearReleased > p2.YearReleased AND p1.BRANDNAME = p2.BRANDNAME 
GROUP BY p1.ProductName
ORDER BY ProductName;"
5265,3893285,"SELECT p.ProductName, (
    SELECT COUNT(*)
    FROM Products p1
    WHERE p1.YearReleased < p.YearReleased
    AND p.BrandName = p1.BrandName
)
FROM Products p
ORDER BY p.ProductName"
5503,3893285,"SELECT P.ProductName, COUNT(RealCounts.ProductId) FROM Products P
LEFT OUTER JOIN
(SELECT P1.ProductId FROM Products P1, Products P2
WHERE P1.YearReleased > P2.YearReleased AND P1.BrandName = P2.BrandName) as RealCounts
ON P.ProductId = RealCounts.ProductId
GROUP BY P.ProductId
ORDER BY P.ProductName"
5271,3893285,"SELECT p1.ProductName, SUM(p1.YearReleased > p2.YearReleased)
FROM Products p1 LEFT OUTER JOIN Products p2 ON p1.BrandName = p2.BrandName
GROUP BY p1.ProductName"
4769,3893285,"SELECT new.ProductName, COUNT(old.ProductId)-1
FROM Products new, Products old
WHERE (new.YearReleased > old.YearReleased and new.BrandName = old.BrandName) or (new.YearReleased = old.YearReleased and new.ProductName = old.productName)
GROUP BY new.ProductName"
35385,3893285,"SELECT P1.ProductName, 
(SELECT COUNT(*) FROM Products as P2 
WHERE P1.BrandName = P2.BrandName 
AND P2.YearReleased < P1.YearReleased)
FROM Products as P1
ORDER BY P1.ProductName"
332195,3893285,"Select ProductName, (Select Count(*) 
                    From Products temp 
                    Where BrandName = Current.BrandName AND 
                    Current.YearReleased > YearReleased )
From Products Current
Order By ProductName"
335822,3893285,"select P.ProductName, count(Q.ProductId)
from Products as P left join Products as Q on P.YearReleased > Q.YearReleased and P.BrandName = Q.BrandName
group by P.ProductName;"
36117,3893285,"SELECT new.ProductName, COUNT(prior.ProductId)
FROM Products new LEFT OUTER JOIN Products prior
    ON new.BrandName = prior.BrandName AND new.YearReleased > prior.YearReleased
GROUP BY new.ProductId
ORDER BY new.ProductName;"
33084,3893285,"select p7.ProductName, ifnull(p6.cts, 0)
from Products p7
LEFT JOIN
(select p3.ProductName, p4.cts
from Products p3, (select p5.ProductName,count(p5.bProductId) as cts
from (select p1.ProductName, p2.ProductId as bProductId
from Products p1, Products p2
where p1.BrandName = p2.BrandName and p1.YearReleased > p2.YearReleased) p5
group by p5.ProductName) p4
where p3.ProductName = p4.ProductName) p6
on p7.ProductName = p6.ProductName
order by p7.ProductName"
7276,3893285,"SELECT ProductName, 
(SELECT COUNT(*)
    FROM Products AS p2
    WHERE p2.YearReleased < p.YearReleased and p2.BrandName = p.BrandName
    
)
FROM Products AS p
ORDER BY ProductName;"
313213,3893285,"select p1.ProductName, count(p2.ProductId)
from
(Products p1 left join Products p2
on p1.BrandName=p2.BrandName and p1.YearReleased > p2.YearReleased)
group by p1.ProductId
order by p1.ProductName
"
34660,3893285,"SELECT a.ProductName, (
    SELECT COUNT(b.ProductId)
    FROM Products b
    WHERE a.YearReleased > b.YearReleased AND a.BrandName = b.BrandName)
FROM Products a
ORDER BY ProductName ASC"
33331,3893285,"Select A.ProductName, Count(B.YearReleased)
From Products A Left Outer Join Products B
    on A.YearReleased > B.YearReleased and A.BrandName = B.BrandName
Group By A.ProductName




"
34476,3893285,"select p3.ProductName, coalesce ( tb1.ct,0) from (select p1.ProductName, count(p2.ProductName) as ct from Products p1, Products p2 where p2.BrandName = p1.Brandname and p2.YearReleased < p1.YearReleased group by p1.ProductName) as tb1 right outer join Products p3 on tb1.ProductName = p3.ProductName order by p3.ProductName asc"
11185,3893285,"select P1.ProductName,(select count(P2.ProductId)
                     from Products P2
                     where P2.YearReleased < P1.YearReleased and P1.BrandName = P2.BrandName)
from Products P1
order by P1.ProductName  "
5460,3893285,"select P.ProductName, (select count(*) from Products C where C.YearReleased < P.YearReleased and C.BrandName = P.BrandName) as _prodCount
from Products P
order by P.ProductName ASC;"
30765,3893285,"SELECT new.ProductName, COUNT(old.ProductId)
FROM Products old
RIGHT OUTER JOIN Products new
ON old.BrandName=new.BrandName AND new.YearReleased > old.YearReleased 
GROUP BY new.ProductName;
"
33739,3893285,"SELECT Products.ProductName, COALESCE(op, 0)
FROM Products
LEFT JOIN (
    SELECT now.ProductName as help1, COUNT(old.ProductId) as op
    FROM Products now, Products old
    WHERE now.BrandName = old.BrandName AND now.YearReleased > old.YearReleased GROUP BY now.ProductName
    ) AS gg ON Products.ProductName = gg.help1
ORDER BY ProductName



"
30542,3893285,"SELECT ProductName, counts 
FROM (SELECT ProductName, BrandName, 
    (SELECT COUNT(ProductName) 
    FROM Products 
    WHERE T1.YearReleased > YearReleased AND T1.BrandName = BrandName) AS counts
FROM Products AS T1) AS T2
ORDER BY ProductName"
32963,3893285,"SELECT P1.ProductName, COALESCE((SELECT COUNT(*)
						FROM Products P2
						WHERE P1.BrandName = P2.BrandName AND P1.ProductName <> P2.ProductName AND P2.YearReleased < P1.YearReleased
                        GROUP BY P2.BrandName), 0)
FROM Products P1
ORDER BY P1.ProductName;"
5726,3893285,"SELECT pr1.ProductName, COUNT(pr2.ProductId)
FROM Products pr1
LEFT OUTER JOIN Products pr2 
ON pr1.BrandName = pr2.BrandName
AND pr1.YearReleased > pr2.YearReleased
GROUP BY pr1.ProductName"
5256,3893285,"SELECT p.ProductName, (SELECT COUNT(p2.YearReleased)
                       FROM Products p2
                       WHERE p2.YearReleased < p.YearReleased AND p2.BrandName = p.BrandName)
FROM Products p
ORDER BY p.ProductName"
12133,3893285,"SELECT P1.ProductName, (
    SELECT COUNT(P2.ProductId)
    FROM (Products P2 INNER JOIN Brands B2 ON B2.BrandName = P2.BrandName)
    WHERE P2.YearReleased < P1.YearReleased AND P1.BrandName = P2.BrandName
)
FROM Products P1
ORDER BY P1.ProductName"
31926,3893285,"SELECT P.ProductName, COUNT(P.YearReleased > Pr.YearReleased) - 1
FROM Products P JOIN Products Pr
ON P.BrandName = Pr.BrandName
WHERE (P.YearReleased > Pr.YearReleased) OR (P.ProductName = Pr.ProductName)
GROUP BY P.ProductName;"
11941,3893285,"SELECT
    P.ProductName,
    ifnull(t.cnt, 0)
FROM 
    Products P 
    LEFT OUTER JOIN 
    (SELECT
        P.ProductId,
        count(*) as cnt
    FROM
        Products P,
        Products PP
    WHERE 
        P.YearReleased > PP.YearReleased
        AND
        P.BrandName = PP.BrandName
        AND
        P.ProductId <> PP.ProductId
    GROUP by
        P.ProductId
    ) as t
        on P.ProductId = t.ProductId
ORDER by
    P.ProductName
        

    "
5678,3893285,"SELECT ProductName, (SELECT COUNT(*)
                    FROM Products a
                    WHERE p.YearReleased > a.YearReleased AND p.BrandName = a.BrandName)
                    
FROM Products p
ORDER BY ProductName
"
86354,3893285,"SELECT
p.ProductName,
SUM(CASE WHEN p.YearReleased > old.YearReleased then 1 else 0 end) as Products_released_before
FROM Products AS p
LEFT JOIN Products AS old ON p.YearReleased > old.YearReleased AND p.BrandName = old.BrandName
group by p.ProductName;"
34727,3893285,"Select  p1.ProductName,  Count(p2.ProductId) - 1
From Products p1,  Products p2
-- on  
-- p1.ProductId <> p2.ProductId
Where  (p1.BrandName = p2.BrandName and p1.YearReleased > p2.YearReleased) or p1.ProductName = p2.ProductName
Group by p1.ProductId
order by p1.ProductName"
5308,3893285,"SELECT a.ProductName, (SELECT COUNT(*) FROM Products b WHERE a.BrandName = b.BrandName AND a.YearReleased > b.YearReleased)
FROM Products a
#LEFT JOIN Products b ON a.BrandName = b.BrandName
#GROUP BY a.ProductName
ORDER BY a.ProductName

/**
 put a.YearReleased > b.YearReleased somewhere else? it's filtering out results with 0
 because those results don't have a.YearReleased > b.YearReleased
*/"
36050,3893285,"SELECT p1.ProductName, Count(p2.ProductId) as p2Previous_Products
FROM Products as p1 
    LEFT OUTER JOIN Products as p2 
      ON (p1.BrandName = p2.BrandName 
     AND p1.YearReleased > p2.YearReleased)
GROUP BY p1.ProductName, p1.ProductId
"
5283,3893285,"SELECT p.ProductName, Count(p1.ProductName)
FROM Products p LEFT OUTER JOIN Products p1 ON (p.YearReleased > p1.YearReleased) AND (p.BrandName = p1.BrandName)
Group By p.ProductName"
35941,3893285,"SELECT ProductName, COALESCE(c, 0)
FROM Products
LEFT JOIN (
        SELECT p1.ProductName AS Prod1, COUNT(p1.ProductId) AS c
        FROM Products p1, Products p2
        WHERE p2.YearReleased < p1.YearReleased
        AND p1.BrandName = p2.BrandName
        GROUP BY Prod1
    ) AS inner_table ON Products.ProductName = inner_table.Prod1
ORDER BY ProductName ASC
"
34691,3893285,"SELECT A.ProductName, SUM(CASE WHEN (A.YearReleased > B.YearReleased AND A.BrandName = B.BrandName)  THEN 1 ELSE 0 END)
FROM Products A, Products B
GROUP BY A.ProductName"
36051,3893285,"SELECT P1.ProductName, COUNT(P1.ProductName) - 1
FROM Products P1 JOIN Products P2 ON P1.BrandName = P2.BrandName
WHERE P2.YearReleased < P1.YearReleased OR P1.ProductName = P2.ProductName
GROUP BY P1.ProductName;
"
32394,3893285,"Select A.ProductName, Count(B.YearReleased)
From Products A left outer join Products B on A.YearReleased > B.YearReleased and A.BrandName = B.BrandName
Group by A.ProductName

-- SELECT A.FirstName, A.LastName, A.NetID, SUM(B.Credits)
-- FROM Students A, Enrollments B
-- WHERE A.NetId = B.NetId
-- Group BY B.NetId 
-- Having SUM(B.Credits)>12
-- ORDER BY SUM(B.Credits) DESC, A.FirstName
"
5645,3893285,"select ProductName, 
(select count(*)
  from Products Pro2
  where Pro2.YearReleased < Pro.YearReleased and Pro2.BrandName = Pro.BrandName)
from Products Pro
order by ProductName"
35616,3893285,"SELECT ProductName, COALESCE(ct, 0)
FROM Products P
LEFT JOIN (
    SELECT P1.ProductName AS prodName, COUNT(P1.ProductId) AS ct
    FROM Products P1, Products P2
    WHERE P2.YearReleased < P1.YearReleased AND P1.BrandName = P2.BrandName
    GROUP BY prodName
) AS prevProd ON P.ProductName = prevProd.prodName
ORDER BY ProductName ASC"
5669,3893285,"select p.ProductName, (select count(p2.YearReleased) from Products p2 where p.YearReleased > p2.YearReleased and p.BrandName = p2.BrandName) 
from Products p 
order by p.productName
-- having p.YearReleased > p2.YearReleased;
-- where p.YearReleased < b.YearEstablished
-- group by p.ProductName
;"
331655,3893285,"SELECT t1.ProductName, 
  (SELECT count(t2.ProductId)
   FROM Products t2  
   WHERE t1.YearReleased > t2.YearReleased AND t1.BrandName = t2.BrandName
   ) AS number_product_release_early 
FROM Products t1 
order by t1.ProductName"
6573,3893285,"SELECT ProductName, (SELECT COUNT(DISTINCT ProductId)
                FROM Products B
                WHERE B.YearReleased < A.YearReleased and B.BrandName = A.BrandName ) 
From Products A
ORDER BY LOWER(ProductName);


                
"
4370,3893285,"SELECT C.ProductName, (SELECT COUNT(D.ProductName) FROM Products D WHERE D.YearReleased < C.YearReleased AND C.BrandName = D.BrandName)
FROM Products C
ORDER BY C.ProductName;"
8204,3893285,"SELECT ProductName, (SELECT Count(*) From Products P2 Where P2.BrandName=P1.BrandName and P2.YearReleased < P1.YearReleased)
FROM Products P1
ORDER BY ProductName"
36849,3893285,"select ProductName, (
    select count(*) from Products where YearReleased < Current.YearReleased and BrandName=Current.BrandName
)
from Products as Current
order by ProductName;"
186898,3893285,"SELECT Prod.ProductName, SUM(Prod.YearReleased > Prod1.YearReleased) FROM Products Prod
JOIN Products Prod1 ON Prod.BrandName = Prod1.BrandName
GROUP BY Prod.ProductName"
34723,3893285,"select 
  t.ProductName,
  (select count(*) from Products where BrandName = t.BrandName AND YearReleased < t.YearReleased) count
from Products t
order by ProductName"
5126,3893285,"SELECT P.ProductName, count(P.BrandName)-1
FROM Products P, Products P2
WHERE P.BrandName = P2.BrandName AND (P.YearReleased > P2.YearReleased  OR 
    (P.ProductId = P2.ProductId AND P.YearReleased = P2.YearReleased))
GROUP BY P.ProductName"
125328,3893285,"select ProductName,(Select count(*) from Products b where a.BrandName=b.BrandName and b.YearReleased<a.YearReleased) from Products a Order by ProductName ASC;"
32807,3893285,"SELECT p1.ProductName, (SELECT COUNT(*)
    FROM Products p2
    WHERE p1.BrandName = p2.BrandName AND p2.YearReleased < p1.YearReleased
)
FROM Products p1
ORDER BY p1.ProductName ASC



"
5130,3893285,"SELECT p2.ProductName, (SELECT COUNT(*)
                        FROM Products p
                        WHERE p2.BrandName = p.BrandName and p2.YearReleased > p.YearReleased)
FROM Products p2
ORDER BY p2.ProductName"
5246,3893285,"select ProductName, (select count(*) from Products where YearReleased < p.YearReleased and BrandName = p.BrandName) as cnt from Products p order by ProductName"
5722,3893285,"SELECT ProductName, (
    SELECT COUNT(ProductName)
    FROM Products AS ProductsBefore
    WHERE Products.YearReleased > ProductsBefore.YearReleased 
        AND Products.BrandName = ProductsBefore.BrandName
)
FROM Products
ORDER BY ProductName ASC; "
5092,3893285,"SELECT d.ProductName, (SELECT COUNT(*)-1 FROM Products p2 WHERE ((p2.YearReleased <d.YearReleased AND d.BrandName = p2.BrandName) OR (p2.ProductId = d.ProductId AND p2.YearReleased=d.YearReleased)) GROUP by p2.BrandName)
FROM Products d
GROUP By d.BrandName, d.ProductName, d.YearReleased, d.ProductId
ORDER By d.ProductName"
10641,3893285,"select ProductName,count(ProductId)
from (select p.ProductName, p.ProductId as ProductMainId, pp.ProductId
from Products p left outer join Products pp on p.BrandName = pp.BrandName and p.YearReleased > pp.YearReleased) as ppp
group by ProductMainId
order by ProductName
"
8171,3893285,"SELECT p1Name, COUNT(p2Name)
FROM (SELECT P1.ProductName AS p1Name, P2.ProductName AS p2Name
    FROM Products P1
    LEFT JOIN Products P2 ON P1.YearReleased > P2.YearReleased
        AND P1.BrandName = P2.BrandName) AS productInfo
GROUP BY p1Name;"
313637,3893285,"SELECT p1.ProductName, COUNT(p2.ProductId)
FROM Products p1 LEFT OUTER JOIN Products p2 ON p1.BrandName = p2.BrandName AND p1.YearReleased > p2.YearReleased
GROUP BY p1.ProductId
ORDER BY p1.ProductName"
130804,3893285,"select p.ProductName, 
(select count(*) from Products where Yearreleased < p.yearreleased and p.brandname = brandname)
from Products p
order by p.ProductName;"
24839,3893285,"SELECT prd1, COUNT(null_check) FROM (SELECT p1.productName as prd1, p2.productName as null_check
FROM Products p1 LEFT OUTER JOIN Products p2 on 
    p1.BrandName = p2.BrandName and p1.YearReleased > p2.YearReleased) as t
GROUP BY prd1
"
122226,3893285,"SELECT p1.ProductName, COUNT(p1.ProductId)-1
FROM Products p1, Products p2
WHERE (p1.BrandName=p2.BrandName AND p1.YearReleased > p2.YearReleased) OR p1.ProductId=p2.ProductId
GROUP BY p1.ProductName"
201123,3893285,"select p1.ProductName, count(p2.productId)
from Products as p1
left outer join Products as p2
on p1.BrandName = p2.BrandName 
and p1.YearReleased > p2.YearReleased group by p1.ProductID
order by p1.ProductName"
127606,3893285,"select pr.ProductName, (select count(*) from Products pr2 where pr2.YearReleased < pr.YearReleased and pr2.BrandName = pr.BrandName)
from Products pr
order by pr.ProductName;"
37267,3893285,"SELECT p3.ProductName, IFNULL(Num, 0)
FROM Products as p3 LEFT JOIN
(SELECT p2.ProductName as name, count(*) AS Num
FROM Products as p1, Products as p2
WHERE p1.BrandName = p2.BrandName AND p1.YearReleased < p2.YearReleased
GROUP BY p2.ProductName) AS NumProducts
ON p3.ProductName = NumProducts.name
ORDER BY p3.ProductName"
34020,3893285,"SELECT p.ProductName, COUNT(p2.ProductName)
FROM Products p LEFT JOIN Products p2 
ON p.BrandName = p2.BrandName AND p.YearReleased > p2.YearReleased
GROUP BY p.ProductName"
35116,3893285,"SELECT P3.ProductName, coalesce(temp.pre, 0)
FROM (SELECT P1.ProductName, COUNT(P2.ProductName) AS pre
FROM Products P1, Products P2
WHERE P1.BrandName = P2.BrandName and P1.YearReleased > P2.YearReleased
GROUP BY P1.ProductName) AS temp RIGHT OUTER JOIN Products P3 ON temp.ProductName = P3.ProductName
ORDER BY P3.ProductName"
37517,3893285,"SELECT ProductName,
(select count(*) from Products p where p.BrandName = Products.BrandName AND p.YearReleased < Products.YearReleased)
FROM Products
order by ProductName ASC;"
319746,3893285,"SELECT P.ProductName, COUNT(Q.ProductID)
FROM Products P LEFT OUTER JOIN Products Q ON
    P.BrandName = Q.BrandName AND P.YearReleased > Q.YearReleased
GROUP BY P.ProductID
ORDER BY P.ProductName;"
33188,3893285,"SELECT p1.ProductName,COUNT(p2.ProductName)
FROM Products p1 LEFT OUTER JOIN Products p2 ON
p1.BrandName = p2.BrandName AND p2.YearReleased < p1.YearReleased
GROUP BY p1.ProductName"
30481,3893285,"SELECT P1.ProductName, COUNT(P2.ProductName)
FROM Products P1
LEFT OUTER JOIN Products P2 ON P1.BrandName = P2.BrandName AND P1.ProductId <> P2.ProductId AND P2.YearReleased < P1.YearReleased
GROUP BY P1.ProductName"
36594,3893285,"SELECT P1.ProductName, COUNT(*) - 1
FROM Products P1
     JOIN (SELECT ProductName, YearReleased, BrandName
           FROM Products) 
           AS P2 ON P1.BrandName = P2.BrandName
WHERE P1.YearReleased > P2.YearReleased OR P1.ProductName = P2.ProductName
GROUP BY P1.ProductName"
5753,3893285,"select p1.ProductName, count(p2.ProductName) 
from Products p1 left join Products p2 on p2.BrandName = p1.BrandName and p2.YearReleased < p1.YearReleased
group by p1.ProductName"
7637,3893285,"SELECT ProductName, NumProds
FROM (SELECT prod1.ProductName, COUNT(prod2.ProductId) AS NumProds
      FROM Products prod1 LEFT OUTER JOIN Products prod2 ON (prod1.BrandName = prod2.BrandName AND
      prod1.YearReleased > prod2.YearReleased) 
      GROUP BY prod1.ProductName) AS T"
37112,3893285,"SELECT  P.ProductName, count(R.ProductName)-- P.ProductName, COUNT(R.ProductName)
FROM Products P LEFT OUTER JOIN  Products R 
    ON (P.BrandName=R.BrandName AND P.YearReleased > R.YearReleased)
GROUP BY P.ProductName"
5791,3893285,"select p1.ProductName, sum(if(p2.YearReleased < p1.YearReleased, 1, 0))
from Products p1 inner join Products p2
on p1.BrandName = p2.BrandName
group by p1.ProductName
order by p1.ProductName
"
9395,3893285,"SELECT A.ProductName, COUNT(CASE WHEN (A.BrandName = B.BrandName AND A.YearReleased > B.YearReleased) THEN 1 ELSE NULL END) AS PrevProducts
FROM Products AS A, Products AS B
GROUP BY A.ProductName;"
31826,3893285,"SELECT ProductName, (SELECT COUNT(ProductId) FROM Products p2 WHERE p2.BrandName=p1.BrandName AND p2.YearReleased<p1.YearReleased)
FROM Products p1
ORDER BY ProductName ASC"
33758,3893285,"SELECT ProductName, counts FROM 
(
    SELECT ProductName, BrandName, 
        (SELECT COUNT(ProductName) FROM Products WHERE Final.YearReleased > YearReleased AND Final.BrandName = BrandName) as counts
    FROM Products
    AS Final
) AS prodCounts
ORDER BY ProductName
"
30537,3893285,"SELECT bt.ProductName, COUNT(bt.result)
FROM
    (SELECT pp.ProductName, A.ProductName AS result
    FROM Products pp LEFT OUTER JOIN Products A ON pp.YearReleased > A.YearReleased    
    AND pp.BrandName = A.BrandName
    AND pp.ProductId <> A.ProductId) AS bt
GROUP BY bt.ProductName
"
36387,3893285,"SELECT A.ProductName, COUNT(case when B.YearReleased < A.YearReleased and B.BrandName = A.BrandName then 1 end)
FROM Products A 
CROSS JOIN Products B
GROUP BY A.ProductName;"
336388,3893285,"SELECT a.ProductName, COUNT(b.ProductName) AS number
FROM Products AS a
LEFT JOIN Products AS b
ON a.BrandName = b.BrandName AND a.YearReleased > b.YearReleased
GROUP BY a.ProductId
ORDER BY a.ProductName "
65042,3893285,"SELECT p1.ProductName, COUNT(p2.ProductId)
FROM Products p1
  LEFT JOIN Products p2 ON (p2.BrandName = p1.BrandName AND p2.YearReleased < p1.YearReleased)
GROUP BY p1.ProductName"
9781,3893285,"SELECT ProductName, (SELECT count(*) FROM Products p2 WHERE p2.BrandName = p1.BrandName AND p2.YearReleased < p1.YearReleased)
FROM Products p1
ORDER BY ProductName ASC"
33358,3893285,"SELECT c.ProductName, COUNT(b.ProductName)
FROM    (SELECT distinct p.ProductName
         FROM Products p
         )AS c

LEFT JOIN   (SELECT a.ProductName, a.YearReleased
            FROM(SELECT p.BrandName, p.YearReleased, p.ProductName
                 FROM Products p, Brands b
                 WHERE p.BrandName = b.BrandName ) AS a, Products pr
            WHERE a.BrandName = pr.BrandName and a.YearReleased > pr.YearReleased
            ) AS b
ON c.ProductName = b.ProductName
GROUP BY c.ProductName
"
331540,3893285,"Select P.ProductName,
(
Select count(ProductId)
from Brands NATURAL JOIN Products
where YearReleased < P.YearReleased and BrandName=B.BrandName
)
from Products P, Brands B
where P.BrandName=B.BrandName
order by P.ProductName ASC"
322515,3893285,"SELECT 
    ProductName, (SELECT COUNT(P2.ProductId) 
                    FROM Products P2 
                   WHERE P2.BrandName = P1.BrandName 
                     AND P2.YearReleased < P1.YearReleased) AS number
FROM    
    Products P1
ORDER BY
    ProductName ASC


"
130618,3893285,"SELECT p1.ProductName, COUNT(p2.ProductName)
FROM Products p1 LEFT OUTER JOIN Products p2 ON p1.BrandName = p2.BrandName AND p1.YearReleased > p2.YearReleased 
GROUP BY p1.ProductName"
36209,3893285,"SELECT pr.ProductName, (SELECT Count(*) FROM Products pr2 WHERE pr.BrandName = pr2.BrandName AND pr2.YearReleased < pr.YearReleased) FROM Products pr ORDER BY pr.ProductName ASC;
        "
33198,3893285,"SELECT Products.ProductName, COALESCE(amount, 0)
FROM Products
LEFT JOIN (
        SELECT curr.ProductName AS name, COUNT(curr.ProductId) AS amount
        FROM Products curr, Products pre
        WHERE curr.BrandName = pre.BrandName AND curr.YearReleased > pre.YearReleased
        GROUP BY name
    ) AS my_temp ON Products.ProductName = my_temp.name
ORDER BY ProductName;"
5233,3893285,"SELECT ProductName, (SELECT COUNT(*) FROM Products i WHERE i.YearReleased < o.YearReleased and i.BrandName = o.BrandName)
FROM Products AS o
ORDER BY ProductName"
5435,3893285,"Select ProductName, count(earlier)
FROM Products oriP
LEFT JOIN (
    SELECT pp.ProductID AS earlier, pp.BrandName AS bn, pp.YearReleased AS yr
    FROM Products pp
) AS p
ON p.bn = oriP.BrandName AND p.yr < oriP.YearReleased
GROUP BY ProductName, ProductId, BrandName, YearReleased"
35847,3893285,"Select p1.ProductName, count(p2.ProductName)
from Products p1 left outer join Products p2 on p1.BrandName = p2.BrandName
and p2.YearReleased < p1.YearReleased
group by p1.ProductName"
9769,3893285,"select n.ProductName, Count(*)-1
from Products m join Products n 
where m.BrandName = n.BrandName and (n.YearReleased > m.YearReleased or n.ProductName = m.ProductName)
group by n.ProductName
"
124294,3893285,"SELECT p1.ProductName, SUM(CASE WHEN p1.YearReleased > p2.YearReleased && p1.BrandName = p2.BrandName THEN 1 ELSE 0 END)
FROM Products p1, Products p2
GROUP BY p1.ProductName"
6923,3893285,"SELECT p.ProductName, (SELECT COUNT(p1.BrandName) FROM Products p1 WHERE (p1.BrandName = p.BrandName) AND (p1.YearReleased < p.YearReleased)) AS numProds
FROM Products p
ORDER BY p.ProductName;"
7426,3893285,"SELECT ProductName,
(SELECT COUNT(*)
FROM Products Pro2
WHERE Pro2.YearReleased < Pro.YearReleased AND Pro2.BrandName = Pro.BrandName)
FROM Products Pro
ORDER by ProductName"
34391,3893285,"SELECT item.ProductName, (Select count(ProductId) from Products 
where item.BrandName = BrandName and item.YearReleased > YearReleased)
FROM Products item
ORDER BY item.ProductName"
5768,3893285,"SELECT p.ProductName, (Select Count(*) From Products p2 Where p2.YearReleased < p.YearReleased AND p.BrandName = p2.BrandName)
From Products p 
Order By p.ProductName"
322502,3893285,"SELECT p1.ProductName, COUNT(p2.YearReleased) - 1
FROM Products as p1, Products as p2
WHERE (p1.BrandName = p2.BrandName AND p2.YearReleased < p1.YearReleased) OR
      (p1.ProductName = p2.ProductName)
GROUP BY p1.ProductName;
"
35307,3893285,"SELECT ProductName, (SELECT COUNT(*) FROM Products p WHERE 
p.YearReleased < x.YearReleased AND p.BrandName = x.BrandName)
FROM Products x
ORDER BY ProductName





"
